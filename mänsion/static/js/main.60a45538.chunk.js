(this.webpackJsonpmaension=this.webpackJsonpmaension||[]).push([[0],{11:function(e,t,i){"use strict";var n=i(31);i.d(t,"AnimationHelper",(function(){return n.a}));var a=i(32);i.d(t,"Gamepads",(function(){return a.a}));var s=i(33);i.d(t,"Keyboard",(function(){return s.a}));var r=i(34);i.d(t,"MathHelper",(function(){return r.a}));i(35)},31:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(6),a=i(10),s=i(4),r=function(){function e(){Object(n.a)(this,e)}return Object(a.a)(e,null,[{key:"loadClip",value:function(e,t,i,n){var a=[];if(!e[t])throw new Error("resources for ".concat(t," not found!"));for(var r in e[t].textures){var o=e[t].textures[r];a.push(o)}var l=new s.AnimatedSprite(a);return l.animationSpeed=i,l.scale.x=n,l.scale.y=n,l.anchor.x=.5,l}}]),e}()},32:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(19),a=i(6),s=i(10),r=function(){function e(){Object(a.a)(this,e)}return Object(s.a)(e,null,[{key:"init",value:function(t){return e._events=t,e.scanGamepads(),e._gamepads[0]||null}},{key:"connectHandler",value:function(t){console.log("gamepad connected"),e.addGamepad(t.gamepad)}},{key:"addGamepad",value:function(t){console.log("adding gamepad",t),e._gamepads[t.index]=t,e._state[t.index]={}}},{key:"disconnectHandler",value:function(t){console.log("gamepad disconnected"),e.removeGamepad(t.gamepad)}},{key:"removeGamepad",value:function(t){console.log("removing gamepad"),delete e._gamepads[t.index],delete e._state[t.index]}},{key:"updateStatus",value:function(){for(var t in e.scanGamepads(),e._gamepads)if(e._gamepads.hasOwnProperty(t)){var i=e._gamepads[t];if(i.axes,i.buttons)for(var n in i.buttons)if(i.buttons.hasOwnProperty(n)){var a=i.buttons[n];e._state[t][n]=e._state[t][n]||{},e._events[t][n]=e._events[t][n]||{};var s=e._state[t][n],r=e._events[t][n];a.pressed&&!s.isPressed&&(console.log("button pressed",t,n),s.isPressed=!0,r.pressEvent&&r.pressEvent()),!a.pressed&&s.isPressed&&(console.log("button released",t,n),s.isPressed=!1,r.releaseEvent&&r.releaseEvent())}}}},{key:"scanGamepads",value:function(){var t,i=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],a=Object(n.a)(i);try{for(a.s();!(t=a.n()).done;){var s=t.value;if(s){var r=s.index;r in e._gamepads?e._gamepads[r]=s:(console.log("found new gamepad during scan, adding",r),e.addGamepad(s))}}}catch(o){a.e(o)}finally{a.f()}}}]),e}();r._gamepads={},r._state={},r._events={},window.addEventListener("gamepadconnected",r.connectHandler),window.addEventListener("gamepaddisconnected",r.disconnectHandler)},33:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(6),a=i(10),s=function(){function e(t,i){Object(n.a)(this,e),this._key=t,this._ignoreKeyup=i,this._isDown=!1,this._isUp=!0,this.pressEvent=null,this.releaseEvent=null,window.addEventListener("keydown",this._downHandler.bind(this),!1),window.addEventListener("keyup",this._upHandler.bind(this),!1)}return Object(a.a)(e,[{key:"_downHandler",value:function(e){e.key===this._key&&(e.preventDefault(),this._isUp&&this.pressEvent&&this.pressEvent(),this._isDown=!0,this._isUp=!1)}},{key:"_upHandler",value:function(e){e.key===this._key&&(e.preventDefault(),this._isDown&&this.releaseEvent&&this.releaseEvent(),this._isDown=!1,this._isUp=!0)}},{key:"isDown",get:function(){return this._isDown}}]),e}()},34:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(6),a=i(10),s=function(){function e(){Object(n.a)(this,e)}return Object(a.a)(e,null,[{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e))+e}},{key:"angleBetweenRad",value:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}},{key:"distanceTo",value:function(t,i){return Math.sqrt(e.distanceToSq(t,i))}},{key:"distanceToSq",value:function(e,t){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}}]),e}()},35:function(e,t){},38:function(e,t,i){"use strict";(function(e){var n=i(4);e.PIXI=n,t.a=n}).call(this,i(22))},42:function(e,t,i){e.exports=i(67)},47:function(e,t,i){},49:function(e,t,i){},50:function(e,t,i){},51:function(e,t,i){},52:function(e,t,i){},53:function(e,t,i){},66:function(e,t,i){},67:function(e,t,i){"use strict";i.r(t);var n=i(5),a=i.n(n),s=i(36),r=i.n(s),o=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var i=e.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i(47),i(48),i(49),i(50);function h(){return a.a.createElement("header",null,a.a.createElement("h1",null,"M\xe4nsion"),a.a.createElement("hr",null))}i(51);function c(){return a.a.createElement("footer",null,a.a.createElement("div",null,a.a.createElement("div",{className:"entry inline"},a.a.createElement("a",{href:"https://twitter.com/umlautgames",target:"_blank",rel:"noopener noreferrer"},"Twitter")," ","|"),a.a.createElement("div",{className:"entry inline"},a.a.createElement("a",{href:"https://www.linkedin.com/company/umlaut-games",target:"_blank",rel:"noopener noreferrer"},"LinkedIn")," ","|"),a.a.createElement("div",{className:"entry inline"},a.a.createElement("a",{href:"https://umlaut-games.itch.io",target:"_blank",rel:"noopener noreferrer"},"itch.io"))),a.a.createElement("div",{className:"copyright"},"\xa9 2020"," ",a.a.createElement("a",{href:"https://umlaut.games",target:"_blank",rel:"noopener noreferrer"},"Umlaut Games"),a.a.createElement("span",null," \u2014 All Rights Reserved")))}i(52);function u(){return a.a.createElement("div",{className:"blocks"},a.a.createElement("div",{className:"block"},a.a.createElement("h2",null,"Kickstarter"),a.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed mattis sem nunc, vitae consectetur purus volutpat at. Integer at consequat arcu. Curabitur aliquam ex sit amet consectetur bibendum. Phasellus nec metus aliquam, vestibulum est et, efficitur metus. Fusce consectetur vel lectus non feugiat. Nam et ipsum leo. Mauris bibendum semper augue, non dapibus dui vestibulum id. In eget metus nec odio consectetur ultrices ut congue nisi. Vivamus et augue vel risus posuere pulvinar. Vestibulum placerat justo mi, sed aliquam massa lobortis vitae."),a.a.createElement("div",{className:"cta"},a.a.createElement("button",null,"Preorder Now!"))),a.a.createElement("div",{className:"block"},a.a.createElement("h2",null,"Patreon"),a.a.createElement("p",null,"Ut vestibulum bibendum enim ut sodales. Nam efficitur, sapien consectetur porttitor dapibus, dolor felis lacinia velit, ut commodo odio leo eu nunc. Curabitur vel libero aliquam, malesuada mauris vel, ornare elit. Sed consectetur mauris eu ante maximus pulvinar. Aliquam arcu metus, pellentesque non nibh id, scelerisque placerat mauris. Cras vel elit metus. Donec pulvinar purus ac ipsum tristique tincidunt. Quisque non placerat sapien. In ut iaculis libero, id dictum sem. Mauris pulvinar vel lorem nec cursus."),a.a.createElement("div",{className:"cta"},a.a.createElement("button",{className:"secondary"},"Support us!"))),a.a.createElement("div",{className:"block"},a.a.createElement("h2",null,"itch.io"),a.a.createElement("p",null,"Ut vestibulum bibendum enim ut sodales. Nam efficitur, sapien consectetur porttitor dapibus, dolor felis lacinia velit, ut commodo odio leo eu nunc. Curabitur vel libero aliquam, malesuada mauris vel, ornare elit. Sed consectetur mauris eu ante maximus pulvinar. Aliquam arcu metus, pellentesque non nibh id, scelerisque placerat mauris. Cras vel elit metus. Donec pulvinar purus ac ipsum tristique tincidunt. Quisque non placerat sapien. In ut iaculis libero, id dictum sem. Mauris pulvinar vel lorem nec cursus."),a.a.createElement("div",{className:"cta"},a.a.createElement("button",{className:"secondary"},"Get Early Access!"))))}var d=i(41),p=(i(53),i(6)),_=i(10),v=i(4),f=i(38),m=(i(63),i(64),f.a,i(19)),g=i(14),y=i(13),w=i(9),b=i(8),x=!1,k=!0,O=!1,C=!1,j=!1,E=!1,S=!1,R={black:0,white:16777215,width:800,height:600,fadeDuration:1e3},M="Press Start 2P",T=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;return Object(p.a)(this,i),(n=t.call(this))._outlineContainer=void 0,n._map=void 0,n._baseScale=1,n._resources=void 0,n._isFacingRight=!0,n._vx=0,n._vy=0,n._vr=0,n._resources=e,n}return Object(_.a)(i,[{key:"tick",value:function(e){0===this.vx&&0===this.vy&&0===this.vr||(this.x+=this.vx,this.y+=this.vy,this.rotation+=this.vr)}},{key:"collides",value:function(e){var t=e.getBounds(),i=this.getBounds(),n=t.x+t.width>i.x&&t.x<i.x+i.width&&t.y+t.height>i.y&&t.y<i.y+i.height;return n&&E&&(console.log("this",i),console.log("actor",t)),n}},{key:"adaptScale",value:function(e,t){var i=t-e,n=this._baseScale-i/1e3;this.scale.x=n,this.scale.y=n,this._adaptScaleBasedOnOrientation()}},{key:"_adaptScaleBasedOnOrientation",value:function(){var e=this.scale.x;!this._isFacingRight&&e>0&&(this.scale.x=-e),this._isFacingRight&&e<0&&(this.scale.x=Math.abs(e))}},{key:"outline",value:function(){this._outlineContainer&&(this.parent?this.parent.removeChild(this._outlineContainer):this.removeChild(this._outlineContainer),delete this._outlineContainer),this._adaptScaleBasedOnOrientation(),this._outlineContainer=new v.Container;var e=this.getBounds(),t=this.parent?this.parent.toLocal(e):e;if(O){var i=new v.Text("x: ".concat(e.x.toFixed(0)," y: ").concat(e.y.toFixed(0),"\nw: ").concat(e.width.toFixed(0)," h: ").concat(e.height.toFixed(0)),{fontSize:"10px",fill:"#fff"});i.x=t.x,i.y=t.y,this._outlineContainer.addChild(i)}var n=new v.Graphics;n.lineStyle(1,0),n.drawRect(t.x,t.y,e.width,e.height),n.endFill(),this._outlineContainer.addChild(n),this.parent?this.parent.addChild(this._outlineContainer):this.addChild(this._outlineContainer)}},{key:"vx",get:function(){return this._vx}},{key:"vy",get:function(){return this._vy}},{key:"vr",get:function(){return this._vr}},{key:"realx",get:function(){return this.x-Math.abs(this.width)/2}},{key:"map",set:function(e){this._map=e}}]),i}(v.Container),N=function(e,t){return e.zIndex-t.zIndex},H=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(){var e;Object(p.a)(this,i);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a)))._onDone=void 0,e._clips={},e._currentClip=void 0,e}return Object(_.a)(i,[{key:"done",value:function(){this._onDone&&this._onDone()}},{key:"_setIsFacingRight",value:function(e){this._isFacingRight=e,this._adaptScaleBasedOnOrientation()}},{key:"_playClip",value:function(e,t,i){var n=this;return this._currentClip&&(this.removeChild(this._currentClip),this._currentClip=void 0),new Promise((function(a){var s=n._clips[e];if(!s)return console.log("AnimationBase: failed to load clip: ".concat(e),n._clips),a(!1);s.zIndex=1,n.addChild(s),n._currentClip=s,n._adaptScaleBasedOnOrientation(),n._currentClip.loop=t,n._currentClip.gotoAndPlay(0),n.children.sort(N),t||(s.onComplete=function(){return s.stop(),i||n.removeChild(s),a(!0)})}))}},{key:"onDone",set:function(e){this._onDone=e}}]),i}(T),I=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;Object(p.a)(this,i);var a=(n=t.call(this,e))._resources["weapons.impact"],s=new v.Sprite(a.textures["impact.png"]);return n.addChild(s),n}return i}(H),L=i(20),D=i(11),F=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;Object(p.a)(this,i);var s="things.blood";return(n=t.call(this,e))._clips=Object(L.a)({},s,D.AnimationHelper.loadClip(n._resources,s,a,1)),n._playClip(s,!1,!1),n}return i}(H),B=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;return Object(p.a)(this,i),(n=t.call(this,e)).zIndex=3,n.addChild(new v.Text("x",{fill:"#fff"})),n}return i}(T),A=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n,a){var s;Object(p.a)(this,i),(s=t.call(this,e))._isFacingRight=!0,s.height=n,s.width=a;var r=new v.Sprite(S?v.Texture.WHITE:v.Texture.EMPTY);return r.width=a,r.height=n,S&&(r.tint=16711680),s.addChild(r),s}return i}(T),P=i(17),G=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(){var e;Object(p.a)(this,i),(e=t.call(this)).interval1=void 0,e.interval2=void 0,e.pivot.x=e.width/2,e.pivot.y=e.height/2;var n=new v.Sprite(v.Texture.WHITE);return n.width=1e3,n.height=1e3,e.alpha=0,e.interval1=setInterval((function(){e.shine()}),1e3*D.MathHelper.getRandomInt(5,10)),e.interval2=setInterval((function(){e.shine()}),1e3*D.MathHelper.getRandomInt(10,20)),e.addChild(n),e}return Object(_.a)(i,[{key:"destroy",value:function(e){Object(g.a)(Object(y.a)(i.prototype),"destroy",this).call(this,e),window.clearInterval(this.interval1),window.clearInterval(this.interval2)}},{key:"shine",value:function(){var e=this;Object(P.a)(Object(P.c)({from:0,to:.75,duration:75,ease:[P.b.createExpoIn(3)]}),Object(P.c)({from:.75,to:0,duration:400,ease:[P.b.easeOut]})).start((function(t){return e.alpha=t}))}}]),i}(v.Container),z=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["Hahhahaha, kid!","You will never stop me","This is the end ... \ud83c\udf46"];Object(p.a)(this,i),(n=t.call(this,e))._text=void 0,n._textObject=void 0,n._text=a.reverse();var s=e["avatar.dejonghe"].texture,r=new v.Sprite(s);r.height=70,r.width=70,r.y=2,r.x=2;var o=new v.Graphics;o.lineStyle(4,1118481),o.drawRect(0,0,400,72);var l={fontSize:"14px",fill:"#ccc",fontFamily:M,dropShadow:!0,dropShadowColor:"#222"};return n._textObject=new v.Text("",l),n._textObject.x=80,n._textObject.y=12,n.addChild(o,r,n._textObject),n}return Object(_.a)(i,[{key:"start",value:function(){var e=this;setTimeout((function(){e.play()}),500)}},{key:"printLine",value:function(e){var t=this;return new Promise((function(i){var n=e.split("").reverse(),a=setInterval((function(){var e=n.pop();if(!e)return clearInterval(a),i();t._textObject.text+=e," "!==e&&t._resources["sfx.keypress"].sound.play({start:.7,speed:3,volume:.2})}),40)}))}},{key:"play",value:function(){var e=this,t=this._text.pop();t&&this.printLine(t).then((function(){e._text.length>0?setTimeout((function(){e._textObject.text+="\n",e.play()}),1e3):setTimeout((function(){if(e._onDone)return e.done()}),1e3)}))}}]),i}(H);v.settings.SCALE_MODE=v.SCALE_MODES.NEAREST;var W=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"8px",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#fff",o=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;Object(p.a)(this,i),a=t.call(this,e);var h={fontSize:s,fill:r,fontFamily:M};l&&(h.dropShadow=!0,h.dropShadowColor=l);var c=new v.Text(n,h);if(!isNaN(o)){var u=new v.Sprite(v.Texture.WHITE);u.width=c.width,u.height=c.height,u.tint=o,a.addChild(u)}return a.addChild(c),a}return i}(H),q=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n,a,s){var r;return Object(p.a)(this,i),(r=t.call(this,e)).addChild(new W(e,n,"8px","#fff",R.black)),setTimeout((function(){s()}),1e3*a),r}return i}(H),U={idle:Symbol.for("Idle"),walking:Symbol.for("Walking"),fire:Symbol.for("Fire"),died:Symbol.for("Died")},K=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n,a){var s;return Object(p.a)(this,i),(s=t.call(this,e))._text=void 0,s._lastFlip=0,s._skin=void 0,s._speed=1,s._health=100,s._power=12,s._state=U.idle,s._canGetHitAgain=!0,s._skin=n,s._speed=a,s}return Object(_.a)(i,[{key:"_setState",value:function(e){console.log(this.constructor.name,"New state:",e),this._state=e}},{key:"_idle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".idle";this._state!==U.died&&(this._setState(U.idle),this._playClip(this._skin+e,!0))}},{key:"_died",value:function(){this._setState(U.died),this._vy=0,this._vx=0,this._vr=0,this._playClip(this._skin+".died",!1,!0)}},{key:"hitBy",value:function(e){var t=this,i=!1,n=!1;return this._canGetHitAgain&&(this._health-=e.power,n=!0,this._canGetHitAgain=!1,this._health<0?(this._health=0,i=!0,this._died()):(this._vx=e._isFacingRight?5:-5,this._playClip(this._skin+".gothit",!1).then((function(){t._vx=0,t._canGetHitAgain=!0,t._idle()})))),{died:i,objectTookDamage:n}}},{key:"flip",value:function(e){this._setIsFacingRight(void 0!==e?e:!this._isFacingRight)}},{key:"moveTowards",value:function(e){var t=0,i=0;if(D.MathHelper.distanceTo(this.position,e)>1){var n=D.MathHelper.angleBetweenRad(this.position,e);i=Math.sin(n)*this._speed,((t=Math.cos(n)*this._speed)>0&&!this._isFacingRight&&this._canFlipAgain()||t<0&&this._isFacingRight&&this._canFlipAgain())&&this.flip()}this._vy=i,this._vx=t}},{key:"_canFlipAgain",value:function(){var e=!0;return Date.now()-this._lastFlip>200&&(e=!0,this._lastFlip=Date.now()),e}},{key:"_logActorCoordinates",value:function(){j&&console.log("x",this.x,"real x",this.realx,"y",this.y,"width",this.width,"height",this.height)}},{key:"moved",value:function(){this._logActorCoordinates(),this._text&&(this._text.x=this.x-this._text.width/2,this._text.y=this.y-25)}},{key:"speak",value:function(e){var t=this;this.parent&&!this._text&&(this._text=new q(this._resources,e,3,(function(){t.parent.removeChild(t._text),delete t._text})),this._text.zIndex=80,this._text.x=this.x-this._text.width/2,this._text.y=this.y-25,this.parent.addChild(this._text))}},{key:"move",value:function(e,t){return!1}},{key:"power",get:function(){return this._power}},{key:"health",get:function(){return this._health}},{key:"state",get:function(){return this._state}}]),i}(H),V=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n,a){var s;return Object(p.a)(this,i),(s=t.call(this,e))._reloadTime=void 0,s._isReloading=!1,s._power=void 0,s._maxRounds=void 0,s._rounds=void 0,s._sprite=void 0,s._roundsSprite=void 0,s._shellSprites=[],s._power=n,s._rounds=a,s._maxRounds=a,s._reloadTime=5,s.zIndex=100,s.x=4,s.y=18,s}return Object(_.a)(i,[{key:"rounds",get:function(){return this._rounds}},{key:"sprite",get:function(){return this._sprite}},{key:"roundsSprite",get:function(){return this._roundsSprite}},{key:"isReloading",get:function(){return this._isReloading}}]),Object(_.a)(i,[{key:"fire",value:function(){return this._rounds>0&&!this._isReloading&&(this._rounds--,!0)}},{key:"tick",value:function(e){var t,i=Object(m.a)(this._shellSprites);try{for(i.s();!(t=i.n()).done;){t.value.tick(e)}}catch(n){i.e(n)}finally{i.f()}}},{key:"reload",value:function(){var e=this;return!this.isReloading&&(this._isReloading=!0,setTimeout((function(){e._rounds=e._maxRounds,e._isReloading=!1}),1e3*this._reloadTime),console.log("reload"),!0)}}]),i}(T),Y=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;Object(p.a)(this,i);var s="weapons.muzzle";return(n=t.call(this,e))._clips=Object(L.a)({},s,D.AnimationHelper.loadClip(n._resources,s,a,1)),n._playClip(s,!1,!1),n}return i}(H),J=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;Object(p.a)(this,i),(a=t.call(this,e)).pivot.x=a.width/2,a.pivot.y=a.height/2;var s=new v.Sprite(n);return s.rotation=D.MathHelper.getRandomInt(0,100),a.scale.x=.1,a.scale.y=.1,Object(P.c)({from:0,to:-D.MathHelper.getRandomInt(500,700),duration:600}).start((function(e){return s.x=e})),Object(P.c)({from:0,to:D.MathHelper.getRandomInt(900,1e3),duration:600,ease:[P.b.bounceOut]}).start((function(e){return s.y=e})),a.addChild(s),a}return i}(H),Q=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(){return Object(p.a)(this,i),t.apply(this,arguments)}return Object(_.a)(i,[{key:"fire",value:function(){var e=this,t=Object(g.a)(Object(y.a)(i.prototype),"fire",this).call(this);if(t){var n,a=new Y(this._resources,2);a.x=48,a.y=-25,this.addChild(a);var s=new J(this._resources,null===(n=this._roundsSprite)||void 0===n?void 0:n.texture),r=this.parent.parent;s.position=this.parent.position,r.addChild(s),this._shellSprites.push(s),setTimeout((function(){r.removeChild(s),e._shellSprites=e._shellSprites.splice(e._shellSprites.findIndex((function(e){return e===s})))}),3e3)}return t}}]),i}(V),X=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;Object(p.a)(this,i),n=t.call(this,e,55,6);var a=e["weapons.shotgun"];return n._roundsSprite=new v.Sprite(a.textures["shell.png"]),n._sprite=new v.Sprite(a.textures["shotgun.png"]),n._sprite.scale.x=.3,n._sprite.scale.y=.3,n.addChild(n._sprite),n}return i}(Q),$=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;Object(p.a)(this,i),(n=t.call(this,e,55,8)).fireSound=void 0,n.reloadSound=void 0;n.fireSound=e["beretta.fire"].sound,n.reloadSound=e["beretta.reload"].sound,n._reloadTime=n.reloadSound.duration;var a=e["weapons.beretta"];return n._sprite=new v.Sprite(a.textures["beretta.png"]),n._sprite.scale.set(.25,.25),n.addChild(n._sprite),n._roundsSprite=new v.Sprite(a.textures["shell.png"]),n}return Object(_.a)(i,[{key:"fire",value:function(){var e=Object(g.a)(Object(y.a)(i.prototype),"fire",this).call(this);return e&&this.fireSound.play(),e}},{key:"reload",value:function(){var e=Object(g.a)(Object(y.a)(i.prototype),"reload",this).call(this);return e&&this.reloadSound.play(),e}}]),i}(Q),Z=i(39),ee=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e){var n;Object(p.a)(this,i),n=t.call(this,e);var a=new v.Sprite(e.flashlight.texture);n.scale.set(2),a.width=100,a.height=50,a.alpha=.2,a.tint=15723480,a.y=-20,a.zIndex=99999;var s=new Z.a(e.flashlight.texture);return s.alpha=.1,s.blendMode=v.BLEND_MODES.ADD,a.filters=[new v.filters.NoiseFilter(.2),s],n.zIndex=9999,n.addChild(a),n}return i}(T),te={},ie=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;return Object(p.a)(this,i),(a=t.call(this,e,n,3))._weapon=void 0,a._name="Taro",a.flashlight=void 0,a._baseScale=2,a._health=77,a._clips[a._skin+".idle"]=D.AnimationHelper.loadClip(a._resources,a._skin+".idle",.1,1),a._clips[a._skin+".idle_handgun"]=D.AnimationHelper.loadClip(a._resources,a._skin+".idle_handgun",.1,1),te.shotgun=new X(e),te.beretta=new $(e),a.flashlight=new ee(e),a._weapon=te.beretta,a.addChild(a._weapon),a.relax(),a}return Object(_.a)(i,[{key:"weapon",get:function(){return this._weapon}},{key:"playerName",get:function(){return this._name}}]),Object(_.a)(i,[{key:"relax",value:function(){this._idle()}},{key:"reload",value:function(){this._weapon.reload()}},{key:"switchWeapon",value:function(){this.weapon.isReloading||(this.removeChild(this._weapon),this._weapon instanceof X?this._weapon=te.beretta:this._weapon instanceof $&&(this._weapon=te.shotgun),this.toggleFlashlight(),this.addChild(this._weapon))}},{key:"toggleFlashlight",value:function(){var e=this;this._map&&this.flashlight&&(this._map.foregroundContainer.children.find((function(t){return t===e.flashlight}))?this._map.foregroundContainer.removeChild(this.flashlight):(this.flashlight.position.set(this.x,this.y),this._map.foregroundContainer.addChild(this.flashlight),this._map.foregroundContainer.children.sort(N)))}},{key:"updateCrosshairPosition",value:function(e){var t=this._isFacingRight?D.MathHelper.angleBetweenRad(this.weaponLocation,e):-D.MathHelper.angleBetweenRad(e,this.weaponLocation);this._weapon.rotation=t}},{key:"_canBeControlled",value:function(){return this._state===U.died?(console.log("Cant be controlled, player is dead"),!1):this._state===U.idle||this._state===U.walking}},{key:"_died",value:function(){Object(g.a)(Object(y.a)(i.prototype),"_died",this).call(this),this.y+=this.height/2,this.height=this.height/2}},{key:"fire",value:function(){var e=this;if(!this._canBeControlled())return!1;var t=this._weapon.fire();return t?(this.speak("P\xe4ng!"),this._setState(U.fire),this._vx=0,this._vy=0,this._playClip(this._skin+".punch",!1).then((function(){e.relax()})),!0):(this.relax(),!1)}},{key:"moveRight",value:function(){this._canBeControlled()&&(this._vx=this._speed,this._playClip(this._skin+".walk",!0),this._setState(U.walking))}},{key:"moveLeft",value:function(){this._canBeControlled()&&(this._vx=-this._speed,this._playClip(this._skin+".walk",!0),this._setState(U.walking),this._adaptScaleBasedOnOrientation())}},{key:"stopMoveHorizontally",value:function(){this._vx=0,0===this._vy&&this._canBeControlled()&&this.relax()}},{key:"moveUp",value:function(){this._canBeControlled()&&(this._vy=-this._speed,this._playClip(this._skin+".walk",!0),this._setState(U.walking))}},{key:"moveDown",value:function(){this._canBeControlled()&&(this._vy=this._speed,this._playClip(this._skin+".walk",!0),this._setState(U.walking))}},{key:"stopMoveVertically",value:function(){this._vy=0,0===this._vx&&this._canBeControlled()&&this.relax()}},{key:"speak",value:function(e){Object(g.a)(Object(y.a)(i.prototype),"speak",this).call(this,"".concat(this._name,": ").concat(e))}},{key:"move",value:function(e,t){var i,n=!1;(0!==this.vy&&this.y+this.vy>0&&this.y+this.height+this.vy<e&&(this.y+=this.vy,n=!0),this.vx>0?this.realx+Math.abs(this.width)+7+this.vx<t&&(this.x+=this.vx,n=!0):this.vx<0&&this.realx+this.vx>=0&&(this.x+=this.vx,n=!0),n)&&(this.adaptScale(this.y,e),null===(i=this.flashlight)||void 0===i||i.position.set(this.x,this.y),this.moved());return n}},{key:"tick",value:function(e){this.weapon.tick(e)}},{key:"weaponLocation",get:function(){return this.toGlobal(this._weapon.position)}}]),i}(K),ne=i(23),ae=i.n(ne),se=i(28),re=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n,a,s){var r;return Object(p.a)(this,i),(r=t.call(this,e))._explorationOffset=void 0,r._textures=void 0,r._bgm=void 0,r._backgroundContainer=void 0,r._actorContainer=void 0,r._foregroundContainer=void 0,r._stage=void 0,r.withHud=!0,r.withCrosshair=!0,r.withPlayer=!0,r.withMouse=!0,r.withDarkness=!1,r.zIndex=1,r._stage=n,r._onDone=s,r._explorationOffset=R.width/3,a&&(r._textures=e[a].textures),r._backgroundContainer=new v.Container,r.addChild(r._backgroundContainer),r._actorContainer=new v.Container,r.addChild(r._actorContainer),r._foregroundContainer=new v.Container,r.addChild(r._foregroundContainer),r.fade(!1).then(),r}return Object(_.a)(i,[{key:"_setup",value:function(){}},{key:"shallScroll",value:function(e,t){(t>0&&e+this._explorationOffset>R.width||t<0&&e-this._explorationOffset<this._explorationOffset)&&(this.x-=t,this.x>0&&(this.x=0),this.x<R.width-this.width&&(this.x=R.width-this.width))}},{key:"fadeMusic",value:function(){var e=Object(se.a)(ae.a.mark((function e(){var t=this;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._bgm){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){Object(P.c)({from:t._bgm.volume,to:0,duration:R.fadeDuration,ease:[P.b.linear]}).start({complete:e,update:function(e){return t._bgm.volume=e}})})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fade",value:function(){var e=Object(se.a)(ae.a.mark((function e(){var t,i,n=this,a=arguments;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(a.length>0&&void 0!==a[0])||a[0],(i=new v.Sprite(v.Texture.WHITE)).alpha=t?0:1,i.width=R.width,i.height=R.height,i.tint=0,i.zIndex=999999,this._stage.addChild(i),e.abrupt("return",new Promise((function(e){var a=t?1:0;Object(P.c)({from:i.alpha,to:a,duration:R.fadeDuration,ease:[P.b.createExpoIn(2)]}).start({complete:function(){return n._stage.removeChild(i),e()},update:function(e){return i.alpha=e}})})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(e){Object(g.a)(Object(y.a)(i.prototype),"destroy",this).call(this,e),this._bgm&&this._bgm.stop()}},{key:"actorContainer",get:function(){return this._actorContainer}},{key:"backgroundContainer",get:function(){return this._backgroundContainer}},{key:"foregroundContainer",get:function(){return this._foregroundContainer}}]),i}(H),oe=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;Object(p.a)(this,i),(a=t.call(this,e,n,"maps.maension"))._bgm=e["bgm.outside"].sound,a._bgm.volume=.3,a._bgm.loop=!0,a._bgm.play(),a.withDarkness=!0;var s=new v.Sprite(a._textures["sky.png"]);s.scale.x=2.56,s.scale.y=2.56,a._backgroundContainer.addChild(s);var r=new v.Sprite(a._textures["Maension_WIP.png"]);r.y=-40,r.scale.x=2,r.scale.y=2,a._backgroundContainer.addChild(r);var o=a._textures["tree.png"],l=new v.Sprite(o);l.x=100,l.y=350,l.scale.x=.4,l.scale.y=.4,a._actorContainer.addChild(l);var h=a._textures["tree_dead.png"],c=new v.Sprite(h);if(c.x=50,c.y=180,c.scale.x=.4,c.scale.y=.4,a._backgroundContainer.addChild(c),a.withDarkness){var u=new v.Sprite(v.Texture.WHITE);u.width=R.width,u.height=a.height,u.tint=0,u.alpha=.8,u.blendMode=v.BLEND_MODES.MULTIPLY,u.zIndex=1,a._foregroundContainer.addChild(u)}return a._setup(),a}return Object(_.a)(i,[{key:"_setup",value:function(){setInterval((function(){}),3e4),setInterval((function(){}),67e3)}}]),i}(re),le=i(40),he=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;Object(p.a)(this,i),(a=t.call(this,e,n,"maps.maension")).enterText=void 0,a.rainShader=void 0,a.godFilter=void 0,a.count=0,a._bgm=e["bgm.title"].sound,a._bgm.volume=.3,a._bgm.loop=!0,a._bgm.play(),a.withHud=!1,a.withCrosshair=!1,a.withPlayer=!1,a.withMouse=!1;var s=new W(e,"M\xe4nsion","54px","#EFB775",void 0,"#111");s.x=R.width/2-s.width/2,s.y=R.height/3-s.height/2;var r=window.location.search.endsWith("interactive")||!k,o="Press Enter to play";r||(o="coming soon ..."),a.enterText=new v.Container,a.enterText.addChild(new W(e,o,"24px")),a.enterText.x=R.width/2-a.enterText.width/2,a.enterText.y=R.height/2-a.enterText.height/2;var l=new v.Sprite(a._textures["Maension_WIP.png"]);l.alpha=.6;l.scale.x=2,l.scale.y=2,l.y=R.height-l.height,l.x=R.width/2-l.width/2,a._foregroundContainer.addChild(new G,l,a.enterText,s);var h=new v.Sprite(v.Texture.WHITE);h.width=R.width,h.height=R.height,h.tint=R.black,a.godFilter=new le.a,a.godFilter.angle=-35,a.godFilter.gain=.5,a.godFilter.lacunarity=2.5,h.filters=[a.godFilter],a._backgroundContainer.addChild(h);var c=new v.Sprite(v.Texture.WHITE);c.width=R.width,c.height=R.height,c.tint=R.black;var u=e["shaders.frag-rain"].data;return a.rainShader=new v.Filter(void 0,u),a.rainShader.uniforms.dimensions=[R.width,R.height],a.rainShader.uniforms.time=1,a.rainShader.uniforms.u_mouse=[R.width,R.height],a.rainShader.uniforms.u_frame=0,a.rainShader.blendMode=v.BLEND_MODES.ADD,c.filters=[a.rainShader],a._backgroundContainer.addChild(c),a._foregroundContainer.interactive=!0,r&&a.wireEvents(),a}return Object(_.a)(i,[{key:"wireEvents",value:function(){var e=this;new D.Keyboard("Enter",!0).pressEvent=function(){return e.done()},this._foregroundContainer.on("touchstart",this.done.bind(this))}},{key:"done",value:function(){var e=this;Promise.all([this.fade(),this.fadeMusic()]).then((function(){Object(g.a)(Object(y.a)(i.prototype),"done",e).call(e)}))}},{key:"tick",value:function(e){this.enterText.alpha+=e/2e3,this.enterText.alpha>=1&&(this.enterText.alpha=.2),this.count+=e/2e3,this.godFilter.time=this.count,this.rainShader.uniforms.time=this.count}}]),i}(re),ce=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;return Object(p.a)(this,i),(a=t.call(this,e,n,"maps.maension")).dialogBox=void 0,a.withHud=!1,a.withCrosshair=!1,a.withPlayer=!1,a.withMouse=!1,a.dialogBox=new z(e),a.dialogBox.x=R.width/2-a.dialogBox.width/2,a.dialogBox.y=R.height/3-a.dialogBox.height/2,a.foregroundContainer.addChild(a.dialogBox),a.dialogBox.start(),a.dialogBox.onDone=function(){return a.done()},a}return Object(_.a)(i,[{key:"done",value:function(){var e=this;this.fade().then((function(){Object(g.a)(Object(y.a)(i.prototype),"done",e).call(e)}))}},{key:"tick",value:function(e){}}]),i}(re),ue=i(21),de=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;Object(p.a)(this,i),(a=t.call(this,e))._player=void 0,a._health=void 0,a._rounds=void 0,a._weapon=void 0,a._gameOverSign=void 0,a.zIndex=2;var s=e["things.hud"];console.log("Setting up HUD","width:",R.width,"height:",R.height),a._player=n;var r=Object(ue.a)(Object(ue.a)({},i.bigText),{},{fontSize:"12px"}),o=new v.Text(n.playerName,Object(ue.a)(Object(ue.a)({},r),{},{fill:"#ffff30"}));o.x=R.width/3-o.width/2,o.y=R.height-47,a.addChild(o),a._health=new v.Text("",r),a._health.x=o.x,a._health.y=R.height-23,a.addChild(a._health),a._rounds=new v.Container,a._rounds.x=R.width/3+77,a._rounds.y=R.height-33,a.addChild(a._rounds);var l=new v.Sprite(s.textures["side.png"]);l.x=R.width/2-(l.width+l.width/2)+2,l.y=R.height-l.height-2,a.addChild(l);var h=new v.Sprite(s.textures["center.png"]);h.x=R.width/2-h.width/2+1,h.y=R.height-h.height-2,a.addChild(h);var c=new v.Sprite(s.textures["side.png"]);return c.x=R.width/2+(h.width+c.width/2)-2,c.y=R.height-c.height-2,c.scale.x=-1,a.addChild(c),a.update(),a}return Object(_.a)(i,[{key:"_renderWeapon",value:function(){this.removeChild(this._weapon),this._weapon=new v.Sprite(this._player.weapon.sprite.texture),this._weapon.scale.x=3*this._player.weapon.sprite.scale.x,this._weapon.scale.y=3*this._player.weapon.sprite.scale.y,this._weapon.x=R.width/2+(this._weapon.width+50),this._weapon.y=R.height-60,this.addChild(this._weapon)}},{key:"_renderRounds",value:function(){this._rounds.removeChildren();for(var e=0;e<this._player.weapon.rounds;e++){var t,i=new v.Sprite(null===(t=this._player.weapon.roundsSprite)||void 0===t?void 0:t.texture);i.scale.x=.25,i.scale.y=.25,i.x=12*e,i.y=10,this._rounds.addChild(i)}}},{key:"update",value:function(){this._health.text=this._player.health+" HP",this._renderRounds(),this._renderWeapon()}},{key:"renderGameOver",value:function(){this._gameOverSign=new v.Text("Game Over\nPress Enter to retry!",Object(ue.a)(Object(ue.a)({},i.bigText),{},{fill:"#f00"})),this.addChild(this._gameOverSign),this._gameOverSign.x=R.width/2-this._gameOverSign.width/2,this._gameOverSign.y=R.height/2-this._gameOverSign.height/2}},{key:"tick",value:function(e){this._gameOverSign&&(this._gameOverSign.alpha+=e/1e3,this._gameOverSign.alpha>1&&(this._gameOverSign.alpha=.2))}}]),i}(H);de.bigText={fontFamily:"Arial Black",fontSize:"48px",fontWeight:"bold",fill:"#fff",dropShadow:!0,dropShadowColor:"#000",align:"center"};var pe=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(e,n){var a;return Object(p.a)(this,i),(a=t.call(this,e,n))._hud=void 0,a._player=void 0,a._beacon=void 0,a._enemies=[],a._mouseLocation=void 0,a._mouseLine=void 0,a._crosshair=void 0,a._init(),a}return Object(_.a)(i,[{key:"switchMap",value:function(e){return this._stage.removeChild(this._map),this._stage.removeChild(this._hud),this._map&&(this._map.destroy({children:!0,baseTexture:!0}),delete this._map),this._map=e,this._stage.addChild(this._map),this._player&&this._map.withPlayer&&(this._player.x=60,this._player.y=400,this._player.adaptScale(this._player.y,R.height),this._player.map=this._map,this._map.actorContainer.addChild(this._player)),this._map.withCrosshair&&(this._crosshair=new B(this._resources),this._crosshair.adaptScale(this._player.y,R.height),this._stage.cursor="none"),this._map.withHud&&(this._stage.addChild(this._hud),this._updateHud()),this._map.withMouse&&(this._attachMouse(),this._updateMouseLocation(new v.Point(R.width/2,R.height/2))),this._stage.children.sort(N),e}},{key:"_init",value:function(){var e=this;this._player=new ie(this._resources,"taro"),this._hud=new de(this._resources,this._player),this.switchMap(new he(this._resources,this._stage)).onDone=function(){e.switchMap(new ce(e._resources,e._stage)).onDone=function(){return e.switchMap(new oe(e._resources,e._stage))}},this._beacon=new A(this._resources,80,5),this._attachGamepad()||(console.log("no gamepad, attaching stinky keyboard"),this._attachKeyboard()),this._enemies=[],this._isRunning=!0,console.log("Game:","Game init done!")}},{key:"_attachMouse",value:function(){var e=this;this._mouseLine=new v.Graphics,this._mouseLine.zIndex=5,this._stage.addChild(this._mouseLine),this._crosshair&&this._stage.addChild(this._crosshair),this._stage.interactive=!0,this._stage.on("mousemove",(function(t){e._updateMouseLocation(t.data.global)})),this._stage.on("mousedown",(function(){return e._fire()})),this._stage.on("mouseout",(function(){return e._isRunning=!1})),this._stage.on("mouseover",(function(){return e._isRunning=e._player.state!==U.died}))}},{key:"_updateCrosshair",value:function(){var e;this._player&&this._player.state!==U.died&&this._crosshair&&this._mouseLocation&&this._isRunning&&(this._crosshair.x=this._mouseLocation.x-this._crosshair.width/2,this._crosshair.y=this._mouseLocation.y-this._crosshair.height/2,this._crosshair.x<this._player.toGlobal(this._stage).x?this._player.flip(!1):this._player.flip(!0),this._player.updateCrosshairPosition(this._stage.toGlobal(null===(e=this._crosshair)||void 0===e?void 0:e.position)),this._crosshair.adaptScale(this._player.y,R.height))}},{key:"_fire",value:function(){var e;if(this._isRunning&&(null===(e=this._player)||void 0===e?void 0:e.fire())){var t,i=new I(this._resources);i.scale.x=.1,i.scale.y=.1;var n=this._map.toLocal(this._crosshair);i.x=n.x+this._crosshair.width/2-i.width/2,i.y=n.y+this._crosshair.height/2-i.height/2,null===(t=this._map)||void 0===t||t.backgroundContainer.addChild(i),this._updateHud()}}},{key:"_moveRight",value:function(){this._isRunning&&this._player&&this._player.moveRight()}},{key:"_moveLeft",value:function(){this._isRunning&&this._player&&this._player.moveLeft()}},{key:"_moveUp",value:function(){this._isRunning&&this._player&&this._player.moveUp()}},{key:"_moveDown",value:function(){this._isRunning&&this._player&&this._player.moveDown()}},{key:"_stopMoveVertically",value:function(){var e;this._isRunning&&(null===(e=this._player)||void 0===e||e.stopMoveVertically())}},{key:"_stopMoveHorizontally",value:function(){var e;this._isRunning&&(null===(e=this._player)||void 0===e||e.stopMoveHorizontally())}},{key:"_attachKeyboard",value:function(){var e=this,t=new D.Keyboard("ArrowLeft",!0),i=new D.Keyboard("ArrowUp",!0),n=new D.Keyboard("ArrowRight",!0),a=new D.Keyboard("ArrowDown",!0),s=new D.Keyboard("w",!1),r=new D.Keyboard("r",!1),o=new D.Keyboard("Enter",!1);s.pressEvent=function(){return e._switchWeapon()},r.pressEvent=function(){return e._reload()},n.pressEvent=function(){return e._moveRight()},n.releaseEvent=function(){t.isDown||e._stopMoveHorizontally()},t.pressEvent=function(){return e._moveLeft()},t.releaseEvent=function(){n.isDown||e._stopMoveHorizontally()},i.pressEvent=function(){return e._moveUp()},i.releaseEvent=function(){a.isDown||e._stopMoveVertically()},a.pressEvent=function(){return e._moveDown()},a.releaseEvent=function(){i.isDown||e._stopMoveVertically()},o.pressEvent=function(){e._isRunning||e._init()}}},{key:"_attachGamepad",value:function(){var e=this;return!!D.Gamepads.init({0:{1:{pressEvent:function(){e._fire()}},15:{pressEvent:function(){return e._moveRight()},releaseEvent:function(){return e._stopMoveHorizontally()}},14:{pressEvent:function(){return e._moveLeft()},releaseEvent:function(){return e._stopMoveHorizontally()}},12:{pressEvent:function(){return e._moveUp()},releaseEvent:function(){return e._stopMoveVertically()}},13:{pressEvent:function(){return e._moveDown()},releaseEvent:function(){return e._stopMoveVertically()}},9:{pressEvent:function(){e._isRunning||e._init()}}}})}},{key:"_end",value:function(){this._isRunning=!1,this._hud.renderGameOver()}},{key:"_detectCollisions",value:function(){this._player.collides(this._beacon)&&this._player.speak("It's locked!");var e,t=Object(m.a)(this._enemies);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(U.died!==i.state&&U.died!==this._player.state&&this._player.collides(i)){var n=this._player.hitBy(i);n.objectTookDamage&&(this._drawBlood(this._player),this._updateHud()),n.died&&this._end()}}}catch(a){t.e(a)}finally{t.f()}}},{key:"_drawBlood",value:function(e){for(var t=0;t<5;t++){var i,n=new F(this._resources);n.x=e.x+D.MathHelper.getRandomInt(-20,20),n.y=e.y+e.height+D.MathHelper.getRandomInt(-20,20),n.rotation=D.MathHelper.getRandomInt(0,10),null===(i=this._map)||void 0===i||i.backgroundContainer.addChild(n)}}},{key:"_updateHud",value:function(){this._hud.update()}},{key:"_updateKI",value:function(){var e,t=Object(m.a)(this._enemies);try{for(t.s();!(e=t.n()).done;){var i=e.value;U.died!==i.state&&i.moveTowards(this._player.position)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_moveActors",value:function(){var e,t=this._player;t.move(R.height,this._map.width)&&(null===(e=this._map)||void 0===e||e.shallScroll(t.realx,t.vx),this._updateCrosshair());var i,n=Object(m.a)(this._enemies);try{for(n.s();!(i=n.n()).done;){i.value.move(R.height,this._map.width)}}catch(a){n.e(a)}finally{n.f()}}},{key:"_outlineMouse",value:function(){if(this._mouseLine&&this._mouseLocation&&this._player&&this._map){this._mouseLine.clear(),this._mouseLine.lineStyle(1,R.white),this._mouseLine.position=this._player.weaponLocation;var e=this._mouseLine.toLocal(this._mouseLocation),t=e.x,i=e.y;this._mouseLine.lineTo(t,i),this._mouseLine.endFill()}}},{key:"_switchWeapon",value:function(){this._isRunning&&(this._player.switchWeapon(),this._updateHud())}},{key:"_reload",value:function(){this._isRunning&&(this._player.reload(),this._updateHud())}},{key:"_updateMouseLocation",value:function(e){this._isRunning&&(this._mouseLocation=e,this._updateCrosshair())}},{key:"tick",value:function(e,t){if(Object(g.a)(Object(y.a)(i.prototype),"tick",this).call(this,e,t),D.Gamepads.updateStatus(),this._hud.tick(t),this._isRunning){var n;this._player.tick(t),this._map.tick(t);var a=parseInt((e/1e3).toString());this._startOffset||(this._startOffset=a);var s=a-this._startOffset;s!==this._elapsedSeconds&&(this._elapsedSeconds=s,this._updateHud()),this._detectCollisions(),this._updateKI(),this._moveActors();if(null===(n=this._map)||void 0===n||n.actorContainer.children.sort((function(e,t){var i=e.getBounds(),n=t.getBounds();return e.y+i.height<t.y+n.height-5?-1:e.y+i.height>t.y+n.height-5?1:0})),x){this._player.outline();var r,o=Object(m.a)(this._enemies);try{for(o.s();!(r=o.n()).done;){r.value.outline()}}catch(l){o.e(l)}finally{o.f()}this._outlineMouse()}}}}]),i}(function(){function e(t,i){Object(p.a)(this,e),this._stage=void 0,this._resources=void 0,this._isRunning=!0,this._map=void 0,this._elapsedSeconds=0,this._startOffset=void 0,this._stage=i,this._resources=t}return Object(_.a)(e,[{key:"tick",value:function(e,t){}}]),e}()),_e={"maps.maension":"maps/maension.json","taro.idle":"taro/idle.json","taro.idle_handgun":"taro/idle_handgun.json",arm:"taro/arm.png","bat.walk":"enemies/bat/walk.json","avatar.dejonghe":"enemies/dejonghe/avatar_dejonghe.png","weapons.shotgun":"weapons/shotgun.json","weapons.beretta":"weapons/beretta.json","beretta.fire":"sounds/beretta/mansion_sfx_gun_berreta_outside.wav","beretta.reload":"sounds/beretta/mansion_sfx_gun_berreta_reload.wav","weapons.impact":"things/decals.json","weapons.muzzle":"things/muzzle.json","bgm.title":"sounds/mansion_bgm_menu.mp3","bgm.outside":"sounds/mansion_bgm_outside_v3.mp3","sfx.keypress":"sounds/sfx/keypress.mp3","shaders.frag-smoke":"shaders/frag-smoke.glsl","shaders.frag-smoke2":"shaders/frag-smoke2.glsl","shaders.vert-spot":"shaders/vert-spot.glsl","shaders.frag-spot":"shaders/frag-spot.glsl","shaders.vert-2d":"shaders/vert-2d.glsl","shaders.frag-rain":"shaders/frag-rain.glsl","shaders.vert-light":"shaders/vert-light.glsl","shaders.frag-light":"shaders/frag-light.glsl","things.blood":"things/blood.json","things.door":"things/door.json","things.hud":"things/hud.json",lightmap:"things/lightmap.png",flashlight:"things/flashlight.png"},ve=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this))._fpsCount=0,e._fpsTimer=0,e._fps=void 0,e._fps=new v.Text("FPS: ",{fontWeight:"16px",fill:"#fff"}),e._fps.x=10,e._fps.y=10,e.addChild(e._fps),e}return Object(_.a)(i,[{key:"tick",value:function(e){this._fps&&(this._fpsCount++,this._fpsTimer+=e,this._fpsTimer>1e3&&(this._fps.text="FPS: "+this._fpsCount,this._fpsCount=0,this._fpsTimer=0))}}]),i}(v.Container),fe=function(e){Object(w.a)(i,e);var t=Object(b.a)(i);function i(){var e;Object(p.a)(this,i),(e=t.call(this)).lHeight=50,e.lWidth=300;var n=new v.Graphics;return n.lineStyle(5,R.white),n.drawRect(R.width/2-e.lWidth/2,R.height/2-e.lHeight/2,e.lWidth,e.lHeight),e.addChild(n),e}return Object(_.a)(i,[{key:"update",value:function(e){var t=new v.Graphics;t.lineStyle(5,R.white),t.beginFill(R.white),t.drawRect(R.width/2-this.lWidth/2,R.height/2-this.lHeight/2,this.lWidth/100*e,this.lHeight),this.children.length>1&&this.removeChildren(1),this.addChild(t)}}]),i}(v.Container),me=function(){function e(t){Object(p.a)(this,e),this._lastFrame=0,this._game=void 0,this._fpsCounter=void 0,this._container=void 0,this._app=void 0,this._root=void 0,this._loadingBar=void 0,this._container=t,this._app=new v.Application({width:R.width,height:R.height,backgroundColor:R.black}),this._container.appendChild(this._app.view),console.log("Viewport",this._container.clientWidth,this._container.clientHeight),this._root=new v.Container,this._app.stage.addChild(this._root),this.resize(),C&&(this._fpsCounter=new ve,this._app.stage.addChild(this._fpsCounter)),this._loadingBar=new fe,this._app.stage.addChild(this._loadingBar),window.addEventListener("resize",this.resize.bind(this)),this._tick(0)}return Object(_.a)(e,[{key:"resize",value:function(){var e,t,i=window.innerWidth-50,n=window.innerHeight;n/i<R.height/R.width?e=(t=n)*R.width/R.height:t=(e=i)*R.height/R.width,e>R.width&&(e=R.width),t>R.height&&(t=R.height),this._app.renderer.resize(e,t),this._root.scale.set(e/R.width,t/R.height)}},{key:"run",value:function(){var e=this,t={crossOrigin:!0},i=new v.Loader;Object.keys(_e).forEach((function(e){i.add(e,"".concat("assets","/").concat(_e[e]),t)})),i.onComplete.once(this._assetsLoaded.bind(this)),i.load(),i.onProgress.add((function(t){e._loadingBar.update(t.progress)}))}},{key:"_assetsLoaded",value:function(e,t){this._app.stage.removeChild(this._loadingBar),this._game=new pe(t,this._root),console.log("M\xe4nsion:","Init done, ready to scare!")}},{key:"_tick",value:function(e){var t=e-this._lastFrame;this._lastFrame=e,this._fpsCounter&&this._fpsCounter.tick(t),this._game&&this._game.tick(e,t),this._app.render(),requestAnimationFrame(this._tick.bind(this))}}]),e}();function ge(){var e=Object(n.useRef)(null),t=Object(n.useState)(),i=Object(d.a)(t,2),s=i[0],r=i[1];return Object(n.useEffect)((function(){if(!s&&e.current){var t=new me(e.current);t.run(),r(t)}}),[e,s]),a.a.createElement("div",{className:"maension",ref:e})}i(66);function ye(){return a.a.createElement("div",{className:"blocks"},a.a.createElement("div",{className:"block"},a.a.createElement("h2",null,"How to Play"),a.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed mattis sem nunc, vitae consectetur purus volutpat at. Integer at consequat arcu. Curabitur aliquam ex sit amet consectetur bibendum. Phasellus nec metus aliquam, vestibulum est et, efficitur metus. Fusce consectetur vel lectus non feugiat. Nam et ipsum leo. Mauris bibendum semper augue, non dapibus dui vestibulum id. In eget metus nec odio consectetur ultrices ut congue nisi. Vivamus et augue vel risus posuere pulvinar. Vestibulum placerat justo mi, sed aliquam massa lobortis vitae.")),a.a.createElement("div",{className:"block",style:{textAlign:"center"}},a.a.createElement("div",{className:"controls"},a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space center"},a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-arrow-up"}))),a.a.createElement("span",{className:"label"},": Move Up")),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space"},a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-arrow-left"})),a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-arrow-right"}))),a.a.createElement("span",{className:"label"},": Move Left/Right")),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space center"},a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-arrow-down"}))),a.a.createElement("span",{className:"label"},": Move Down")),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space center"},a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-mouse-pointer"})),a.a.createElement("div",{className:"button"},a.a.createElement("i",{className:"fas fa-mouse"}))),a.a.createElement("span",{className:"label"},": Aim/Fire")),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space center"},a.a.createElement("div",{className:"button"},"R")),a.a.createElement("span",{className:"label"},": Reload")),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"space center"},a.a.createElement("div",{className:"button"},"W")),a.a.createElement("span",{className:"label"},": Switch Weapon")))))}function we(){return a.a.createElement("div",null,a.a.createElement(h,null),a.a.createElement(ge,null),a.a.createElement("hr",null),a.a.createElement("div",{className:"page"},a.a.createElement(ye,null),a.a.createElement(u,null)),a.a.createElement(c,null))}r.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(we,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");o?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(i){var n=i.headers.get("content-type");404===i.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}()}},[[42,1,2]]]);
//# sourceMappingURL=main.60a45538.chunk.js.map