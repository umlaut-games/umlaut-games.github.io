{"version":3,"sources":["game/config.ts","game/objects/object-base.ts","game/objects/animation-base.ts","game/objects/decale.ts","game/tools/animation-helper.ts","game/tools/gamepads.ts","game/tools/keyboard.ts","game/tools/math-helper.ts","game/tools/enums.ts","game/objects/door.ts","game/objects/crosshair.ts","game/objects/blood.ts","game/objects/beacon.ts","game/objects/text-bubble.ts","game/actors/actor-base.ts","game/objects/weapons/weapon-base.ts","game/objects/weapons/shotgun.ts","game/objects/weapons/beretta.ts","game/actors/player.ts","game/actors/enemies/bat.ts","game/actors/enemies/enemy-base.ts","game/actors/enemies/bat.infected.ts","game/maps/map-base.ts","game/maps/maension-outside.ts","game/maps/house-outside.ts","game/maps/street.ts","game/maps/loading.ts","game/ui/hud.ts","game/game.ts","game/maension.ts","Maension.tsx","serviceWorker.ts","index.tsx"],"names":["Config","process","ObjectBase","resources","_outlineContainer","_baseScale","_resources","_isFacingRight","_vx","_vy","_vr","actor","actorBounds","getBounds","thisBounds","this","collides","x","width","y","height","console","log","scaleOffset","scale","_adaptScaleBasedOnOrientation","Math","abs","parent","removeChild","PIXI","b","lb","toLocal","coordinates","toFixed","fontSize","fill","addChild","outline","lineStyle","drawRect","endFill","AnimationBase","_clips","_currentClip","isFacingRight","delta","which","loop","dontRemove","undefined","Promise","resolve","reject","clipToPlay","err","zIndex","gotoAndPlay","children","sort","a","onComplete","stop","Decale","res","decale","textures","AnimationHelper","speed","frames","textureId","texture","push","clip","animationSpeed","anchor","Gamepads","events","_events","scanGamepads","_gamepads","event","addGamepad","gamepad","index","_state","removeGamepad","gamepadIndex","hasOwnProperty","axes","buttons","buttonIndex","button","state","pressed","isPressed","pressEvent","releaseEvent","gamepads","navigator","getGamepads","webkitGetGamepads","window","addEventListener","connectHandler","disconnectHandler","Keyboard","_key","_ignoreKeyup","_isDown","_isUp","_downHandler","bind","_upHandler","key","preventDefault","MathHelper","min","max","floor","random","v1","v2","atan2","sqrt","distanceToSq","dx","dy","ActorStates","idle","Symbol","for","walking","fire","died","Door","done","loadClip","filters","BlurFilter","_playClip","then","Crosshair","Blood","Beacon","bg","WHITE","EMPTY","tint","SCALE_MODE","NEAREST","TextBubble","text","duration","t","setTimeout","ActorBase","skin","_text","_lastFlip","_skin","_speed","_health","_power","_canGetHitAgain","constructor","name","_setState","objectTookDamage","power","_died","_idle","direction","_setIsFacingRight","target","vx","vy","distanceTo","position","angleToTarget","angleBetweenRad","sin","cos","_canFlipAgain","flip","canFlip","Date","now","realx","_logActorCoordinates","maxHeight","maxWidth","WeaponBase","rounds","_reloadTime","_isReloading","_maxRounds","_rounds","_sprite","_roundsSprite","muzzleFlash","Shotgun","Beretta","weapons","Player","_weapon","_name","shotgun","beretta","reload","weapon","isReloading","crosshairPosition","angle","weaponLocation","rotation","_canBeControlled","speak","playerMoved","adaptScale","moved","toGlobal","Bat","pivot","set","PI","enemyMoved","vr","BatInfected","f","ColorMatrixFilter","lsd","MapBase","_width","mapToLoad","_explorationOffset","_textures","_backgroundContainer","_actorContainer","_foregroundContainer","playerX","scrollAmount","Sound","require","default","MaensionOutside","starryNight","maension","tree","tree1","tree_dead","tree2","_setup","z1","from","z2","setInterval","play","HouseOutside","city","Street","cityWidth","concret","police","Loading","_door","HUD","player","_player","_gameOverSign","_height","smallTextConfig","bigText","playerName","healthBorder","roundsBorder","weaponBorder","update","sprite","removeChildren","roundSprite","roundsSprite","health","_renderRounds","_renderWeapon","alpha","fontFamily","fontWeight","dropShadow","dropShadowColor","align","maps","Game","stage","_stage","_hud","_map","_beacon","_enemies","_mouseLocation","_isRunning","_startOffset","_elapsedSeconds","_mouseLine","_crosshair","street","house","loading","_init","cursor","actorContainer","bat2","bat3","_attachGamepad","_attachKeyboard","_updateHud","_attachMouse","_updateMouseLocation","interactive","on","e","data","global","_fire","updateCrosshairPosition","impact","impactLocation","backgroundContainer","moveRight","moveLeft","moveUp","moveDown","stopMoveVertically","stopMoveHorizontally","left","up","right","down","k","w","r","enter","_switchWeapon","_reload","_moveRight","isDown","_stopMoveHorizontally","_moveLeft","_moveUp","_stopMoveVertically","_moveDown","init","0","1","15","14","12","13","9","renderGameOver","enemy","playerHit","hitBy","_drawBlood","_end","i","blood","getRandomInt","moveTowards","move","shallScroll","_updateCrosshair","clear","lineTo","switchWeapon","mouseLocation","elapsed","updateStatus","animate","elapsedSeconds","parseInt","toString","correctedElapsedSeconds","timeout","_detectCollisions","_updateKI","_moveActors","ab","bb","_outlineMouse","Maension","container","_lastFrame","_fpsCount","_fpsTimer","_game","_renderer","_stageWrapper","_fps","backgroundColor","appendChild","view","innerWidth","innerHeight","_animate","_assetsLoaded","options","crossOrigin","loader","add","assetPath","once","load","requestAnimationFrame","render","MaensionComponent","useRef","useState","setMaension","useEffect","current","m","run","className","ref","Boolean","location","hostname","match","ReactDOM","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"qRAAaA,GAIKC,EAJLD,GASYC,EATZD,GAcFC,EAdED,GAmBUC,EAnBVD,GAwBIC,EAxBJD,GA6BOC,E,cCvBPC,EAAb,kDA6CE,WACEC,GACC,IAAD,8BACA,gBA9CQC,uBA6CR,IA3CQC,WAAqB,EA2C7B,EApCQC,gBAoCR,IA7BQC,gBAA0B,EA6BlC,EAtBQC,IAAM,EAsBd,EAfQC,IAAM,EAed,EARQC,IAAM,EAWd,EAAKJ,WAAaH,EAHlB,EA/CJ,qDA2FIQ,GAEA,IAAMC,EAAcD,EAAME,YACpBC,EAAaC,KAAKF,YAElBG,EACJJ,EAAYK,EAAIL,EAAYM,MAAQJ,EAAWG,GAC/CL,EAAYK,EAAIH,EAAWG,EAAIH,EAAWI,OAC1CN,EAAYO,EAAIP,EAAYQ,OAASN,EAAWK,GAChDP,EAAYO,EAAIL,EAAWK,EAAIL,EAAWM,OAQ5C,OALIJ,GAAYhB,IACdqB,QAAQC,IAAI,OAAQR,GACpBO,QAAQC,IAAI,QAASV,IAGhBI,IA5GX,iCAgHIG,EACAC,GAEA,IAAMG,EAAcH,EAASD,EACzBK,EAAQT,KAAKV,WAAakB,EAAc,IAE5CR,KAAKS,MAAMP,EAAIO,EACfT,KAAKS,MAAML,EAAIK,EAEfT,KAAKU,kCAzHT,sDAiII,IAAID,EAAQT,KAAKS,MAAMP,GAClBF,KAAKR,gBAAkBiB,EAAQ,IAClCT,KAAKS,MAAMP,GAAKO,GAGdT,KAAKR,gBAAkBiB,EAAQ,IACjCT,KAAKS,MAAMP,EAAIS,KAAKC,IAAIH,MAvI9B,gCA6IQT,KAAKX,oBAEPW,KAAKa,OAAOC,YAAYd,KAAKX,0BAEtBW,KAAKX,mBAGdW,KAAKU,gCAELV,KAAKX,kBAAoB,IAAI0B,IAC7B,IAAMC,EAAIhB,KAAKF,YACTmB,EAAKjB,KAAKa,OAAOK,QAAQF,GAE/B,GAAI/B,EAA8B,CAChC,IAAMkC,EAAc,IAAIJ,IAAJ,aACZC,EAAEd,EAAEkB,QAAQ,GADA,eACSJ,EAAEZ,EAAEgB,QAAQ,GADrB,gBAC+BJ,EAAEb,MAAMiB,QAAQ,GAD/C,eACwDJ,EAAEX,OAAOe,QAAQ,IAAM,CAC/FC,SAAU,OACVC,KAAM,SAIVH,EAAYjB,EAAIe,EAAGf,EACnBiB,EAAYf,EAAIa,EAAGb,EAEnBJ,KAAKX,kBAAkBkC,SAASJ,GAIlC,IAAMK,EAAU,IAAIT,IACpBS,EAAQC,UACN,EACA,GAGFD,EAAQE,SACNT,EAAGf,EAAGe,EAAGb,EACTY,EAAEb,MACFa,EAAEX,QAGJmB,EAAQG,UAGR3B,KAAKX,kBAAkBkC,SAASC,GAEhCxB,KAAKa,OAAOU,SAASvB,KAAKX,qBA1L9B,yBA0DI,OAAOW,KAAKP,MA1DhB,yBAkEI,OAAOO,KAAKN,MAlEhB,yBA0EI,OAAOM,KAAKL,MA1EhB,4BAkFI,OAAOK,KAAKE,EAAKS,KAAKC,IAAIZ,KAAKG,OAAS,MAlF5C,GAAgCY,KCCnBa,EAAb,kDAoBE,WACExC,GACC,IAAD,8BACA,cAAMA,IAhBEyC,OAA2C,GAenD,EARQC,kBAQR,EAGA,EAAKvC,WAAaH,EAHlB,EAtBJ,8DAkCI2C,GAEA/B,KAAKR,eAAiBuC,EACtB/B,KAAKU,kCArCT,8BAwCiBsB,MAxCjB,gCA6CIC,EACAC,EACAC,GACC,IAAD,OAOA,OALInC,KAAK8B,eACP9B,KAAKc,YAAYd,KAAK8B,cACtB9B,KAAK8B,kBAAeM,GAGf,IAAIC,SAAQ,SAACC,EAAmBC,GAErC,IAAMC,EAAa,EAAKX,OAAOI,GAE/B,IAAKO,EAAY,CAEf,IAAMC,EAAM,uCAAyCR,EACrD3B,QAAQC,IAAIkC,EAAK,EAAKZ,QACtBU,EAAOE,GAGTD,EAAWE,OAAS,EAGpB,EAAKnB,SAASiB,GAGd,EAAKV,aAAeU,EAEpB,EAAK9B,gCAEL,EAAKoB,aAAaI,KAAOA,EACzB,EAAKJ,aAAaa,YAAY,GAE9B,EAAKC,SAASC,MACZ,SAACC,EAAG9B,GAAJ,OACE8B,EAAEJ,OAAS1B,EAAE0B,UAGZR,IACHM,EAAWO,WAAa,WACtBP,EAAWQ,OAENb,GACH,EAAKrB,YAAY0B,GAGnBF,aA5FV,GAAmCnD,GCDtB8D,EAAb,kDAEE,WACE7D,EACA6C,GACC,IAAD,sBAGA,IAAMiB,GAFN,cAAM9D,IAEWG,WAAW,iBAEtB4D,EAAS,IAAIpC,IAAYmC,EAAIE,SAAUnB,IAL7C,OAOA,EAAKV,SAAS4B,GAPd,EALJ,UAA4BvB,G,QCDfyB,EAAb,sGAGIjE,EACA6C,EACAqB,EACA7C,GAEA,IAAM8C,EAAyB,GAC/B,IAAK,IAAMC,KAAapE,EAAU6C,GAAOmB,SAAU,CACjD,IAAIK,EAAUrE,EAAU6C,GAAQmB,SAAUI,GAC1CD,EAAOG,KAAKD,GAGd,IAAME,EAAO,IAAI5C,IAAoBwC,GAOrC,OALAI,EAAKC,eAAiBN,EACtBK,EAAKlD,MAAMP,EAAIO,EACfkD,EAAKlD,MAAML,EAAIK,EACfkD,EAAKE,OAAO3D,EAAI,GAETyD,MArBX,KCYaG,EAAb,kGAKcC,GAKV,OAJAD,EAASE,QAAUD,EAEnBD,EAASG,eAEFH,EAASI,UAAU,IAAM,OAVpC,qCAawBC,GACpB7D,QAAQC,IAAI,qBAEZuD,EAASM,WAAWD,EAAME,WAhB9B,iCAmBoBA,GAChB/D,QAAQC,IAAI,iBAAkB8D,GAE9BP,EAASI,UAAUG,EAAQC,OAASD,EACpCP,EAASS,OAAOF,EAAQC,OAAS,KAvBrC,wCA0B2BH,GACvB7D,QAAQC,IAAI,wBAEZuD,EAASU,cAAcL,EAAME,WA7BjC,oCAgCuBA,GACnB/D,QAAQC,IAAI,2BACLuD,EAASI,UAAUG,EAAQC,cAC3BR,EAASS,OAAOF,EAAQC,SAnCnC,qCAwCI,IAAK,IAAMG,KADXX,EAASG,eACkBH,EAASI,UAClC,GAAIJ,EAASI,UAAUQ,eAAeD,GAAe,CACnD,IAAMJ,EAAmBP,EAASI,UAAUO,GAO5C,GALIJ,EAAQM,KAKRN,EAAQO,QACV,IAAK,IAAMC,KAAeR,EAAQO,QAChC,GAAIP,EAAQO,QAAQF,eAAeG,GAAc,CAC/C,IAAMC,EAAwBT,EAAQO,QAAQC,GAE9Cf,EAASS,OAAOE,GAAcI,GAC5Bf,EAASS,OAAOE,GAAcI,IAAgB,GAChDf,EAASE,QAAQS,GAAcI,GAC7Bf,EAASE,QAAQS,GAAcI,IAAgB,GAEjD,IAAME,EAAejB,EAASS,OAAOE,GAAcI,GAC7CV,EAAeL,EAASE,QAAQS,GAAcI,GAEhDC,EAAOE,UAAYD,EAAME,YAC3B3E,QAAQC,IAAI,iBAAkBkE,EAAcI,GAE5CE,EAAME,WAAY,EAEdd,EAAMe,YACRf,EAAMe,eAILJ,EAAOE,SAAWD,EAAME,YAC3B3E,QAAQC,IAAI,kBAAmBkE,EAAcI,GAE7CE,EAAME,WAAY,EAEdd,EAAMgB,cACRhB,EAAMgB,oBA9ExB,qCAyFI,IADoB,EACdC,EACJC,UAAUC,YAAcD,UAAUC,cAE7BD,UAAUE,kBAAoBF,UAAUE,oBAAsB,GAJjD,cAMEH,GANF,IAMpB,2BAAgC,CAAC,IAAtBf,EAAqB,QAE9B,GAAIA,EAAS,CACX,IAAMI,EAAeJ,EAAQC,MAGzBG,KAAgBX,EAASI,UAC3BJ,EAASI,UAAUO,GAAgBJ,GAEnC/D,QAAQC,IAAI,wCAAyCkE,GAErDX,EAASM,WAAWC,MAjBN,mCAxFxB,KAAaP,EACJI,UAAkC,GAD9BJ,EAEJS,OAAiB,GAFbT,EAGJE,QAAkB,GA+G3BwB,OAAOC,iBACL,mBACA3B,EAAS4B,gBAGXF,OAAOC,iBACL,sBACA3B,EAAS6B,mBCvIJ,IAAMC,EAAb,WA2BE,WACmBC,EACAC,GAChB,yBAFgBD,OAEjB,KADiBC,eACjB,KAvBMC,SAAU,EAuBhB,KAjBMC,OAAQ,EAiBd,KAVKd,WAAkC,KAUvC,KALKC,aAAoC,KAOzCK,OAAOC,iBACL,UACAzF,KAAKiG,aAAaC,KAAKlG,OACvB,GAEFwF,OAAOC,iBACL,QACAzF,KAAKmG,WAAWD,KAAKlG,OACrB,GAxCN,yDAsDImE,GAEIA,EAAMiC,MAAQpG,KAAK6F,OACrB1B,EAAMkC,iBAGFrG,KAAKgG,OAAShG,KAAKkF,YACrBlF,KAAKkF,aAGPlF,KAAK+F,SAAU,EACf/F,KAAKgG,OAAQ,KAjEnB,iCA0EqB7B,GACbA,EAAMiC,MAAQpG,KAAK6F,OACrB1B,EAAMkC,iBAGFrG,KAAK+F,SAAW/F,KAAKmF,cACvBnF,KAAKmF,eAGPnF,KAAK+F,SAAU,EACf/F,KAAKgG,OAAQ,KApFnB,6BA6CI,OAAOhG,KAAK+F,YA7ChB,KCDaO,EAAb,0GASsBC,EAAaC,GAC/B,OAAO7F,KAAK8F,MAAM9F,KAAK+F,UAAYF,EAAMD,IAAQA,IAVrD,sCAoBII,EACAC,GAEA,OAAOjG,KAAKkG,MAAMD,EAAGxG,EAAIuG,EAAGvG,EAAGwG,EAAG1G,EAAIyG,EAAGzG,KAvB7C,iCAgCoByG,EAAgBC,GAChC,OAAOjG,KAAKmG,KAAKR,EAAWS,aAAaJ,EAAIC,MAjCjD,mCA0CsBD,EAAgBC,GAClC,IAAII,EAAKL,EAAGzG,EAAI0G,EAAG1G,EACjB+G,EAAKN,EAAGvG,EAAIwG,EAAGxG,EAEjB,OAAO4G,EAAKA,EAAKC,EAAKA,MA9C1B,KCFaC,EAAc,CACzBC,KAAMC,OAAOC,IAAI,QACjBC,QAASF,OAAOC,IAAI,WACpBE,KAAMH,OAAOC,IAAI,QACjBG,KAAMJ,OAAOC,IAAI,SCGNI,GDCLL,OAAOC,IAAI,QACXD,OAAOC,IAAI,QACVD,OAAOC,IAAI,SACZD,OAAOC,IAAI,QCJnB,kDAEE,WACEjI,EACAsI,GACC,IAAD,sBAGA,IAAMzF,EAAQ,cAHd,OACA,cAAM7C,IAIDyC,OAAL,eACGI,EAAQoB,EAAgBsE,SACvB,EAAKpI,WACL0C,EACA,IACA,IAIJ,EAAKJ,OAAOI,GAAO2F,QAAU,CAAC,IAAI7G,IAAa8G,WAAW,KAE1D,EAAKC,UACH7F,GACA,GACA,GAEC8F,MAAK,WACAL,GACFA,OAvBN,EALJ,UAA0B9F,ICJboG,EAAb,kDAEE,WACE5I,GACC,IAAD,8BACA,cAAMA,IAEDmC,SACH,IAAIR,IAAU,IAAK,CACfO,KAAM,UALZ,EAJJ,UAA+BnC,GCGlB8I,EAAb,kDAEE,WACE7I,GAEC,IAAD,EADAkE,EACA,uDADgB,IAChB,oBAEA,IAAMrB,EAAQ,eAFd,OACA,cAAM7C,IAGDyC,OAAL,eACGI,EAAQoB,EAAgBsE,SACvB,EAAKpI,WACL0C,EACAqB,EACA,IAIJ,EAAKwE,UAAU7F,GAAO,GAAO,GAb7B,EALJ,UAA2BL,GCFdsG,EAAb,kDAEE,WACE9I,EACAe,EACAE,GACC,IAAD,uBACA,cAAMjB,IAEDI,gBAAiB,EAEtB,EAAKa,OAASA,EACd,EAAKF,MAAQA,EAEb,IAAMgI,EAAK,IAAIpH,IACb9B,EAA0B8B,IAAaqH,MAAQrH,IAAasH,OAT9D,OAYAF,EAAGhI,MAAQA,EACXgI,EAAG9H,OAASA,EAERpB,IACFkJ,EAAGG,KAAO,UAGZ,EAAK/G,SAAS4G,GAnBd,EANJ,UAA4BhJ,GCF5B4B,IAAcwH,WAAaxH,IAAiByH,QAKrC,IAAMC,EAAb,kDAEE,WACErJ,EACAsJ,EACAC,EACAjB,GACC,IAAD,sBACA,cAAMtI,GAEN,IAAMwJ,EAAI,IAAI7H,IACZ2H,EAAM,CACJrH,SAAU,OACVC,KAAM,SAEJ6G,EAAK,IAAIpH,IACbA,IAAaqH,OATf,OAYAD,EAAGhI,MAAQyI,EAAEzI,MACbgI,EAAG9H,OAASuI,EAAEvI,OACd8H,EAAGG,KAAO,EAEV,EAAK/G,SAAS4G,GACd,EAAK5G,SAASqH,GAEdC,YAAW,WACTnB,MACY,IAAXiB,GArBH,EAPJ,UAAgC/G,GCEnBkH,EAAb,kDAmDE,WACE1J,EACA2J,EACAzF,GACC,IAAD,8BACA,cAAMlE,IAtDE4J,WAqDR,IAlDMC,UAAY,EAkDlB,EA3CQC,WA2CR,IApCQC,OAAS,EAoCjB,EA7BQC,QAAU,IA6BlB,EAtBQC,OAAS,GAsBjB,EAhBQ9E,OAAiB2C,EAAYC,KAgBrC,EATQmC,iBAAkB,EAiB1B,EAAKJ,MAAQH,EAOb,EAAKI,OAAS7F,EAfd,EAvDJ,sDAsGsByB,GAClBzE,QAAQC,IAAIP,KAAKuJ,YAAYC,KAAM,aAAczE,GACjD/E,KAAKuE,OAASQ,IAxGlB,8BAiHQ/E,KAAKuE,SAAW2C,EAAYM,OAC9BxH,KAAKyJ,UAAUvC,EAAYC,MAE3BnH,KAAK8H,UACH9H,KAAKkJ,MAAQ,WACb,MAtHR,8BAgIIlJ,KAAKyJ,UAAUvC,EAAYM,MAG3BxH,KAAKN,IAAM,EACXM,KAAKP,IAAM,EACXO,KAAKL,IAAM,EAGXK,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,GACA,KA3IN,4BAqJItJ,GACC,IAAD,OAEI4H,GAAO,EACPkC,GAAmB,EAiDvB,OA/CI1J,KAAKsJ,kBAGPtJ,KAAKoJ,SAAWxJ,EAAM+J,MAEtBD,GAAmB,EAGnB1J,KAAKsJ,iBAAkB,EAGnBtJ,KAAKoJ,QAAU,GAEjBpJ,KAAKoJ,QAAU,EAGf5B,GAAO,EAEPxH,KAAK4J,UAML5J,KAAKP,IAAMG,EAAMJ,eAAiB,GAAK,EAGvCQ,KAAK8H,UACH9H,KAAKkJ,MAAQ,WACb,GAECnB,MAAK,WAKJ,EAAKtI,IAAM,EAGX,EAAK6J,iBAAkB,EAGvB,EAAKO,aAKN,CACLrC,OACAkC,sBA5MN,2BAiNII,GAEA9J,KAAK+J,uBACW3H,IAAd0H,EAA0BA,GAAa9J,KAAKR,kBApNlD,kCA4NqBwK,GACjB,IAEIC,EAAK,EACLC,EAAK,EAET,GALa5D,EAAW6D,WAAWnK,KAAKoK,SAAUJ,GAKvC,EAAG,CACZ,IAAIK,EAAgB/D,EAAWgE,gBAAgBtK,KAAKoK,SAAUJ,GAE9DE,EAAKvJ,KAAK4J,IAAIF,GAAiBrK,KAAKmJ,SACpCc,EAAKtJ,KAAK6J,IAAIH,GAAiBrK,KAAKmJ,QAG3B,IAAMnJ,KAAKR,gBAAkBQ,KAAKyK,iBAMlCR,EAAK,GAAKjK,KAAKR,gBAAkBQ,KAAKyK,kBAH7CzK,KAAK0K,OAUT1K,KAAKN,IAAMwK,EACXlK,KAAKP,IAAMwK,IAvPf,sCAgQI,IAAIU,GAAU,EAMd,OALIC,KAAKC,MAAQ7K,KAAKiJ,UAAY,MAChC0B,GAAU,EACV3K,KAAKiJ,UAAY2B,KAAKC,OAGjBF,IAtQX,6CA0QQ1L,GACFqB,QAAQC,IACN,IAAKP,KAAKE,EACV,SAAUF,KAAK8K,MACf,IAAK9K,KAAKI,EACV,QAASJ,KAAKG,MACd,SAAUH,KAAKK,UAhRvB,8BAsRIL,KAAK+K,uBACD/K,KAAKgJ,QACPhJ,KAAKgJ,MAAM9I,EAAIF,KAAKE,EAAIF,KAAKgJ,MAAM7I,MAAQ,EAC3CH,KAAKgJ,MAAM5I,EAAIJ,KAAKI,EAAI,MAzR9B,4BA8RIsI,GACC,IAAD,OACK1I,KAAKgJ,QACRhJ,KAAKgJ,MAAQ,IAAIP,EACfzI,KAAKT,WACLmJ,EAAM,GACN,WACE,EAAK7H,OAAOC,YAAY,EAAKkI,cACtB,EAAKA,SAGhBhJ,KAAKgJ,MAAMtG,OAAS,GACpB1C,KAAKgJ,MAAM9I,EAAIF,KAAKE,EAAIF,KAAKgJ,MAAM7I,MAAQ,EAC3CH,KAAKgJ,MAAM5I,EAAIJ,KAAKI,EAAI,GACxBJ,KAAKa,OAAOU,SAASvB,KAAKgJ,UA5ShC,2BAiTIgC,EACAC,GAEA,OAAO,IApTX,4BA8EI,OAAOjL,KAAKqJ,SA9EhB,6BAsFI,OAAOrJ,KAAKoJ,UAtFhB,4BA8FI,OAAOpJ,KAAKuE,WA9FhB,GAA+B3C,G,gBCLlBsJ,EAAb,kDA2BE,WACE9L,EACAuK,EACAwB,GACC,IAAD,8BACA,cAAM/L,IA9BEgM,iBA6BR,IA5BQC,cAAwB,EA4BhC,EA1BQhC,YA0BR,IAzBQiC,gBAyBR,IAxBQC,aAwBR,IAvBQC,aAuBR,IAtBQC,mBAsBR,EAGA,EAAKpC,OAASM,EACd,EAAK4B,QAAUJ,EACf,EAAKG,WAAaH,EAClB,EAAKC,YAAc,EAEnB,EAAK1I,OAAS,IAEd,EAAKxC,GAAK,EACV,EAAKE,EAAI,GAXT,EA/BJ,mDAYI,OAAOJ,KAAKuL,UAZhB,6BAgBI,OAAOvL,KAAKwL,UAhBhB,mCAoBI,OAAOxL,KAAKyL,gBApBhB,kCAwBI,OAAOzL,KAAKqL,iBAxBhB,4CA+CI,GACErL,KAAKuL,QAAU,IACdvL,KAAKqL,aACN,CAEA,IAAMK,EAAc,IAAIzD,EAAMjI,KAAKT,WAAY,GAS/C,OAPAmM,EAAYxL,EAAI,GAChBF,KAAKuB,SAASmK,GAEd1L,KAAKuL,WAIE,EAKT,OAAO,IAlEX,+BAqE4B,IAAD,OASvB,OAPAvL,KAAKqL,cAAe,EACpBxC,YAAW,WACT,EAAK0C,QAAU,EAAKD,WACpB,EAAKD,cAAe,IACA,IAAnBrL,KAAKoL,aAER9K,QAAQC,IAAI,WACL,MA9EX,GAAgCpB,GCEnBwM,EAAb,kDAME,WACEvM,GACC,IAAD,sBACA,cAAMA,EAAW,GAAI,GAErB,IAEM8D,EAAM9D,EAFE,mBAHd,OAOA,EAAKqM,cAAgB,IAAI1K,IACvBmC,EAAIE,SAAU,cAGhB,EAAKoI,QAAU,IAAIzK,IACjBmC,EAAIE,SAAU,gBAGhB,EAAKoI,QAAQ/K,MAAMP,EAAI,GACvB,EAAKsL,QAAQ/K,MAAML,EAAI,GAGvB,EAAKmB,SAAS,EAAKiK,SAnBnB,EARJ,UAA6BN,GCAhBU,EAAb,kDAME,WACExM,GACC,IAAD,sBACA,cAAMA,EAAW,GAAI,GAErB,IAEM8D,EAAM9D,EAFE,mBAHd,OAQA,EAAKoM,QAAU,IAAIzK,IACjBmC,EAAIE,SAAU,gBAGhB,EAAKoI,QAAQ/K,MAAMP,EAAI,GACvB,EAAKsL,QAAQ/K,MAAML,EAAI,GAGvB,EAAKmB,SAAS,EAAKiK,SAEnB,EAAKC,cAAgB,IAAI1K,IACvBmC,EAAIE,SAAU,cAnBhB,EARJ,UAA6B8H,GCOvBW,EAGF,GAKSC,EAAb,kDAkBE,WACE1M,EACA2J,GACC,IAAD,8BACA,cACE3J,EAAW2J,EAAM,IArBbgD,aAmBN,IAlBMC,MAAgB,SAuBtB,EAAK1M,WAAa,IAElB,EAAK8J,QAAU,GAGf,EAAKvH,OAAO,EAAKqH,MAAQ,WACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,UAAW,GAAK,GAElD,EAAKrH,OAAO,EAAKqH,MAAQ,SACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,QAAS,GAAK,GAEhD,EAAKrH,OAAO,EAAKqH,MAAQ,UACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,SAAU,GAAK,GAEjD,EAAKrH,OAAO,EAAKqH,MAAQ,SACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,QAAS,GAAK,GAEhD,EAAKrH,OAAO,EAAKqH,MAAQ,WACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,UAAW,GAAK,GAElD,EAAKrH,OAAO,EAAKqH,MAAQ,SACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,QAAS,GAAK,GAGhD2C,EAAQI,QAAU,IAAIN,EAAQvM,GAC9ByM,EAAQK,QAAU,IAAIN,EAAQxM,GAG9B,EAAK2M,QAAUF,EAAQK,QACvB,EAAK3K,SAAS,EAAKwK,SAGnB,EAAKlC,QA3CL,EArBJ,mDAMI,OAAO7J,KAAK+L,UANhB,2BAUI,OAAO/L,KAAKgM,UAVhB,8CAqEIhM,KAAK+L,QAAQI,WArEjB,qCAyESnM,KAAKoM,OAAOC,cACfrM,KAAKc,YAAYd,KAAK+L,SAElB/L,KAAK+L,mBAAmBJ,EAC1B3L,KAAK+L,QAAUF,EAAQK,QAEvBlM,KAAK+L,QAAUF,EAAQI,QAGzBjM,KAAKuB,SAASvB,KAAK+L,YAlFzB,8CAuFIO,GAEA,IAAMC,EAAgBvM,KAAKR,eACzB8G,EAAWgE,gBAAgBtK,KAAKwM,eAAgBF,IAC/ChG,EAAWgE,gBAAgBgC,EAAmBtM,KAAKwM,gBACtDxM,KAAK+L,QAAQU,SAAWF,IA5F5B,yCA2GI,OAAIvM,KAAKuE,SAAW2C,EAAYM,MAC9BlH,QAAQC,IAAI,uCACL,GAIPP,KAAKuE,SAAW2C,EAAYC,MAC5BnH,KAAKuE,SAAW2C,EAAYI,UAlHlC,8BA2HI,8DAKAtH,KAAKI,GAAKJ,KAAKK,OAAS,EAExBL,KAAKK,OAASL,KAAKK,OAAS,IAlIhC,6BAwI0B,IAAD,OACrB,IAAKL,KAAK0M,mBACR,OAAO,EAIT,IAAMnF,EAAOvH,KAAK+L,QAAQxE,OAC1B,OAAIA,GAGFvH,KAAK2M,MAAM,YAGX3M,KAAKyJ,UAAUvC,EAAYK,MAC3BvH,KAAKP,IAAM,EACXO,KAAKN,IAAM,EAGXM,KAAK8H,UACH9H,KAAKkJ,MAAQ,UACb,GAECnB,MAAK,WAEJ,EAAK8B,YAEF,IAEP7J,KAAK6J,SACE,KArKb,kCA6KQ7J,KAAK0M,qBACP1M,KAAKP,IAAMO,KAAKmJ,OAChBnJ,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,GAEFlJ,KAAKyJ,UAAUvC,EAAYI,YAnLjC,iCA2LQtH,KAAK0M,qBACP1M,KAAKP,KAAOO,KAAKmJ,OACjBnJ,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,GAEFlJ,KAAKyJ,UAAUvC,EAAYI,SAC3BtH,KAAKU,mCAlMX,6CA0MIV,KAAKP,IAAM,EACM,IAAbO,KAAKN,KAAaM,KAAK0M,oBACzB1M,KAAK6J,UA5MX,+BAoNQ7J,KAAK0M,qBACP1M,KAAKN,KAAOM,KAAKmJ,OACjBnJ,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,GAEFlJ,KAAKyJ,UAAUvC,EAAYI,YA1NjC,iCAkOQtH,KAAK0M,qBACP1M,KAAKN,IAAMM,KAAKmJ,OAChBnJ,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,GAEFlJ,KAAKyJ,UAAUvC,EAAYI,YAxOjC,2CAgPItH,KAAKN,IAAM,EACM,IAAbM,KAAKP,KAAaO,KAAK0M,oBACzB1M,KAAK6J,UAlPX,4BAuPInB,GAEA,uEAAe1I,KAAKgM,MAApB,aAA8BtD,MAzPlC,2BA6PIsC,EACAC,GAEA,IAAI2B,GAAc,EAyClB,OArCc,IAAZ5M,KAAKkK,IACLlK,KAAKI,EAAIJ,KAAKkK,GAAK,GAEnBlK,KAAKI,EAAIJ,KAAKK,OAASL,KAAKkK,GAAKc,IAEjChL,KAAKI,GAAKJ,KAAKkK,GACf0C,GAAc,GAIZ5M,KAAKiK,GAAK,EAGVjK,KAAK8K,MACLnK,KAAKC,IAAIZ,KAAKG,OAAS,EACvBH,KAAKiK,GAAKgB,IAEVjL,KAAKE,GAAKF,KAAKiK,GACf2C,GAAc,GAIT5M,KAAKiK,GAAK,GAGfjK,KAAK8K,MAAQ9K,KAAKiK,IAAM,IAExBjK,KAAKE,GAAKF,KAAKiK,GACf2C,GAAc,GAIdA,IACF5M,KAAK6M,WAAW7M,KAAKI,EAAG4K,GACxBhL,KAAK8M,SAGAF,IAzSX,qCAgGI,OAAO5M,KAAK+M,SACV/M,KAAK+L,QAAQ3B,cAjGnB,GAA4BtB,GCffkE,EAAb,kDAOE,WACE5N,EACA2J,GACC,uCACK3J,EAAW2J,EAAM,GAX3B,UCIA,kDAEE,WACE3J,EACA2J,GAEC,IAAD,EADAzF,EACA,uDADgB,EAChB,4BACA,cAAMlE,EAAW2J,EAAMzF,IAElB9D,gBAAiB,EAGtB,EAAKqC,OAAO,EAAKqH,MAAQ,SACvB7F,EAAgBsE,SACd,EAAKpI,WAAY,EAAK2J,MAAQ,QAAS,GAAK,GAEhD,EAAKrH,OAAO,EAAKqH,MAAQ,WAAa,EAAKrH,OAAO,EAAKqH,MAAQ,SAC/D,EAAKrH,OAAO,EAAKqH,MAAQ,SAAW,EAAKrH,OAAO,EAAKqH,MAAQ,SAG7D,EAAKW,QAdL,EANJ,oDA4BI7J,KAAKyJ,UAAUvC,EAAYC,MAC3BnH,KAAK8H,UACH9H,KAAKkJ,MAAQ,SACb,KA/BN,8BAuCqB,IAAD,OAChB,8DAGAlJ,KAAKI,GAAKJ,KAAKK,OAAS,EACxBL,KAAKiN,MAAMC,IAAIvM,KAAKC,IAAIZ,KAAKG,OAAS,EAAGH,KAAKK,QAC9CL,KAAKyM,SAAW,GAAK9L,KAAKwM,GAAK,IAE/BtE,YAAW,WACT,EAAKhI,OAAOC,YAAY,KACvB,OAjDP,2BAqDIkK,EACAC,GAEA,IAAImC,GAAa,EAgBjB,OAbc,IAAZpN,KAAKiK,IACO,IAAZjK,KAAKkK,IACO,IAAZlK,KAAKqN,KAELrN,KAAKE,GAAKF,KAAKiK,GACfjK,KAAKI,GAAKJ,KAAKkK,GACflK,KAAKyM,UAAYzM,KAAKqN,GAEtBD,GAAa,EAEbpN,KAAK6M,WAAW7M,KAAKI,EAAG4K,IAGnBoC,MAxEX,GAA+BtE,ICJlBwE,EAAb,kDAQE,WACElO,EACA2J,GACC,IAAD,uBACA,cAAM3J,EAAW2J,IAEZzJ,WAAa,IAGlB,IAAMiO,EAAI,IAAIxM,IAAayM,kBAN3B,OAOAD,EAAEE,KAAI,GACN,EAAK7F,QAAU,CAAC2F,GAEhB,EAAK9M,MAAMP,EAAI,EAAKZ,WACpB,EAAKmB,MAAML,EAAI,EAAKd,WAXpB,EAXJ,UAAiC0N,GCApBU,EAAb,kDAQE,WACEtO,EACUuO,EACVC,GACC,IAAD,8BACA,cAAMxO,IAHIuO,SAEV,EAVeE,wBAUf,IATQC,eASR,IARQC,0BAQR,IAPQC,qBAOR,IANQC,0BAMR,EAGA,EAAKJ,mBAAqB,EAAKF,OAAS,EAEpCC,IAEF,EAAKE,UAAY1O,EAAUwO,GAAWxK,UAQxC,EAAK2K,qBAAuB,IAAIhN,IAChC,EAAKQ,SAAS,EAAKwM,sBAOnB,EAAKC,gBAAkB,IAAIjN,IAC3B,EAAKQ,SAAS,EAAKyM,iBAOnB,EAAKC,qBAAuB,IAAIlN,IAChC,EAAKQ,SAAS,EAAK0M,sBAhCnB,EAZJ,0FA6EIC,EACAC,IAIGA,EAAe,GAAKD,EAAUlO,KAAK6N,mBAAqB7N,KAAK2N,QAE7DQ,EAAe,GAAKD,EAAUlO,KAAK6N,mBAAqB7N,KAAK6N,sBAG9D7N,KAAKE,GAAKiO,EAGNnO,KAAKE,EAAI,IACXF,KAAKE,EAAI,GAIPF,KAAKE,EAAIF,KAAK2N,OAAS3N,KAAKG,QAC9BH,KAAKE,EAAIF,KAAK2N,OAAS3N,KAAKG,UAhGpC,qCAoDI,OAAOH,KAAKgO,kBApDhB,0CA4DI,OAAOhO,KAAK+N,yBA5DhB,GAA6BnM,GCHtBwM,EAASC,EAAQ,IAAcC,QAA/BF,MAKMG,EAAb,kDAEE,WACEnP,EACAe,GACC,IAAD,sBACA,cAAMf,EAAWe,EAAO,iBAExB,IAAIqO,EAAc,IAAIzN,IACpB,EAAK+M,UAAW,wCAElBU,EAAY/N,MAAMP,EAAI,KACtBsO,EAAY/N,MAAML,EAAI,KAEtB,EAAK2N,qBAAqBxM,SAASiN,GAEnC,IAAIC,EAAW,IAAI1N,IACjB,EAAK+M,UAAW,qBAGlBW,EAASrO,GAAK,GACdqO,EAAShO,MAAMP,EAAI,EACnBuO,EAAShO,MAAML,EAAI,EAEnB,EAAK2N,qBAAqBxM,SAASkN,GAEnC,IAAMC,EAAO,EAAKZ,UAAW,YACvBa,EAAQ,IAAI5N,IAAY2N,GAC9BC,EAAMzO,EAAI,IACVyO,EAAMvO,EAAI,IACVuO,EAAMlO,MAAMP,EAAI,GAChByO,EAAMlO,MAAML,EAAI,GAEhB,EAAK4N,gBAAgBzM,SAASoN,GAE9B,IAAMC,EAAY,EAAKd,UAAW,iBAC5Be,EAAQ,IAAI9N,IAAY6N,GA/B9B,OAgCAC,EAAM3O,EAAI,GACV2O,EAAMzO,EAAI,IACVyO,EAAMpO,MAAMP,EAAI,GAChB2O,EAAMpO,MAAML,EAAI,GAEhB,EAAK2N,qBAAqBxM,SAASsN,GAEnC,EAAKC,SAvCL,EALJ,qDAoDI,IAAMC,EAAKX,EAAMY,KAAK,6BAChBC,EAAKb,EAAMY,KAAK,6BAEtBE,aAAY,WACVH,EAAGI,SACF,MAEHD,aAAY,WACVD,EAAGE,SACF,SA7DP,GAAqCzB,GCL9BU,EAASC,EAAQ,IAAcC,QAA/BF,MAKMgB,EAAb,kDAEE,WACEhQ,EACAe,GACC,IAAD,8BACA,cAAMf,EAAWe,EAAO,eAEnB2O,SAHL,EALJ,qDAgBI,IAAIO,EAAO,IAAItO,IAEbf,KAAK8N,UAAU,cAGjBuB,EAAK5O,MAAMP,EAAI,IACfmP,EAAK5O,MAAML,EAAI,IAEfJ,KAAK+N,qBAAqBxM,SAAS8N,GAEnC,IAAMN,EAAKX,EAAMY,KAAK,6BAChBC,EAAKb,EAAMY,KAAK,6BAEtBE,aAAY,WACVH,EAAGI,SACF,MAEHD,aAAY,WACVD,EAAGE,SACF,SAnCP,GAAkCzB,GCFrB4B,EAAb,kDAEE,WACElQ,EACAe,GACC,IAAD,8BACA,cAAMf,EAAWe,EAAO,gBAEnB2O,SAHL,EALJ,qDAqBI,IAAIO,EAAO,IAAItO,IAAYf,KAAK8N,UAAU,eACtCyB,EAAYF,EAAKlP,MACrBkP,EAAK5O,MAAMP,EAAI,EACfmP,EAAK5O,MAAML,EAAI,IACfiP,EAAKjP,GAAK,IAEV,IAAIoP,EAAU,IAAIzO,IAEhBf,KAAK8N,UAAU,gBAEjB0B,EAAQrP,MAAQoP,EAChBC,EAAQnP,OAAS,IACjBmP,EAAQ/O,MAAMP,EAAI,EAClBsP,EAAQ/O,MAAML,EAAI,KAClBoP,EAAQpP,EAAI,IAGZJ,KAAK+N,qBAAqBxM,SAASiO,GAEnCxP,KAAK+N,qBAAqBxM,SAAS8N,GAInC,IAAII,EAAS,IAAI1O,IAAYf,KAAK8N,UAAU,eAC5C2B,EAAOhP,MAAMP,EAAI,EACjBuP,EAAOhP,MAAML,EAAI,EAEjBqP,EAAOrP,EAAIJ,KAAKK,OAAyB,EAAhBoP,EAAOpP,OAChCoP,EAAOvP,EAAI,IACXF,KAAKiO,qBAAqB1M,SAASkO,OAlDvC,GAA4B/B,GCCfgC,EAAb,kDAIE,WACEtQ,EACAe,EACAuH,GACC,IAAD,uBACA,cAAMtI,EAAWe,IAPFwP,WAMf,EAGA,IAAMxH,EAAK,IAAIpH,IAAYA,IAAaqH,OAHxC,OAKA,EAAKuH,MAAQ,IAAIlI,EACfrI,EACAsI,GAEF,EAAKiI,MAAMzP,EAAIC,EAAQ,EACvB,EAAKwP,MAAMvP,EAAI,GAEf+H,EAAGhI,MAAQA,EACXgI,EAAG9H,OAAS,IACZ8H,EAAGG,KAAO,EAEV,EAAKyF,qBAAqBxM,SAAS4G,GAEnC,EAAK2G,SAlBL,EARJ,qDAkCI9O,KAAKiO,qBAAqB1M,SAASvB,KAAK2P,SAlC5C,8BAqCiB3N,GACbhC,KAAK2P,MAAMvP,GAAK4B,EAAQ,IACxB,IAAMvB,EAAQT,KAAK2P,MAAMlP,MAAMP,EAAI8B,EAAQ,IAC3ChC,KAAK2P,MAAMlP,MAAMP,EAAIO,EACrBT,KAAK2P,MAAMlP,MAAML,EAAIK,MAzCzB,GAA6BiN,G,QCHhBkC,EAAb,kDA0BE,WACExQ,EACAyQ,EACA1P,EACAE,GACC,IAAD,uBACA,cAAMjB,IA9BA0Q,aA6BN,IA5BM1G,aA4BN,IAzBMmC,aAyBN,IAvBMQ,aAuBN,IApBMgE,mBAoBN,IAlBMpC,YAkBN,IAjBMqC,aAiBN,EAGA,IAEM9M,EAAM9D,EAFE,cAId,EAAKuO,OAASxN,EACd,EAAK6P,QAAU3P,EAEfC,QAAQC,IACN,iBACA,SAAU,EAAKoN,OACf,UAAW,EAAKqC,SAGlB,EAAKF,QAAUD,EAEf,IAAMI,EAAe,2BAChBL,EAAIM,SADY,IAEnB7O,SAAU,SAGN8O,EAAa,IAAIpP,IACrB8O,EAAOrG,KADU,2BAGZyG,GAHY,IAIf3O,KAAM,aAGV6O,EAAWjQ,EAAI,EAAKyN,OAAS,EAAIwC,EAAWhQ,MAAQ,EACpDgQ,EAAW/P,EAAI,EAAK4P,QAAU,GAC9B,EAAKzO,SAAS4O,GAEd,EAAK/G,QAAU,IAAIrI,IACjB,GACAkP,GAGF,EAAK7G,QAAQlJ,EAAIiQ,EAAWjQ,EAC5B,EAAKkJ,QAAQhJ,EAAI,EAAK4P,QAAU,GAChC,EAAKzO,SAAS,EAAK6H,SAEnB,EAAKmC,QAAU,IAAIxK,IACnB,EAAKwK,QAAQrL,EAAK,EAAKyN,OAAS,EAAK,GACrC,EAAKpC,QAAQnL,EAAI,EAAK4P,QAAU,GAEhC,EAAKzO,SAAS,EAAKgK,SAEnB,IAAM6E,EAAe,IAAIrP,IACvBmC,EAAIE,SAAU,aAGhBgN,EAAalQ,EAAI,EAAKyN,OAAS,GAAKyC,EAAajQ,MAAQiQ,EAAajQ,MAAQ,GAAK,EACnFiQ,EAAahQ,EAAI,EAAK4P,QAAUI,EAAa/P,OAAS,EAEtD,EAAKkB,SAAS6O,GAEd,IAAMC,EAAe,IAAItP,IACvBmC,EAAIE,SAAU,eAEhBiN,EAAanQ,EAAI,EAAKyN,OAAS,EAAK0C,EAAalQ,MAAQ,EAAK,EAC9DkQ,EAAajQ,EAAI,EAAK4P,QAAUK,EAAahQ,OAAS,EAEtD,EAAKkB,SAAS8O,GAEd,IAAMC,EAAe,IAAIvP,IACvBmC,EAAIE,SAAU,aAnEhB,OAsEAkN,EAAapQ,EAAI,EAAKyN,OAAS,GAAK0C,EAAalQ,MAAQmQ,EAAanQ,MAAQ,GAAK,EACnFmQ,EAAalQ,EAAI,EAAK4P,QAAUM,EAAajQ,OAAS,EAEtDiQ,EAAa7P,MAAMP,GAAK,EAExB,EAAKqB,SAAS+O,GAEd,EAAKC,SA7EL,EA/BJ,4DAgHIvQ,KAAKc,YAAYd,KAAK+L,SAEtB/L,KAAK+L,QAAU,IAAIhL,IAAYf,KAAK8P,QAAQ1D,OAAOoE,OAAQ/M,SAC3DzD,KAAK+L,QAAQtL,MAAMP,EAA0C,EAAtCF,KAAK8P,QAAQ1D,OAAOoE,OAAQ/P,MAAMP,EACzDF,KAAK+L,QAAQtL,MAAML,EAA0C,EAAtCJ,KAAK8P,QAAQ1D,OAAOoE,OAAQ/P,MAAML,EAEzDJ,KAAK+L,QAAQ7L,EAAIF,KAAK2N,OAAS,GAAK3N,KAAK+L,QAAQ5L,MAAQ,IACzDH,KAAK+L,QAAQ3L,EAAIJ,KAAKgQ,QAAU,GAEhChQ,KAAKuB,SAASvB,KAAK+L,WAzHvB,sCA8HI/L,KAAKuL,QAAQkF,iBAEb,IAAK,IAAIvQ,EAAI,EAAGA,EAAIF,KAAK8P,QAAQ1D,OAAOjB,OAAQjL,IAAK,CAAC,IAAD,EAE7CwQ,EAAc,IAAI3P,IAAJ,UAAgBf,KAAK8P,QAAQ1D,OAAOuE,oBAApC,aAAgB,EAAkClN,SACtEiN,EAAYjQ,MAAMP,EAAI,GACtBwQ,EAAYjQ,MAAML,EAAI,GACtBsQ,EAAYxQ,EAAI,GAAKA,EACrBwQ,EAAYtQ,EAAI,GAEhBJ,KAAKuL,QAAQhK,SAASmP,MAxI5B,+BA8II1Q,KAAKoJ,QAAQV,KAAO1I,KAAK8P,QAAQc,OAAS,MAE1C5Q,KAAK6Q,gBACL7Q,KAAK8Q,kBAjJT,uCAqJI9Q,KAAK+P,cAAgB,IAAIhP,IACvB,mCADmB,2BAGd6O,EAAIM,SAHU,IAIjB5O,KAAM,UAIVtB,KAAKuB,SAASvB,KAAK+P,eAGnB/P,KAAK+P,cAAc7P,EAAKF,KAAK2N,OAAS,EAAM3N,KAAK+P,cAAc5P,MAAQ,EACvEH,KAAK+P,cAAc3P,EAAKJ,KAAKgQ,QAAU,EAAMhQ,KAAK+P,cAAc1P,OAAS,IAjK7E,8BAoKiB2B,GACThC,KAAK+P,gBACP/P,KAAK+P,cAAcgB,OAAS/O,EAAQ,IAChChC,KAAK+P,cAAcgB,MAAQ,IAC7B/Q,KAAK+P,cAAcgB,MAAQ,SAxKnC,GAAyBnP,GAAZgO,EAgBJM,QAA0B,CAC/Bc,WAAY,cACZ3P,SAAU,OACV4P,WAAY,OACZ3P,KAAM,OACN4P,YAAY,EACZC,gBAAiB,OACjBC,MAAO,UCKX,IAAIC,EAA6B,GAKZC,G,WA+BnB,WACElS,EACAmS,EACApR,EAAeE,GACd,yBAlCKmR,YAkCN,OAhCMC,UAgCN,OA/BMC,UA+BN,OA9BM5B,aA8BN,OA7BM6B,aA6BN,OA5BMC,SAAwB,GA4B9B,KA3BMC,oBA2BN,OAzBMC,YAAsB,EAyB5B,KAvBMC,kBAuBN,OAtBMC,gBAAkB,EAsBxB,KArBezS,gBAqBf,OAnBeoO,YAmBf,OAlBeqC,aAkBf,OAhBMiC,gBAgBN,OAfMC,gBAeN,EACAlS,KAAKwR,OAASD,EAEdvR,KAAKT,WAAaH,EAClBY,KAAK2N,OAASxN,EACdH,KAAKgQ,QAAU3P,EAEfgR,EAAKc,OAAS,IAAI7C,EAChBtP,KAAKT,WACLS,KAAK2N,QAGP0D,EAAKe,MAAQ,IAAIhD,EACfpP,KAAKT,WACLS,KAAK2N,QAGP0D,EAAK5C,SAAW,IAAIF,EAClBvO,KAAKT,WACLS,KAAK2N,QAGP0D,EAAKgB,QAAU,IAAI3C,EACjB1P,KAAKT,WACLS,KAAK2N,QAGP3N,KAAKsS,Q,oDAQLtS,KAAKiS,WAAa,IAAIlR,IACtBf,KAAKkS,WAAa,IAAIlK,EAAUhI,KAAKT,YAErCS,KAAK0R,KAAOL,EAAK5C,SACjBzO,KAAKwR,OAAOjQ,SAASvB,KAAK0R,MAC1B1R,KAAKwR,OAAOe,OAAS,OAGrBvS,KAAK8P,QAAU,IAAIhE,EAAO9L,KAAKT,WAAY,OAE3CS,KAAK8P,QAAQ5P,EAAI,GACjBF,KAAK8P,QAAQ1P,EAAI,IAEjBJ,KAAK8P,QAASjD,WAAW7M,KAAK8P,QAAS1P,EAAGJ,KAAKgQ,SAC/ChQ,KAAKkS,WAAYrF,WAAW7M,KAAK8P,QAAS1P,EAAGJ,KAAKgQ,SAGlDhQ,KAAK0R,KAAKc,eAAejR,SAASvB,KAAK8P,SAEvC9P,KAAK2R,QAAU,IAAIzJ,EACjBlI,KAAKT,WAAY,GAAI,GAGvB,IAAMkT,EAAO,IAAIzF,EAAIhN,KAAKT,WAAY,OAChCmT,EAAO,IAAIpF,EAAYtN,KAAKT,WAAY,OAE9CS,KAAK2R,QAAQvH,SAASlK,EAAI,IAC1BF,KAAK2R,QAAQvH,SAAShK,EAAI,IAE1BqS,EAAKrI,SAASlK,EAAI,IAClBuS,EAAKrI,SAAShK,EAAI,IAElBsS,EAAKtI,SAASlK,EAAI,IAClBwS,EAAKtI,SAAShK,EAAI,IAElBJ,KAAK0R,KAAKc,eAAejR,SAASvB,KAAK2R,SACvC3R,KAAK0R,KAAKc,eAAejR,SAASkR,GAClCzS,KAAK0R,KAAKc,eAAejR,SAASmR,GAGlB1S,KAAK2S,mBAKnBrS,QAAQC,IAAI,yCACZP,KAAK4S,mBAIP5S,KAAK4R,SAAW,GAIhB5R,KAAKyR,KAAO,IAAI7B,EACd5P,KAAKT,WACLS,KAAK8P,QACL9P,KAAK2N,OACL3N,KAAKgQ,SAGPhQ,KAAKwR,OAAOjQ,SAASvB,KAAKyR,MAE1BzR,KAAK6S,aAEL7S,KAAK8S,eAEL9S,KAAK+S,qBAAqB,IAAIhS,IAAWf,KAAK2N,OAAS,EAAG3N,KAAKgQ,QAAU,IAEzEhQ,KAAK+R,kBAAe3P,EAGpBpC,KAAK8R,YAAa,EAElBxR,QAAQC,IACN,QACA,qB,qCAIoB,IAAD,OACrBP,KAAKwR,OAAOjQ,SAASvB,KAAKiS,YAC1BjS,KAAKwR,OAAOjQ,SAASvB,KAAKkS,YAE1BlS,KAAKwR,OAAOwB,aAAc,EAC1BhT,KAAKwR,OAAOyB,GACV,aACA,SAACC,GACC,EAAKH,qBAAqBG,EAAEC,KAAKC,WAGrCpT,KAAKwR,OAAOyB,GACV,aACA,kBACE,EAAKI,WAGTrT,KAAKwR,OAAOyB,GACV,YACA,kBAAM,EAAKnB,YAAa,KAG1B9R,KAAKwR,OAAOyB,GACV,aACA,kBAAM,EAAKnB,WAAa,EAAKhC,QAAS/K,QAAUmC,EAAYM,U,yCAIpC,IAAD,EAKvB,EAHAxH,KAAK6R,gBACL7R,KAAK8R,aACL,UAAA9R,KAAK8P,eAAL,eAAc/K,SAAUmC,EAAYM,OAEpCxH,KAAKkS,WAAYhS,EAAIF,KAAK6R,eAAgB3R,EAAIF,KAAKkS,WAAY/R,MAAQ,EACvEH,KAAKkS,WAAY9R,EAAIJ,KAAK6R,eAAgBzR,EAAIJ,KAAKkS,WAAY7R,OAAS,EAGpEL,KAAKkS,WAAYhS,EAAIF,KAAK8P,QAAS/C,SAAS/M,KAAKwR,QAAQtR,EAC3DF,KAAK8P,QAASpF,MAAK,GAEnB1K,KAAK8P,QAASpF,MAAK,GAIrB1K,KAAK8P,QAASwD,wBACZtT,KAAKwR,OAAOzE,SAAZ,UAAqB/M,KAAKkS,kBAA1B,aAAqB,EAAiB9H,WAIxCpK,KAAKkS,WAAYrF,WAAW7M,KAAK8P,QAAS1P,EAAGJ,KAAKgQ,Y,8BAK9B,IAAD,EAArB,GAAIhQ,KAAK8R,aACP,UAAI9R,KAAK8P,eAAT,aAAI,EAAcvI,QAAQ,CAAC,IAAD,EAElBgM,EAAS,IAAItQ,EAAOjD,KAAKT,WAAY,cAC3CgU,EAAO9S,MAAMP,EAAI,GACjBqT,EAAO9S,MAAML,EAAI,GAEjB,IAAMoT,EAAiBxT,KAAK0R,KAAMxQ,QAAQlB,KAAKkS,YAC/CqB,EAAOrT,EAAIsT,EAAetT,EAAIF,KAAKkS,WAAY/R,MAAQ,EAAIoT,EAAOpT,MAAQ,EAC1EoT,EAAOnT,EAAIoT,EAAepT,EAAIJ,KAAKkS,WAAY7R,OAAS,EAAIkT,EAAOlT,OAAS,EAE5E,UAAAL,KAAK0R,YAAL,SAAW+B,oBAAoBlS,SAASgS,GAExCvT,KAAK6S,gB,mCAML7S,KAAK8R,YAAc9R,KAAK8P,SAC1B9P,KAAK8P,QAAQ4D,c,kCAKX1T,KAAK8R,YAAc9R,KAAK8P,SAC1B9P,KAAK8P,QAAQ6D,a,gCAKX3T,KAAK8R,YAAc9R,KAAK8P,SAC1B9P,KAAK8P,QAAQ8D,W,kCAKX5T,KAAK8R,YAAc9R,KAAK8P,SAC1B9P,KAAK8P,QAAQ+D,a,4CAKO,IAAD,EAAjB7T,KAAK8R,aACP,UAAA9R,KAAK8P,eAAL,SAAcgE,wB,8CAKM,IAAD,EAAjB9T,KAAK8R,aACP,UAAA9R,KAAK8P,eAAL,SAAciE,0B,wCAIS,IAAD,OAEtBC,EAAO,IAAIpO,EAAS,aAAa,GACjCqO,EAAK,IAAIrO,EAAS,WAAW,GAC7BsO,EAAQ,IAAItO,EAAS,cAAc,GACnCuO,EAAO,IAAIvO,EAAS,aAAa,GAEjCwO,EAAI,IAAIxO,EAAS,KAAK,GACtByO,EAAI,IAAIzO,EAAS,KAAK,GACtB0O,EAAI,IAAI1O,EAAS,KAAK,GAEtB2O,EAAQ,IAAI3O,EAAS,SAAS,GAEhCwO,EAAElP,WAAa,kBAAM,EAAKmO,SAC1BgB,EAAEnP,WAAa,kBAAM,EAAKsP,iBAC1BF,EAAEpP,WAAa,kBAAM,EAAKuP,WAE1BP,EAAMhP,WAAa,kBAAM,EAAKwP,cAC9BR,EAAM/O,aAAe,WACd6O,EAAKW,QACR,EAAKC,yBAITZ,EAAK9O,WAAa,kBAAM,EAAK2P,aAC7Bb,EAAK7O,aAAe,WACb+O,EAAMS,QACT,EAAKC,yBAITX,EAAG/O,WAAa,kBAAM,EAAK4P,WAC3Bb,EAAG9O,aAAe,WACXgP,EAAKQ,QACR,EAAKI,uBAITZ,EAAKjP,WAAa,kBAAM,EAAK8P,aAC7Bb,EAAKhP,aAAe,WACb8O,EAAGU,QACN,EAAKI,uBAITR,EAAMrP,WAAa,WACZ,EAAK4M,YACR,EAAKQ,W,uCAKwB,IAAD,OAChC,QAASxO,EAASmR,KAAK,CAErBC,EAAG,CAEDC,EAAG,CACDjQ,WAAY,WACV,EAAKmO,UAIT+B,GAAI,CACFlQ,WAAY,kBAAM,EAAKwP,cACvBvP,aAAc,kBAAM,EAAKyP,0BAG3BS,GAAI,CACFnQ,WAAY,kBAAM,EAAK2P,aACvB1P,aAAc,kBAAM,EAAKyP,0BAG3BU,GAAI,CACFpQ,WAAY,kBAAM,EAAK4P,WACvB3P,aAAc,kBAAM,EAAK4P,wBAG3BQ,GAAI,CACFrQ,WAAY,kBAAM,EAAK8P,aACvB7P,aAAc,kBAAM,EAAK4P,wBAG3BS,EAAG,CACDtQ,WAAY,WACL,EAAK4M,YACR,EAAKQ,e,6BAcftS,KAAK8R,YAAa,EAElB9R,KAAKyR,KAAMgE,mB,0CAOgB,IAAD,OAEtBzV,KAAK8P,QAAS7P,SAASD,KAAK2R,UAE9B3R,KAAK8P,QAASnD,MAAM,gBAGlB3M,KAAKkS,WAAYjS,SAASD,KAAK2R,WAEjC3R,KAAK2R,QAAU,IAAIzJ,EACjBlI,KAAKT,WACLS,KAAKgQ,QACLhQ,KAAK2N,QAGP3N,KAAKwR,OAAO1Q,YAAYd,KAAK0R,MAC7B1R,KAAK0R,KAAO,IAAIhC,EACd1P,KAAKT,WACLS,KAAK2N,QACL,WACE,EAAK+D,KAAO,IAAInD,EACd,EAAKhP,WACL,EAAKoO,WAIX3N,KAAKwR,OAAOjQ,SAASvB,KAAK0R,OA1BF,oBA6BN1R,KAAK4R,UA7BC,IA6B1B,2BAAmC,CAAC,IAAzB8D,EAAwB,QACjC,GAAIxO,EAAYM,OAASkO,EAAM3Q,OAC7BmC,EAAYM,OAASxH,KAAK8P,QAAS/K,OAE/B/E,KAAK8P,QAAS7P,SAASyV,GAAQ,CACjC,IAAMC,EAAY3V,KAAK8P,QAAS8F,MAAMF,GAElCC,EAAUjM,mBACZ1J,KAAK6V,WAAW7V,KAAK8P,SACrB9P,KAAK6S,cAIH8C,EAAUnO,MAEZxH,KAAK8V,SA5Ca,iC,iCAyD1BlW,GAEA,IAAK,IAAImW,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAAC,IAAD,EACpBC,EAAQ,IAAI/N,EAAMjI,KAAKT,YAE7ByW,EAAM9V,EAAIN,EAAMM,EAAIoG,EAAW2P,cAAc,GAAI,IACjDD,EAAM5V,EAAIR,EAAMQ,EAAIR,EAAMS,OAASiG,EAAW2P,cAAc,GAAI,IAChED,EAAMvJ,SAAWnG,EAAW2P,aAAa,EAAG,IAE5C,UAAAjW,KAAK0R,YAAL,SAAW+B,oBAAoBlS,SAASyU,M,mCAS1ChW,KAAKyR,KAAMlB,W,kCAOQ,IAAD,gBACEvQ,KAAK4R,UADP,IAClB,2BAAmC,CAAC,IAAzB8D,EAAwB,QAC7BxO,EAAYM,OAASkO,EAAM3Q,OAC7B2Q,EAAMQ,YAAYlW,KAAK8P,QAAS1F,WAHlB,iC,oCAYG,IAOJ,EANV0F,EAAW9P,KAAX8P,QACWA,EAASqG,KACzBnW,KAAKgQ,QACLhQ,KAAK0R,KAAMvR,SAKX,UAAAH,KAAK0R,YAAL,SAAW0E,YACTtG,EAAShF,MACTgF,EAAS7F,IAEXjK,KAAKqW,oBAba,oBAiBArW,KAAK4R,UAjBL,IAiBpB,2BAAmC,SAC3BuE,KACJnW,KAAKgQ,QACLhQ,KAAK0R,KAAMvR,QApBK,iC,sCA2BpB,GACEH,KAAKiS,YAAcjS,KAAK6R,gBACxB7R,KAAK8P,SAAW9P,KAAK0R,KACrB,CACA1R,KAAKiS,WAAWqE,QAChBtW,KAAKiS,WAAWxQ,UAAU,EAAG,UAG7BzB,KAAKiS,WAAW7H,SACdpK,KAAK8P,QAAQtD,eANf,MASexM,KAAKiS,WAAW/Q,QAAQlB,KAAK6R,gBAArC3R,EATP,EASOA,EAAGE,EATV,EASUA,EACVJ,KAAKiS,WAAWsE,OACdrW,EAAGE,GAGLJ,KAAKiS,WAAWtQ,a,sCAKd3B,KAAK8R,aACP9R,KAAK8P,QAAS0G,eACdxW,KAAK6S,gB,gCAKH7S,KAAK8R,aACP9R,KAAK8P,QAAS3D,SACdnM,KAAK6S,gB,2CAKP4D,GAEIzW,KAAK8R,aACP9R,KAAK6R,eAAiB4E,EACtBzW,KAAKqW,sB,6BAWPK,EACA1U,GAMA,GAJA8B,EAAS6S,eAET3W,KAAKyR,KAAMmF,QAAQ5U,GAEfhC,KAAK8R,WAAY,CAAC,IAAD,EACnB9R,KAAK0R,KAAMkF,QAAQ5U,GAEnB,IAAM6U,EAAiBC,UAAUJ,EAAU,KAAMK,YAG5C/W,KAAK+R,eACR/R,KAAK+R,aAAe8E,GAGtB,IAAMG,EAA2BH,EAAiB7W,KAAK+R,aAEnDiF,IAA4BhX,KAAKgS,kBACnChS,KAAKgS,gBAAkBgF,EACvBhX,KAAK6S,cAGHvB,EAAK2F,QAAUD,GAA2B,IAE5C1W,QAAQC,IAAI,qBACZP,KAAK8V,QAGP9V,KAAKkX,oBACLlX,KAAKmX,YACLnX,KAAKoX,cAyBL,GAHA,UAAApX,KAAK0R,YAAL,SAAWc,eAAe5P,SACvBC,MApBU,SACXC,EACA9B,GAEA,IAAMqW,EAAKvU,EAAEhD,YACPwX,EAAKtW,EAAElB,YAEb,OAAIgD,EAAE1C,EAAIiX,EAAGhX,OAASW,EAAEZ,EAAIkX,EAAGjX,OAAS,GAC9B,EAGNyC,EAAE1C,EAAIiX,EAAGhX,OAASW,EAAEZ,EAAIkX,EAAGjX,OAAS,EAC/B,EAGF,KAOLpB,EAAuB,CAEzBe,KAAK8P,QAAStO,UACdxB,KAAK2R,QAASnQ,UACdxB,KAAKkS,WAAY1Q,UAJQ,oBAOLxB,KAAK4R,UAPA,IAOzB,2BAAmC,SAC3BpQ,WARiB,8BAYzBxB,KAAKuX,sB,KAjmBQjG,GAsBJ2F,QAAkB,I,ICvDdO,G,WAWnB,WAAYC,GAA4B,yBAThCC,WAAqB,EASU,KAR/BC,UAAoB,EAQW,KAP/BC,UAAoB,EAOW,KAN/BC,WAM+B,OALtBC,eAKsB,OAJtBtG,YAIsB,OAHtBuG,mBAGsB,OAFtBC,UAEsB,EAErChY,KAAK8X,UAAY/W,IAAwB,CACvCZ,MAAO,IACPE,OAAQ,IACR4X,gBAAiB,UAGnBR,EAAUS,YAAYlY,KAAK8X,UAAUK,MAErC7X,QAAQC,IAAI,WAAYiF,OAAO4S,WAAY5S,OAAO6S,aAGlDrY,KAAKwR,OAAS,IAAIzQ,IAElBf,KAAK+X,cAAgB,IAAIhX,IACzBf,KAAK+X,cAAcxW,SAASvB,KAAKwR,QAE7BvS,IACFe,KAAKgY,KAAO,IAAIjX,IAAU,QAAS,CACjCkQ,WAAY,OACZ3P,KAAM,SAERtB,KAAKgY,KAAK9X,EAAI,GACdF,KAAKgY,KAAK5X,EAAI,GACdJ,KAAK+X,cAAcxW,SAASvB,KAAKgY,OAGnChY,KAAKsY,SAASpS,KAAKlG,MACnBA,KAAKuY,cAAcrS,KAAKlG,M,kDAOxB,IAAMwY,EAAU,CACdC,aAAa,GAKTC,EAAS,IAAI3X,IAGnB2X,EAAOC,IAAI,aAAcC,yBAAgCJ,GACzDE,EAAOC,IAAI,cAAeC,0BAAiCJ,GAC3DE,EAAOC,IAAI,gBAAiBC,4BAAmCJ,GAG/DE,EAAOC,IAAI,aAAcC,yBAAgCJ,GACzDE,EAAOC,IAAI,YAAaC,wBAA+BJ,GACvDE,EAAOC,IAAI,WAAYC,uBAA8BJ,GACrDE,EAAOC,IAAI,WAAYC,uBAA8BJ,GACrDE,EAAOC,IAAI,aAAcC,yBAAgCJ,GACzDE,EAAOC,IAAI,WAAYC,uBAA8BJ,GAGrDE,EAAOC,IAAI,WAAYC,8BAAqCJ,GAG5DE,EAAOC,IAAI,kBAAmBC,8BAAqCJ,GACnEE,EAAOC,IAAI,kBAAmBC,8BAAqCJ,GAGnEE,EAAOC,IAAI,eAAgBC,2BAAkCJ,GAC7DE,EAAOC,IAAI,cAAeC,0BAAiCJ,GAC3DE,EAAOC,IAAI,aAAcC,yBAAgCJ,GACzDE,EAAOC,IAAI,gBAAiBC,4BAAmCJ,GAE/DE,EAAO3V,WAAW8V,KAAK7Y,KAAKuY,cAAcrS,KAAKlG,OAG/C0Y,EAAOI,S,oCAUPJ,EACAtZ,GAIAY,KAAK6X,MAAQ,IAAIvG,GACflS,EACAY,KAAKwR,OACLxR,KAAK8X,UAAU3X,MACfH,KAAK8X,UAAUzX,QAGjBC,QAAQC,IAAI,cAAY,8BAExBwY,sBAAsB/Y,KAAKsY,SAASpS,KAAKlG,S,+BAO1B0W,GAEf,IAAI1U,EAAQ0U,EAAU1W,KAAK0X,WAC3B1X,KAAK0X,WAAahB,EAEd1W,KAAKgY,OACPhY,KAAK2X,YACL3X,KAAK4X,WAAa5V,EAGdhC,KAAK4X,UAAY,MAEnB5X,KAAKgY,KAAKtP,KAAO,QAAU1I,KAAK2X,UAEhC3X,KAAK2X,UAAY,EACjB3X,KAAK4X,UAAY,IAKjB5X,KAAK6X,OACP7X,KAAK6X,MAAMtH,OAAOmG,EAAS1U,GAI7BhC,KAAK8X,UAAUkB,OAAOhZ,KAAK+X,eAE3BgB,sBAAsB/Y,KAAKsY,SAASpS,KAAKlG,W,KC9I9B,SAASiZ,KAEtB,IAAM1H,EAAQ2H,iBAAO,MAFqB,EAGVC,qBAHU,mBAGnC1K,EAHmC,KAGzB2K,EAHyB,KAa1C,OARAC,qBAAU,WACR,IAAK5K,GAAY8C,EAAM+H,QAAS,CAC9B,IAAMC,EAAI,IAAI/B,GAASjG,EAAM+H,SAC7BC,EAAEC,MACFJ,EAAYG,MAEb,CAAChI,EAAO9C,IAGT,yBAAKgL,UAAU,YACb,0CAEA,yBAAKC,IAAKnI,IAEV,6BACE,uCAGA,0CCfYoI,QACW,cAA7BnU,OAAOoU,SAASC,UAEe,UAA7BrU,OAAOoU,SAASC,UAEhBrU,OAAOoU,SAASC,SAASC,MACvB,2DCZNC,IAASf,OACP,kBAAC,IAAMgB,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SDiIpB,kBAAmB7U,WACrBA,UAAU8U,cAAcC,MACrBrS,MAAK,SAAAsS,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLla,QAAQka,MAAMA,EAAMC,c","file":"static/js/main.05ea219b.chunk.js","sourcesContent":["export const Config = {\n  /**\n   * shall the objects be outlined in renderer or not\n   */\n  outlineObjects: process.env.NODE_ENV !== \"production\" && false,\n\n  /**\n   * show actor coordinates inside the outlines\n   */\n  showObjectCoordinates: process.env.NODE_ENV !== \"production\" && false,\n\n  /**\n   * shall we show the fps or not?\n   */\n  showFPS: process.env.NODE_ENV !== \"production\" && true,\n\n  /**\n   * shall we log the actor coordinates to the console?\n   */\n  logActorCoordinates: process.env.NODE_ENV !== \"production\" && false,\n\n  /**\n   * shall we log actor collisions?\n   */\n  logCollisions: process.env.NODE_ENV !== \"production\" && false,\n\n  /**\n   * highlight beacons\n   */\n  highlightBeacons: process.env.NODE_ENV !== \"production\" && false\n}\n","import * as PIXI from \"pixi.js\";\nimport { Config } from \"../config\"\n\n/**\n *\n */\nexport class ObjectBase extends PIXI.Container {\n\n  protected _outlineContainer?: PIXI.Container\n\n  protected _baseScale: number = 1\n\n  /**\n   *\n   * @type {Object}\n   * @protected\n   */\n  protected _resources: PIXI.IResourceDictionary\n\n  /**\n   * Is the this one facing right?\n   * @type {boolean}\n   * @protected\n   */\n  protected _isFacingRight: boolean = true;\n\n  /**\n   * the object velocity x\n   * @type {number}\n   * @protected\n   */\n  protected _vx = 0;\n\n  /**\n   * the object velocity y\n   * @type {number}\n   * @protected\n   */\n  protected _vy = 0;\n\n  /**\n   * the objects rotation velocity\n   * @type {number}\n   * @private\n   */\n  protected _vr = 0;\n\n  /**\n   *\n   * @param resources\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary\n  ) {\n    super();\n\n    this._resources = resources;\n  }\n\n  /**\n   *\n   * @returns {number}\n   */\n  get vx() {\n    return this._vx;\n  }\n\n  /**\n   *\n   * @returns {number}\n   */\n  get vy() {\n    return this._vy;\n  }\n\n  /**\n   *\n   * @returns {number}\n   */\n  get vr() {\n    return this._vr;\n  }\n\n  /**\n   *\n   * @returns {Number}\n   */\n  get realx() {\n    return this.x - (Math.abs(this.width) / 2);\n  }\n\n  /**\n   *\n   * @param actor\n   * @public\n   */\n  public collides(\n    actor: ObjectBase\n  ) {\n    const actorBounds = actor.getBounds()\n    const thisBounds = this.getBounds()\n\n    const collides = (\n      actorBounds.x + actorBounds.width > thisBounds.x &&\n      actorBounds.x < thisBounds.x + thisBounds.width &&\n      actorBounds.y + actorBounds.height > thisBounds.y &&\n      actorBounds.y < thisBounds.y + thisBounds.height\n    );\n\n    if (collides && Config.logCollisions) {\n      console.log(\"this\", thisBounds);\n      console.log(\"actor\", actorBounds);\n    }\n\n    return collides;\n  }\n\n  public adaptScale(\n    y: number,\n    height: number\n  ) {\n    const scaleOffset = height - y\n    let scale = this._baseScale - scaleOffset / 1000\n\n    this.scale.x = scale\n    this.scale.y = scale\n\n    this._adaptScaleBasedOnOrientation()\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _adaptScaleBasedOnOrientation() {\n    let scale = this.scale.x;\n    if (!this._isFacingRight && scale > 0) {\n      this.scale.x = -scale;\n    }\n\n    if (this._isFacingRight && scale < 0) {\n      this.scale.x = Math.abs(scale);\n    }\n  }\n\n  public outline() {\n    // do we have a outline?\n    if (this._outlineContainer) {\n      // yep remove if from child\n      this.parent.removeChild(this._outlineContainer);\n      // delete it\n      delete this._outlineContainer\n    }\n\n    this._adaptScaleBasedOnOrientation()\n\n    this._outlineContainer = new PIXI.Container()\n    const b = this.getBounds()\n    const lb = this.parent.toLocal(b)\n\n    if (Config.showObjectCoordinates) {\n      const coordinates = new PIXI.Text(\n        `x: ${b.x.toFixed(0)} y: ${b.y.toFixed(0)}\\nw: ${b.width.toFixed(0)} h: ${b.height.toFixed(0)}`, {\n          fontSize: \"10px\",\n          fill: \"#fff\"\n        } as PIXI.TextStyle\n      )\n\n      coordinates.x = lb.x\n      coordinates.y = lb.y\n\n      this._outlineContainer.addChild(coordinates)\n    }\n\n    // create new\n    const outline = new PIXI.Graphics();\n    outline.lineStyle(\n      1,\n      0x000\n    );\n\n    outline.drawRect(\n      lb.x, lb.y,\n      b.width,\n      b.height\n    );\n\n    outline.endFill();\n\n    // attach to object\n    this._outlineContainer.addChild(outline);\n\n    this.parent.addChild(this._outlineContainer)\n  }\n}","import * as PIXI from \"pixi.js\";\nimport { IDictionary } from \"../tools/IDictionary\"\nimport { ObjectBase } from \"./object-base\"\n\n/**\n *\n */\nexport class AnimationBase extends ObjectBase {\n\n  /**\n   * array for animations\n   * @type {{}}\n   * @protected\n   */\n  protected _clips: IDictionary<PIXI.AnimatedSprite> = {};\n\n  /**\n   * current clip that is beeing played\n   * @type {null}\n   * @private\n   */\n  protected _currentClip?: PIXI.AnimatedSprite;\n\n  /**\n   *\n   * @param resources\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary\n  ) {\n    super(resources);\n\n    this._resources = resources;\n  }\n\n  /**\n   *\n   * @param isFacingRight\n   * @protected\n   */\n  protected _setIsFacingRight(\n    isFacingRight: boolean\n  ) {\n    this._isFacingRight = isFacingRight;\n    this._adaptScaleBasedOnOrientation()\n  }\n\n  public animate(delta: number) {\n\n  }\n\n  protected _playClip(\n    which: string,\n    loop: boolean,\n    dontRemove?: boolean\n  ) {\n\n    if (this._currentClip) {\n      this.removeChild(this._currentClip);\n      this._currentClip = undefined;\n    }\n\n    return new Promise((resolve: Function, reject: Function) => {\n      // load punch clip\n      const clipToPlay = this._clips[which];\n\n      if (!clipToPlay) {\n\n        const err = \"AnimationBase: failed to load clip: \" + which;\n        console.log(err, this._clips);\n        reject(err);\n      }\n\n      clipToPlay.zIndex = 1\n\n      // play clip\n      this.addChild(clipToPlay);\n\n      // set the current playing clip\n      this._currentClip = clipToPlay;\n\n      this._adaptScaleBasedOnOrientation();\n\n      this._currentClip.loop = loop;\n      this._currentClip.gotoAndPlay(0);\n\n      this.children.sort(\n        (a, b) =>\n          a.zIndex - b.zIndex\n      )\n\n      if (!loop) {\n        clipToPlay.onComplete = () => {\n          clipToPlay.stop();\n\n          if (!dontRemove) {\n            this.removeChild(clipToPlay);\n          }\n\n          resolve();\n        };\n\n      }\n    })\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { AnimationBase } from \"./animation-base\"\n\n/**\n *\n */\nexport class Decale extends AnimationBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    which: string\n  ) {\n    super(resources);\n\n    const res = this._resources[\"things.decals\"]\n\n    const decale = new PIXI.Sprite(res.textures![which])\n\n    this.addChild(decale)\n  }\n}","import * as PIXI from \"pixi.js\"\n\n/**\n * @class\n */\nexport class AnimationHelper {\n\n  static loadClip(\n    resources: PIXI.IResourceDictionary,\n    which: string,\n    speed: number,\n    scale: number\n  ): PIXI.AnimatedSprite {\n    const frames: PIXI.Texture[] = [];\n    for (const textureId in resources[which].textures) {\n      let texture = resources[which]!.textures![textureId];\n      frames.push(texture);\n    }\n\n    const clip = new PIXI.AnimatedSprite(frames);\n\n    clip.animationSpeed = speed;\n    clip.scale.x = scale;\n    clip.scale.y = scale;\n    clip.anchor.x = 0.5;\n\n    return clip;\n  }\n}","import { IDictionary } from \"./IDictionary\"\n\ntype d<T> = IDictionary<IDictionary<T>>\n\ninterface Event {\n  pressEvent?: (() => void),\n  releaseEvent?: (() => void)\n}\n\ntype Events = d<Event>\n\ninterface State {\n  isPressed: boolean\n}\n\ntype States = d<State>\n\nexport class Gamepads {\n  static _gamepads: IDictionary<Gamepad> = {};\n  static _state: States = {};\n  static _events: Events = {};\n\n  static init(events: Events) {\n    Gamepads._events = events;\n\n    Gamepads.scanGamepads();\n\n    return Gamepads._gamepads[0] || null;\n  }\n\n  static connectHandler(event: GamepadEvent) {\n    console.log(\"gamepad connected\");\n\n    Gamepads.addGamepad(event.gamepad);\n  }\n\n  static addGamepad(gamepad: Gamepad) {\n    console.log(\"adding gamepad\", gamepad);\n\n    Gamepads._gamepads[gamepad.index] = gamepad;\n    Gamepads._state[gamepad.index] = {};\n  }\n\n  static disconnectHandler(event: GamepadEvent) {\n    console.log(\"gamepad disconnected\");\n\n    Gamepads.removeGamepad(event.gamepad);\n  }\n\n  static removeGamepad(gamepad: Gamepad) {\n    console.log(\"removing gamepad\");\n    delete Gamepads._gamepads[gamepad.index];\n    delete Gamepads._state[gamepad.index];\n  }\n\n  static updateStatus() {\n    Gamepads.scanGamepads();\n    for (const gamepadIndex in Gamepads._gamepads) {\n      if (Gamepads._gamepads.hasOwnProperty(gamepadIndex)) {\n        const gamepad: Gamepad = Gamepads._gamepads[gamepadIndex];\n\n        if (gamepad.axes) {\n          //console.log(gamepad.axes)\n        }\n\n        // sometimes controllers dont have buttons\n        if (gamepad.buttons) {\n          for (const buttonIndex in gamepad.buttons) {\n            if (gamepad.buttons.hasOwnProperty(buttonIndex)) {\n              const button: GamepadButton = gamepad.buttons[buttonIndex];\n\n              Gamepads._state[gamepadIndex][buttonIndex] =\n                Gamepads._state[gamepadIndex][buttonIndex] || {};\n              Gamepads._events[gamepadIndex][buttonIndex] =\n                Gamepads._events[gamepadIndex][buttonIndex] || {};\n\n              const state: State = Gamepads._state[gamepadIndex][buttonIndex]\n              const event: Event = Gamepads._events[gamepadIndex][buttonIndex]\n\n              if (button.pressed && !state.isPressed) {\n                console.log(\"button pressed\", gamepadIndex, buttonIndex);\n\n                state.isPressed = true;\n\n                if (event.pressEvent) {\n                  event.pressEvent()\n                }\n              }\n\n              if (!button.pressed && state.isPressed) {\n                console.log(\"button released\", gamepadIndex, buttonIndex);\n\n                state.isPressed = false;\n\n                if (event.releaseEvent) {\n                  event.releaseEvent()\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  static scanGamepads() {\n    const gamepads: Gamepad[] =\n      navigator.getGamepads ? navigator.getGamepads()\n        // @ts-ignore\n        : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads() : []);\n\n    for (const gamepad of gamepads) {\n      // sometimes gamepad is undefined?!\n      if (gamepad) {\n        const gamepadIndex = gamepad.index;\n\n        // do we have this already in records?\n        if (gamepadIndex in Gamepads._gamepads) {\n          Gamepads._gamepads[gamepadIndex] = gamepad;\n        } else {\n          console.log(\"found new gamepad during scan, adding\", gamepadIndex);\n\n          Gamepads.addGamepad(gamepad);\n        }\n      }\n    }\n  }\n}\n\n// register events\n// @ts-ignore\nwindow.addEventListener(\n  \"gamepadconnected\",\n  Gamepads.connectHandler\n);\n// @ts-ignore\nwindow.addEventListener(\n  \"gamepaddisconnected\",\n  Gamepads.disconnectHandler\n);","/**\n * @class\n */\nexport class Keyboard {\n\n  /**\n   *\n   * @type {boolean}\n   * @private\n   */\n  private _isDown = false;\n  /**\n   *\n   * @type {boolean}\n   * @private\n   */\n  private _isUp = true;\n\n  // events\n  /**\n   *\n   * @type {KeyboardEvent}\n   */\n  public pressEvent: (() => void) | null = null;\n  /**\n   *\n   * @type {KeyboardEvent}\n   */\n  public releaseEvent: (() => void) | null = null;\n\n  constructor(\n    private readonly _key: string,\n    private readonly _ignoreKeyup: boolean\n  ) {\n    //Attach event listeners\n    window.addEventListener(\n      \"keydown\",\n      this._downHandler.bind(this),\n      false\n    );\n    window.addEventListener(\n      \"keyup\",\n      this._upHandler.bind(this),\n      false\n    );\n  }\n\n  get isDown() {\n    return this._isDown;\n  }\n\n  /**\n   *\n   * @param event\n   * @private\n   */\n  private _downHandler(\n    event: KeyboardEvent\n  ) {\n    if (event.key === this._key) {\n      event.preventDefault();\n\n      // if the key is up and we have a press handler\n      if (this._isUp && this.pressEvent) {\n        this.pressEvent();\n      }\n\n      this._isDown = true;\n      this._isUp = false;\n    }\n  }\n\n  /**\n   *\n   * @param event\n   * @private\n   */\n  private _upHandler(event: KeyboardEvent) {\n    if (event.key === this._key) {\n      event.preventDefault();\n\n      // if the key is down and we have a press handler\n      if (this._isDown && this.releaseEvent) {\n        this.releaseEvent();\n      }\n\n      this._isDown = false;\n      this._isUp = true;\n    }\n  }\n}","import * as PIXI from \"pixi.js\";\n\nexport class MathHelper {\n\n  /**\n   *\n   * @param min\n   * @param max\n   * @returns {number}\n   * @public\n   */\n  static getRandomInt(min: number, max: number) {\n    return Math.floor(Math.random() * (max - min)) + min;\n  }\n\n  /**\n   *\n   * @param v2\n   * @param v1\n   * @returns {number}\n   */\n  static angleBetweenRad(\n    v1: PIXI.Point,\n    v2: PIXI.Point\n  ) {\n    return Math.atan2(v2.y - v1.y, v2.x - v1.x);\n  }\n\n  /**\n   *\n   * @param v1\n   * @param v2\n   * @returns {number}\n   */\n  static distanceTo(v1: PIXI.Point, v2: PIXI.Point) {\n    return Math.sqrt(MathHelper.distanceToSq(v1, v2));\n  }\n\n  /**\n   *\n   * @param v2\n   * @param v1\n   * @returns {number}\n   */\n  static distanceToSq(v1: PIXI.Point, v2: PIXI.Point) {\n    let dx = v1.x - v2.x,\n      dy = v1.y - v2.y;\n\n    return dx * dx + dy * dy;\n  }\n}","export const ActorStates = {\n  idle: Symbol.for(\"Idle\"),\n  walking: Symbol.for(\"Walking\"),\n  fire: Symbol.for(\"Fire\"),\n  died: Symbol.for(\"Died\")\n};\n\nexport const HitLocations = {\n  Head: Symbol.for(\"Head\"),\n  Feet: Symbol.for(\"Feet\"),\n  Front: Symbol.for(\"Front\"),\n  Back: Symbol.for(\"Back\")\n};","import * as PIXI from \"pixi.js\"\nimport { AnimationBase } from \"./animation-base\"\nimport { AnimationHelper } from \"../tools\"\n\n/**\n *\n */\nexport class Door extends AnimationBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    done?: (() => void)\n  ) {\n    super(resources);\n\n    const which = \"things.door\"\n\n    this._clips = {\n      [which]: AnimationHelper.loadClip(\n        this._resources,\n        which,\n        0.01,\n        8\n      )\n    };\n\n    this._clips[which].filters = [new PIXI.filters.BlurFilter(0.2)]\n\n    this._playClip(\n      which,\n      false,\n      false\n    )\n      .then(() => {\n        if (done) {\n          done()\n        }\n      })\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { ObjectBase } from \"./object-base\"\n\nexport class Crosshair extends ObjectBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary\n  ) {\n    super(resources);\n\n    this.addChild(\n      new PIXI.Text(\"x\", {\n          fill: \"#fff\"\n        } as PIXI.TextStyle\n      )\n    )\n  }\n}\n","import { AnimationBase } from \"./animation-base\"\nimport { AnimationHelper } from \"../tools\"\n\n/**\n *\n */\nexport class Blood extends AnimationBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    speed: number = 0.01\n  ) {\n    super(resources);\n    const which = \"things.blood\"\n\n    this._clips = {\n      [which]: AnimationHelper.loadClip(\n        this._resources,\n        which,\n        speed,\n        1\n      )\n    };\n\n    this._playClip(which, false, false);\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { Config } from \"../config\"\nimport { ObjectBase } from \"./object-base\"\n\nexport class Beacon extends ObjectBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    width: number,\n    height: number\n  ) {\n    super(resources);\n\n    this._isFacingRight = true\n\n    this.height = height;\n    this.width = width;\n\n    const bg = new PIXI.Sprite(\n      Config.highlightBeacons ? PIXI.Texture.WHITE : PIXI.Texture.EMPTY\n    );\n\n    bg.width = width\n    bg.height = height\n\n    if (Config.highlightBeacons) {\n      bg.tint = 0xff0000\n    }\n\n    this.addChild(bg)\n  }\n\n}\n","import * as PIXI from \"pixi.js\"\nimport { AnimationBase } from \"./animation-base\"\nPIXI.settings.SCALE_MODE = PIXI.SCALE_MODES.NEAREST;\n\n/**\n *\n */\nexport class TextBubble extends AnimationBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    text: string,\n    duration: number,\n    done: (() => void)\n  ) {\n    super(resources);\n\n    const t = new PIXI.Text(\n      text, {\n        fontSize: \"12px\",\n        fill: \"#fff\"\n      } as PIXI.TextStyle)\n    const bg = new PIXI.Sprite(\n      PIXI.Texture.WHITE\n    );\n\n    bg.width = t.width\n    bg.height = t.height\n    bg.tint = 0x000000\n\n    this.addChild(bg)\n    this.addChild(t)\n\n    setTimeout(() => {\n      done()\n    }, duration * 1000)\n  }\n}","import PIXI from \"pixi.js\"\nimport { ActorStates, MathHelper } from \"../tools\";\nimport { AnimationBase } from \"../objects\"\nimport { TextBubble } from \"../objects/text-bubble\"\nimport { Config } from \"../config\"\n\n/**\n * @class\n */\nexport class ActorBase extends AnimationBase {\n\n  protected _text?: TextBubble\n\n  // time delta of last sprite flip\n  private _lastFlip = 0;\n\n  /**\n   *\n   * @type {null}\n   * @protected\n   */\n  protected _skin?: string;\n\n  /**\n   *\n   * @type {number}\n   * @protected\n   */\n  protected _speed = 1;\n\n  /**\n   * the objects health\n   * @type {number}\n   * @protected\n   */\n  protected _health = 100;\n\n  /**\n   * the objects striking power\n   * @type {number}\n   * @protected\n   */\n  protected _power = 12;\n\n  /**\n   * @type {Symbol}\n   * @protected\n   */\n  protected _state: Symbol = ActorStates.idle;\n\n  /**\n   * can we get git again helper\n   * @type {boolean}\n   * @protected\n   */\n  protected _canGetHitAgain = true;\n\n  /**\n   * @constructor\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    skin: string,\n    speed: number\n  ) {\n    super(resources);\n\n    /**\n     * set the actor skin\n     * @type {String}\n     * @protected\n     */\n    this._skin = skin;\n\n    /**\n     * the objects speed\n     * @type {number}\n     * @protected\n     */\n    this._speed = speed;\n  }\n\n  /**\n   *\n   * @returns {number}\n   */\n  get power() {\n    return this._power;\n  }\n\n  /**\n   *\n   * @returns {number}\n   */\n  get health() {\n    return this._health;\n  }\n\n  /**\n   *\n   * @returns {Symbol}\n   */\n  public get state() {\n    return this._state;\n  }\n\n  /**\n   *\n   * @param state\n   * @protected\n   */\n  protected _setState(state: Symbol) {\n    console.log(this.constructor.name, \"New state:\", state);\n    this._state = state;\n  }\n\n  /**\n   *\n   * @protected\n   */\n  protected _idle() {\n    // dont go to idle if we are dead\n    if (this._state !== ActorStates.died) {\n      this._setState(ActorStates.idle)\n\n      this._playClip(\n        this._skin + \".stance\",\n        true\n      );\n    }\n  }\n\n  /**\n   *\n   * @protected\n   */\n  protected _died() {\n    this._setState(ActorStates.died);\n\n    // remove all velocity\n    this._vy = 0;\n    this._vx = 0;\n    this._vr = 0;\n\n    // play died clip\n    this._playClip(\n      this._skin + \".died\",\n      false,\n      true\n    )\n  }\n\n  /**\n   * @public\n   * @param actor\n   * @returns {boolean}\n   */\n  public hitBy(\n    actor: ActorBase\n  ) {\n\n    let died = false;\n    let objectTookDamage = false;\n\n    if (this._canGetHitAgain) {\n\n      // lower the heal\n      this._health -= actor.power;\n\n      objectTookDamage = true;\n\n      // after we got hit we cannot get hit again\n      this._canGetHitAgain = false;\n\n      // are we death?\n      if (this._health < 0) {\n\n        this._health = 0;\n\n        // yep\n        died = true;\n\n        this._died();\n      }\n      // not died\n      else {\n\n        // force the player a little bit back on hit\n        this._vx = actor._isFacingRight ? 5 : -5;\n\n        // play the gothit clip\n        this._playClip(\n          this._skin + \".gothit\",\n          false\n        )\n          .then(() => {\n\n            // animation ended!\n\n            // remove the velocity\n            this._vx = 0;\n\n            // yep we can get hit again\n            this._canGetHitAgain = true;\n\n            // stand up and idle afterwards\n            this._idle();\n          });\n      }\n    }\n\n    return {\n      died,\n      objectTookDamage\n    };\n  }\n\n  public flip(\n    direction?: boolean\n  ) {\n    this._setIsFacingRight(\n      direction !== undefined ? direction : !this._isFacingRight\n    )\n  }\n\n  /**\n   *\n   * @param target\n   */\n  public moveTowards(target: PIXI.Point) {\n    const dist = MathHelper.distanceTo(this.position, target);\n\n    let vx = 0;\n    let vy = 0;\n\n    if (dist > 1) {\n      let angleToTarget = MathHelper.angleBetweenRad(this.position, target);\n\n      vy = Math.sin(angleToTarget) * this._speed;\n      vx = Math.cos(angleToTarget) * this._speed;\n\n      // flip player over\n      if (vx > 0 && !this._isFacingRight && this._canFlipAgain()) {\n\n        //console.log(\"Enemy:\", \"flip left\");\n        this.flip();\n      }\n      // flip player over\n      else if (vx < 0 && this._isFacingRight && this._canFlipAgain()) {\n\n        //console.log(\"Enemy:\", \"flip right\");\n        this.flip();\n      }\n    }\n\n    this._vy = vy;\n    this._vx = vx;\n  }\n\n  /**\n   *\n   * @returns {boolean}\n   * @private\n   */\n  private _canFlipAgain() {\n    let canFlip = true;\n    if (Date.now() - this._lastFlip > 200) {\n      canFlip = true;\n      this._lastFlip = Date.now();\n    }\n\n    return canFlip;\n  }\n\n  private _logActorCoordinates() {\n    if (Config.logActorCoordinates) {\n      console.log(\n        \"x\", this.x,\n        \"real x\", this.realx,\n        \"y\", this.y,\n        \"width\", this.width,\n        \"height\", this.height\n      )\n    }\n  }\n\n  protected moved() {\n    this._logActorCoordinates()\n    if (this._text) {\n      this._text.x = this.x - this._text.width / 2\n      this._text.y = this.y - 25\n    }\n  }\n\n  public speak(\n    text: string\n  ) {\n    if (!this._text) {\n      this._text = new TextBubble(\n        this._resources,\n        text, 3,\n        () => {\n          this.parent.removeChild(this._text!)\n          delete this._text\n        }\n      )\n      this._text.zIndex = 80\n      this._text.x = this.x - this._text.width / 2\n      this._text.y = this.y - 25\n      this.parent.addChild(this._text)\n    }\n  }\n\n  public move(\n    maxHeight: number,\n    maxWidth: number\n  ): boolean {\n    return false\n  }\n}\n","import * as PIXI from \"pixi.js\"\nimport { ObjectBase } from \"../object-base\"\nimport { Blood } from \"../blood\"\n\nexport class WeaponBase extends ObjectBase {\n\n  protected _reloadTime: number\n  protected _isReloading: boolean = false\n\n  protected _power: number\n  protected _maxRounds: number\n  protected _rounds: number\n  protected _sprite?: PIXI.Sprite\n  protected _roundsSprite?: PIXI.Sprite\n\n  get rounds() {\n    return this._rounds\n  }\n\n  get sprite() {\n    return this._sprite\n  }\n\n  get roundsSprite() {\n    return this._roundsSprite\n  }\n\n  get isReloading() {\n    return this._isReloading\n  }\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    power: number,\n    rounds: number\n  ) {\n    super(resources);\n\n    this._power = power\n    this._rounds = rounds\n    this._maxRounds = rounds\n    this._reloadTime = 5\n\n    this.zIndex = 100\n\n    this.x = -5\n    this.y = 20\n  }\n\n  public fire(): boolean {\n\n    if (\n      this._rounds > 0 &&\n      !this._isReloading\n    ) {\n      // muzzle flash\n      const muzzleFlash = new Blood(this._resources, 2)\n\n      muzzleFlash.x = 80\n      this.addChild(muzzleFlash);\n\n      this._rounds--;\n\n      // todo: add fire sound\n\n      return true\n    }\n\n    // todo: add empty clips sound\n\n    return false\n  }\n\n  public reload(): boolean {\n\n    this._isReloading = true\n    setTimeout(() => {\n      this._rounds = this._maxRounds\n      this._isReloading = false\n    }, this._reloadTime * 1000)\n\n    console.log(\"reload\")\n    return true\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { WeaponBase } from \"./weapon-base\"\n\n/**\n *\n */\nexport class Shotgun extends WeaponBase {\n\n  /**\n   *\n   * @param resources\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary\n  ) {\n    super(resources, 55, 6);\n\n    const which = \"weapons.shotgun\"\n\n    const res = resources![which]\n\n    this._roundsSprite = new PIXI.Sprite(\n      res.textures![\"shell.png\"]!\n    );\n\n    this._sprite = new PIXI.Sprite(\n      res.textures![\"shotgun.png\"]!\n    );\n\n    this._sprite.scale.x = 0.1\n    this._sprite.scale.y = 0.1\n\n    // shotgun should be in the back so add it first\n    this.addChild(this._sprite);\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { WeaponBase } from \"./weapon-base\"\n\n/**\n *\n */\nexport class Beretta extends WeaponBase {\n\n  /**\n   *\n   * @param resources\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary\n  ) {\n    super(resources, 55, 8);\n\n    const which = \"weapons.beretta\"\n\n    const res = resources![which]\n\n    // todo: replace with correct skin\n    this._sprite = new PIXI.Sprite(\n      res.textures![\"beretta.png\"]!\n    );\n\n    this._sprite.scale.x = 0.1\n    this._sprite.scale.y = 0.1\n\n    // sprite should be in the back so add it first\n    this.addChild(this._sprite);\n\n    this._roundsSprite = new PIXI.Sprite(\n      res.textures![\"shell.png\"]!\n    );\n  }\n}","import * as PIXI from \"pixi.js\"\nimport {\n  Beretta,\n  Shotgun,\n  WeaponBase\n} from \"../objects/weapons\"\nimport { ActorBase } from \"./actor-base\"\nimport {\n  ActorStates,\n  AnimationHelper,\n  MathHelper\n} from \"../tools\"\n\nconst weapons: {\n  shotgun?: Shotgun,\n  beretta?: Beretta\n} = {}\n\n/**\n *\n */\nexport class Player extends ActorBase {\n\n  private _weapon: WeaponBase\n  private _name: string = \"Gordon\"\n\n  get weapon(): WeaponBase {\n    return this._weapon\n  }\n\n  get name() {\n    return this._name\n  }\n\n  /**\n   *\n   * @param resources\n   * @param skin\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    skin: string\n  ) {\n    super(\n      resources, skin, 3\n    );\n\n    this._baseScale = 1.1\n\n    this._health = 77;\n\n    // load the clips for this object\n    this._clips[this._skin + \".stance\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".stance\", 0.1, 1\n      );\n    this._clips[this._skin + \".walk\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".walk\", 0.2, 1\n      );\n    this._clips[this._skin + \".punch\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".punch\", 0.3, 1\n      );\n    this._clips[this._skin + \".kick\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".kick\", 0.2, 1\n      );\n    this._clips[this._skin + \".gothit\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".gothit\", 0.2, 1\n      );\n    this._clips[this._skin + \".died\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".died\", 0.2, 1\n      );\n\n    weapons.shotgun = new Shotgun(resources)\n    weapons.beretta = new Beretta(resources)\n\n    // todo get this from equipment\n    this._weapon = weapons.beretta\n    this.addChild(this._weapon)\n\n    // go to idle\n    this._idle();\n  }\n\n  public reload() {\n    // todo check equipment for shells\n    this._weapon.reload()\n  }\n\n  public switchWeapon() {\n    if (!this.weapon.isReloading) {\n      this.removeChild(this._weapon)\n\n      if (this._weapon instanceof Shotgun) {\n        this._weapon = weapons.beretta!\n      } else {\n        this._weapon = weapons.shotgun!\n      }\n\n      this.addChild(this._weapon)\n    }\n  }\n\n  public updateCrosshairPosition(\n    crosshairPosition: PIXI.Point\n  ) {\n    const angle: number = this._isFacingRight ?\n      MathHelper.angleBetweenRad(this.weaponLocation, crosshairPosition) :\n      -MathHelper.angleBetweenRad(crosshairPosition, this.weaponLocation)\n    this._weapon.rotation = angle\n  }\n\n  get weaponLocation(): PIXI.Point {\n    return this.toGlobal(\n      this._weapon.position\n    )\n  }\n\n  /**\n   *\n   * @returns {boolean}\n   * @private\n   */\n  private _canBeControlled() {\n    if (this._state === ActorStates.died) {\n      console.log(\"Cant be controlled, player is dead\");\n      return false\n    }\n\n    return (\n      this._state === ActorStates.idle ||\n      this._state === ActorStates.walking\n    );\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _died() {\n    super._died();\n\n    // todo: add dying animation\n    // the died animation is way lower so we need to\n    // adjust the hight a bit\n    this.y += this.height / 2;\n\n    this.height = this.height / 2\n  }\n\n  /**\n   * @public\n   */\n  public fire(): boolean {\n    if (!this._canBeControlled()) {\n      return false\n    }\n\n    // try to fires\n    const fire = this._weapon.fire()\n    if (fire) {\n\n      // we fired, announce\n      this.speak(\"Päng!\")\n\n      // set state, remove velo\n      this._setState(ActorStates.fire)\n      this._vx = 0;\n      this._vy = 0;\n\n      // play fire animation\n      this._playClip(\n        this._skin + \".punch\",\n        false\n      )\n        .then(() => {\n          // once done, go back to idle\n          this._idle();\n        });\n      return true\n    } else {\n      this._idle()\n      return false\n    }\n  }\n\n  /**\n   * @public\n   */\n  public moveRight() {\n    if (this._canBeControlled()) {\n      this._vx = this._speed;\n      this._playClip(\n        this._skin + \".walk\",\n        true\n      );\n      this._setState(ActorStates.walking)\n    }\n  }\n\n  /**\n   * @public\n   */\n  public moveLeft() {\n    if (this._canBeControlled()) {\n      this._vx = -this._speed;\n      this._playClip(\n        this._skin + \".walk\",\n        true\n      );\n      this._setState(ActorStates.walking)\n      this._adaptScaleBasedOnOrientation()\n    }\n  }\n\n  /**\n   * @public\n   */\n  public stopMoveHorizontally() {\n    this._vx = 0;\n    if (this._vy === 0 && this._canBeControlled()) {\n      this._idle();\n    }\n  }\n\n  /**\n   * @public\n   */\n  public moveUp() {\n    if (this._canBeControlled()) {\n      this._vy = -this._speed;\n      this._playClip(\n        this._skin + \".walk\",\n        true\n      );\n      this._setState(ActorStates.walking)\n    }\n  }\n\n  /**\n   * @public\n   */\n  public moveDown() {\n    if (this._canBeControlled()) {\n      this._vy = this._speed;\n      this._playClip(\n        this._skin + \".walk\",\n        true\n      );\n      this._setState(ActorStates.walking);\n    }\n  }\n\n  /**\n   * @public\n   */\n  public stopMoveVertically() {\n    this._vy = 0;\n    if (this._vx === 0 && this._canBeControlled()) {\n      this._idle();\n    }\n  }\n\n  public speak(\n    text: string\n  ) {\n    super.speak(`${this._name}: ${text}`)\n  }\n\n  public move(\n    maxHeight: number,\n    maxWidth: number\n  ): boolean {\n    let playerMoved = false\n\n    if (\n      // do we have velocity?\n      this.vy !== 0 &&\n      this.y + this.vy > 0 &&\n      // dont move lower than the bottom\n      this.y + this.height + this.vy < maxHeight\n    ) {\n      this.y += this.vy;\n      playerMoved = true\n    }\n\n    // move right\n    if (this.vx > 0) {\n      // dont walk further than the right border of the map\n      if (\n        this.realx +\n        Math.abs(this.width) + 7 +\n        this.vx < maxWidth\n      ) {\n        this.x += this.vx;\n        playerMoved = true\n      }\n    }\n    // move left\n    else if (this.vx < 0) {\n      // detect left col\n      if (\n        this.realx + this.vx >= 0\n      ) {\n        this.x += this.vx;\n        playerMoved = true\n      }\n    }\n\n    if (playerMoved) {\n      this.adaptScale(this.y, maxHeight)\n      this.moved()\n    }\n\n    return playerMoved\n  }\n}\n","import * as PIXI from \"pixi.js\";\nimport { EnemyBase } from \"./enemy-base\"\n\n/**\n *\n */\nexport class Bat extends EnemyBase {\n\n  /**\n   *\n   * @param resources\n   * @param skin\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    skin: string\n  ) {\n    super(resources, skin, 1);\n  }\n}","import * as PIXI from \"pixi.js\";\nimport { ActorBase } from \"../actor-base\"\nimport {\n  ActorStates,\n  AnimationHelper\n} from \"../../tools\"\n\n/**\n *\n */\nexport class EnemyBase extends ActorBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    skin: string,\n    speed: number = 2\n  ) {\n    super(resources, skin, speed);\n\n    this._isFacingRight = false;\n\n    // load the clips for this object\n    this._clips[this._skin + \".walk\"] =\n      AnimationHelper.loadClip(\n        this._resources, this._skin + \".walk\", 0.2, 1\n      );\n    this._clips[this._skin + \".gothit\"] = this._clips[this._skin + \".walk\"];\n    this._clips[this._skin + \".died\"] = this._clips[this._skin + \".walk\"];\n\n    // go to idle\n    this._idle();\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _idle() {\n    this._setState(ActorStates.idle)\n    this._playClip(\n      this._skin + \".walk\",\n      true\n    );\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _died() {\n    super._died();\n\n    // set proper death location\n    this.y += this.height / 2;\n    this.pivot.set(Math.abs(this.width) / 2, this.height);\n    this.rotation = 90 * Math.PI / 180;\n\n    setTimeout(() => {\n      this.parent.removeChild(this);\n    }, 10 * 1000);\n  }\n\n  move(\n    maxHeight: number,\n    maxWidth: number\n  ): boolean {\n    let enemyMoved = false\n\n    if (\n      this.vx !== 0 ||\n      this.vy !== 0 ||\n      this.vr !== 0\n    ) {\n      this.x += this.vx;\n      this.y += this.vy;\n      this.rotation += this.vr;\n\n      enemyMoved = true\n\n      this.adaptScale(this.y, maxHeight)\n    }\n\n    return enemyMoved\n  }\n}\n","import * as PIXI from \"pixi.js\";\nimport { Bat } from \"./bat\"\n\n/**\n *\n */\nexport class BatInfected extends Bat {\n\n\n  /**\n   *\n   * @param resources\n   * @param skin\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    skin: string\n  ) {\n    super(resources, skin);\n\n    this._baseScale = 2.5\n\n    // todo make this a red'isch filter\n    const f = new PIXI.filters.ColorMatrixFilter()\n    f.lsd(false)\n    this.filters = [f]\n\n    this.scale.x = this._baseScale\n    this.scale.y = this._baseScale\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { AnimationBase } from \"../objects\"\n\n/**\n *\n */\nexport class MapBase extends AnimationBase {\n\n  private readonly _explorationOffset: number\n  protected _textures?: PIXI.ITextureDictionary\n  protected _backgroundContainer: PIXI.Container\n  protected _actorContainer: PIXI.Container\n  protected _foregroundContainer: PIXI.Container\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    protected _width: number,\n    mapToLoad?: string\n  ) {\n    super(resources);\n\n    this._explorationOffset = this._width / 3;\n\n    if (mapToLoad) {\n      // load the clips for this object\n      this._textures = resources[mapToLoad].textures;\n    }\n\n    /**\n     * setup background\n     * @type {PIXI.Container}\n     * @private\n     */\n    this._backgroundContainer = new PIXI.Container();\n    this.addChild(this._backgroundContainer);\n\n    /**\n     * setup actors\n     * @type {PIXI.Container}\n     * @private\n     */\n    this._actorContainer = new PIXI.Container();\n    this.addChild(this._actorContainer);\n\n    /**\n     * setup foreground\n     * @type {PIXI.Container}\n     * @private\n     */\n    this._foregroundContainer = new PIXI.Container();\n    this.addChild(this._foregroundContainer);\n  }\n\n  /**\n   *\n   * @returns {PIXI.Container}\n   */\n  get actorContainer() {\n    return this._actorContainer;\n  }\n\n  /**\n   *\n   * @returns {PIXI.Container}\n   */\n  get backgroundContainer() {\n    return this._backgroundContainer;\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _setup() {\n    // stub\n  }\n\n  /**\n   *\n   * @param playerX\n   * @param scrollAmount\n   */\n  public shallScroll(\n    playerX: number,\n    scrollAmount: number\n  ) {\n    if (\n      // move right\n      (scrollAmount > 0 && playerX + this._explorationOffset > this._width) ||\n      // move left\n      (scrollAmount < 0 && playerX - this._explorationOffset < this._explorationOffset)\n    ) {\n      // move map based on positive or negative scroll amount\n      this.x -= scrollAmount\n\n      // left bound\n      if (this.x > 0) {\n        this.x = 0\n      }\n\n      // right bound\n      if (this.x < this._width - this.width) {\n        this.x = this._width - this.width\n      }\n    }\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { MapBase } from \"./map-base\"\n\nconst {Sound} = require(\"pixi-sound\").default\n\n/**\n *\n */\nexport class MaensionOutside extends MapBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    width: number\n  ) {\n    super(resources, width, \"maps.maension\")\n\n    let starryNight = new PIXI.Sprite(\n      this._textures![\"tumblr_inline_n258q4r8c01qhwjx8.png\"]\n    );\n    starryNight.scale.x = 2.56;\n    starryNight.scale.y = 2.56;\n\n    this._backgroundContainer.addChild(starryNight);\n\n    let maension = new PIXI.Sprite(\n      this._textures![\"Maension_WIP.png\"]\n    );\n\n    maension.y = -40\n    maension.scale.x = 2;\n    maension.scale.y = 2;\n\n    this._backgroundContainer.addChild(maension);\n\n    const tree = this._textures![\"tree.png\"]\n    const tree1 = new PIXI.Sprite(tree);\n    tree1.x = 100\n    tree1.y = 350\n    tree1.scale.x = 0.4\n    tree1.scale.y = 0.4\n\n    this._actorContainer.addChild(tree1)\n\n    const tree_dead = this._textures![\"tree_dead.png\"]\n    const tree2 = new PIXI.Sprite(tree_dead);\n    tree2.x = 50\n    tree2.y = 180\n    tree2.scale.x = 0.4\n    tree2.scale.y = 0.4\n\n    this._backgroundContainer.addChild(tree2)\n\n    this._setup()\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _setup() {\n    const z1 = Sound.from('assets/sounds/zombie1.mp3');\n    const z2 = Sound.from('assets/sounds/zombie1.mp3');\n\n    setInterval(() => {\n      z1.play();\n    }, 15 * 1000)\n\n    setInterval(() => {\n      z2.play();\n    }, 8 * 1000)\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { MapBase } from \"./map-base\"\n\nconst {Sound} = require(\"pixi-sound\").default\n\n/**\n *\n */\nexport class HouseOutside extends MapBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    width: number\n  ) {\n    super(resources, width, \"maps.house\")\n\n    this._setup()\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _setup() {\n    let city = new PIXI.Sprite(\n      // @ts-ignore\n      this._textures[\"house.png\"]\n    );\n\n    city.scale.x = 1.3;\n    city.scale.y = 1.3;\n\n    this._backgroundContainer.addChild(city);\n\n    const z1 = Sound.from('assets/sounds/zombie1.mp3');\n    const z2 = Sound.from('assets/sounds/zombie1.mp3');\n\n    setInterval(() => {\n      z1.play();\n    }, 15 * 1000)\n\n    setInterval(() => {\n      z2.play();\n    }, 8 * 1000)\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { MapBase } from \"./map-base\"\n\n/**\n *\n */\nexport class Street extends MapBase {\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    width: number,\n  ) {\n    super(resources, width, \"maps.street\")\n\n    this._setup()\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _setup() {\n\n    // background\n\n    // load city first because we need the width\n    // @ts-ignore\n    let city = new PIXI.Sprite(this._textures[\"city01.png\"]);\n    let cityWidth = city.width;\n    city.scale.x = 2;\n    city.scale.y = 2.1;\n    city.y = -100;\n\n    let concret = new PIXI.TilingSprite(\n      // @ts-ignore\n      this._textures[\"concret.png\"]\n    );\n    concret.width = cityWidth;\n    concret.height = 300;\n    concret.scale.x = 2;\n    concret.scale.y = 1.44;\n    concret.y = 330;\n\n    // concret should be in the back so add it first\n    this._backgroundContainer.addChild(concret);\n\n    this._backgroundContainer.addChild(city);\n\n    // foreground\n    // @ts-ignore\n    let police = new PIXI.Sprite(this._textures[\"police.png\"]);\n    police.scale.x = 2;\n    police.scale.y = 2;\n\n    police.y = this.height - police.height * 2;\n    police.x = 300;\n    this._foregroundContainer.addChild(police);\n  }\n}","import * as PIXI from \"pixi.js\"\nimport { Door } from \"../objects\"\nimport { MapBase } from \"./map-base\"\n\n/**\n *\n */\nexport class Loading extends MapBase {\n\n  private readonly _door: Door\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    width: number,\n    done?: (() => void)\n  ) {\n    super(resources, width);\n\n    const bg = new PIXI.Sprite(PIXI.Texture.WHITE);\n\n    this._door = new Door(\n      resources,\n      done\n    )\n    this._door.x = width / 2\n    this._door.y = 30\n\n    bg.width = width\n    bg.height = 800\n    bg.tint = 0x000000\n\n    this._backgroundContainer.addChild(bg)\n\n    this._setup()\n  }\n\n  /**\n   *\n   * @private\n   */\n  protected _setup() {\n    this._foregroundContainer.addChild(this._door);\n  }\n\n  public animate(delta: number) {\n    this._door.y += delta / 100\n    const scale = this._door.scale.x + delta / 20000\n    this._door.scale.x = scale\n    this._door.scale.y = scale\n  }\n}","import * as PIXI from \"pixi.js\";\nimport { Player } from \"../actors\"\nimport { AnimationBase } from \"../objects\"\n\nexport class HUD extends AnimationBase {\n\n  private _player: Player\n  private _health: PIXI.Text\n\n  // round icons\n  private _rounds: PIXI.Container\n  // weapon icon\n  private _weapon?: PIXI.Sprite\n\n  // change to \"you are dead ...\"\n  private _gameOverSign?: PIXI.Text\n\n  private _width: number\n  private _height: number\n\n  static bigText: PIXI.TextStyle = {\n    fontFamily: \"Arial Black\",\n    fontSize: \"48px\",\n    fontWeight: \"bold\",\n    fill: \"#fff\",\n    dropShadow: true,\n    dropShadowColor: \"#000\",\n    align: \"center\"\n  } as PIXI.TextStyle\n\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    player: Player,\n    width: number,\n    height: number\n  ) {\n    super(resources);\n\n    const which = \"things.hud\"\n\n    const res = resources[which]\n\n    this._width = width;\n    this._height = height;\n\n    console.log(\n      \"Setting up HUD\",\n      \"width:\", this._width,\n      \"height:\", this._height\n    );\n\n    this._player = player;\n\n    const smallTextConfig = {\n      ...HUD.bigText,\n      fontSize: \"12px\"\n    }\n\n    const playerName = new PIXI.Text(\n      player.name,\n      {\n        ...smallTextConfig,\n        fill: \"#ffff30\",\n      }\n    );\n    playerName.x = this._width / 3 - playerName.width / 2;\n    playerName.y = this._height - 47;\n    this.addChild(playerName);\n\n    this._health = new PIXI.Text(\n      \"\",\n      smallTextConfig\n    );\n\n    this._health.x = playerName.x;\n    this._health.y = this._height - 23;\n    this.addChild(this._health);\n\n    this._rounds = new PIXI.Container()\n    this._rounds.x = (this._width / 3) + 77\n    this._rounds.y = this._height - 33\n\n    this.addChild(this._rounds)\n\n    const healthBorder = new PIXI.Sprite(\n      res.textures![\"side.png\"]\n    );\n\n    healthBorder.x = this._width / 2 - (healthBorder.width + healthBorder.width / 2) + 2\n    healthBorder.y = this._height - healthBorder.height - 2\n\n    this.addChild(healthBorder);\n\n    const roundsBorder = new PIXI.Sprite(\n      res.textures![\"center.png\"]\n    );\n    roundsBorder.x = this._width / 2 - (roundsBorder.width / 2) + 1\n    roundsBorder.y = this._height - roundsBorder.height - 2\n\n    this.addChild(roundsBorder);\n\n    const weaponBorder = new PIXI.Sprite(\n      res.textures![\"side.png\"]\n    );\n\n    weaponBorder.x = this._width / 2 + (roundsBorder.width + weaponBorder.width / 2) - 2\n    weaponBorder.y = this._height - weaponBorder.height - 2\n\n    weaponBorder.scale.x = -1\n\n    this.addChild(weaponBorder);\n\n    this.update();\n  }\n\n  private _renderWeapon() {\n    this.removeChild(this._weapon!)\n\n    this._weapon = new PIXI.Sprite(this._player.weapon.sprite!.texture)\n    this._weapon.scale.x = this._player.weapon.sprite!.scale.x * 2\n    this._weapon.scale.y = this._player.weapon.sprite!.scale.y * 2\n\n    this._weapon.x = this._width / 2 + (this._weapon.width + 27)\n    this._weapon.y = this._height - 40\n\n    this.addChild(this._weapon)\n  }\n\n  private _renderRounds() {\n\n    this._rounds.removeChildren()\n\n    for (let x = 0; x < this._player.weapon.rounds; x++) {\n\n      const roundSprite = new PIXI.Sprite(this._player.weapon.roundsSprite?.texture)\n      roundSprite.scale.x = 0.1\n      roundSprite.scale.y = 0.1\n      roundSprite.x = 10 * x\n      roundSprite.y = 10\n\n      this._rounds.addChild(roundSprite)\n    }\n\n  }\n\n  public update() {\n    this._health.text = this._player.health + \" HP\";\n\n    this._renderRounds()\n    this._renderWeapon()\n  }\n\n  public renderGameOver() {\n    this._gameOverSign = new PIXI.Text(\n      \"Game Over\\nPress Enter to retry!\",\n      {\n        ...HUD.bigText,\n        fill: \"#f00\"\n      }\n    );\n\n    this.addChild(this._gameOverSign);\n\n    // place game over sign in center of screen\n    this._gameOverSign.x = (this._width / 2) - (this._gameOverSign.width / 2)\n    this._gameOverSign.y = (this._height / 2) - (this._gameOverSign.height / 2)\n  }\n\n  public animate(delta: number) {\n    if (this._gameOverSign) {\n      this._gameOverSign.alpha += delta / 1000;\n      if (this._gameOverSign.alpha > 1) {\n        this._gameOverSign.alpha = 0.2;\n      }\n    }\n  }\n}\n","import * as PIXI from \"pixi.js\";\nimport { Config } from \"./config\";\nimport {\n  Beacon,\n  Blood,\n  Crosshair, Decale\n} from \"./objects\"\nimport {\n  ActorBase,\n  Bat,\n  BatInfected,\n  EnemyBase,\n  Player\n} from \"./actors\"\nimport {\n  HouseOutside,\n  Loading,\n  MaensionOutside,\n  MapBase,\n  Street\n} from \"./maps\"\nimport {\n  ActorStates,\n  Gamepads,\n  Keyboard,\n  MathHelper\n} from \"./tools\"\nimport {\n  HUD\n} from \"./ui\"\nimport { IDictionary } from \"./tools/IDictionary\"\n\nlet maps: IDictionary<MapBase> = {}\n\n/**\n * @class\n */\nexport default class Game {\n  private _stage: PIXI.Container\n\n  private _hud?: HUD\n  private _map?: MapBase\n  private _player?: Player\n  private _beacon?: Beacon\n  private _enemies: EnemyBase[] = [];\n  private _mouseLocation?: PIXI.Point\n\n  private _isRunning: boolean = true;\n\n  private _startOffset?: number\n  private _elapsedSeconds = 0;\n  private readonly _resources: PIXI.IResourceDictionary\n\n  private readonly _width: number\n  private readonly _height: number\n\n  private _mouseLine?: PIXI.Graphics\n  private _crosshair?: Crosshair\n\n  private static timeout: number = 300;\n\n  /**\n   *\n   * @param resources\n   * @param stage\n   * @param width\n   * @param height\n   */\n  constructor(\n    resources: PIXI.IResourceDictionary,\n    stage: PIXI.Container,\n    width: number, height: number\n  ) {\n    this._stage = stage;\n\n    this._resources = resources;\n    this._width = width;\n    this._height = height;\n\n    maps.street = new Street(\n      this._resources,\n      this._width,\n    );\n\n    maps.house = new HouseOutside(\n      this._resources,\n      this._width,\n    );\n\n    maps.maension = new MaensionOutside(\n      this._resources,\n      this._width\n    );\n\n    maps.loading = new Loading(\n      this._resources,\n      this._width\n    );\n\n    this._init();\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _init() {\n    this._mouseLine = new PIXI.Graphics();\n    this._crosshair = new Crosshair(this._resources)\n\n    this._map = maps.maension!\n    this._stage.addChild(this._map);\n    this._stage.cursor = \"none\"\n\n    // create player\n    this._player = new Player(this._resources, \"ryu\");\n\n    this._player.x = 60\n    this._player.y = 400\n\n    this._player!.adaptScale(this._player!.y, this._height)\n    this._crosshair!.adaptScale(this._player!.y, this._height)\n\n    // add player to stage\n    this._map.actorContainer.addChild(this._player);\n\n    this._beacon = new Beacon(\n      this._resources, 80, 5\n    )\n\n    const bat2 = new Bat(this._resources, \"bat\")\n    const bat3 = new BatInfected(this._resources, \"bat\")\n\n    this._beacon.position.x = 580\n    this._beacon.position.y = 250\n\n    bat2.position.x = 920\n    bat2.position.y = 220\n\n    bat3.position.x = 880\n    bat3.position.y = 240\n\n    this._map.actorContainer.addChild(this._beacon);\n    this._map.actorContainer.addChild(bat2);\n    this._map.actorContainer.addChild(bat3);\n\n    // attach the keyboard to player\n    const gamepad = this._attachGamepad();\n\n    // no gamepad, go to stinky keyboard\n    if (!gamepad) {\n\n      console.log(\"no gamepad, attaching stinky keyboard\");\n      this._attachKeyboard()\n    }\n\n    // init enemies\n    this._enemies = [\n      // bat3\n    ];\n\n    this._hud = new HUD(\n      this._resources,\n      this._player,\n      this._width,\n      this._height\n    );\n\n    this._stage.addChild(this._hud);\n\n    this._updateHud();\n\n    this._attachMouse()\n\n    this._updateMouseLocation(new PIXI.Point(this._width / 2, this._height / 2))\n\n    this._startOffset = undefined;\n\n    // this game is running baby\n    this._isRunning = true;\n\n    console.log(\n      \"Game:\",\n      \"Game init done!\"\n    );\n  }\n\n  private _attachMouse() {\n    this._stage.addChild(this._mouseLine!)\n    this._stage.addChild(this._crosshair!)\n\n    this._stage.interactive = true\n    this._stage.on(\n      \"mousemove\",\n      (e: PIXI.InteractionEvent) => {\n        this._updateMouseLocation(e.data.global)\n      })\n\n    this._stage.on(\n      \"mousedown\",\n      () =>\n        this._fire()\n    )\n\n    this._stage.on(\n      \"mouseout\",\n      () => this._isRunning = false\n    )\n\n    this._stage.on(\n      \"mouseover\",\n      () => this._isRunning = this._player!.state !== ActorStates.died\n    )\n  }\n\n  private _updateCrosshair() {\n    if (\n      this._mouseLocation &&\n      this._isRunning &&\n      this._player?.state !== ActorStates.died\n    ) {\n      this._crosshair!.x = this._mouseLocation!.x - this._crosshair!.width / 2\n      this._crosshair!.y = this._mouseLocation!.y - this._crosshair!.height / 2\n\n      // flip player based on crosshair position\n      if (this._crosshair!.x < this._player!.toGlobal(this._stage).x) {\n        this._player!.flip(false)\n      } else {\n        this._player!.flip(true)\n      }\n\n      // update player based on crosshair\n      this._player!.updateCrosshairPosition(\n        this._stage.toGlobal(this._crosshair?.position!)\n      )\n\n      // adapt crosshair scale based on player location\n      this._crosshair!.adaptScale(this._player!.y, this._height)\n    }\n  }\n\n  private _fire() {\n    if (this._isRunning) {\n      if (this._player?.fire()) {\n        // hit location\n        const impact = new Decale(this._resources, \"impact.png\")\n        impact.scale.x = 0.1\n        impact.scale.y = 0.1\n\n        const impactLocation = this._map!.toLocal(this._crosshair!)\n        impact.x = impactLocation.x + this._crosshair!.width / 2 - impact.width / 2\n        impact.y = impactLocation.y + this._crosshair!.height / 2 - impact.height / 2\n\n        this._map?.backgroundContainer.addChild(impact);\n\n        this._updateHud()\n      }\n    }\n  }\n\n  private _moveRight() {\n    if (this._isRunning && this._player) {\n      this._player.moveRight();\n    }\n  }\n\n  private _moveLeft() {\n    if (this._isRunning && this._player) {\n      this._player.moveLeft();\n    }\n  }\n\n  private _moveUp() {\n    if (this._isRunning && this._player) {\n      this._player.moveUp();\n    }\n  }\n\n  private _moveDown() {\n    if (this._isRunning && this._player) {\n      this._player.moveDown();\n    }\n  }\n\n  private _stopMoveVertically() {\n    if (this._isRunning) {\n      this._player?.stopMoveVertically();\n    }\n  }\n\n  private _stopMoveHorizontally() {\n    if (this._isRunning) {\n      this._player?.stopMoveHorizontally();\n    }\n  }\n\n  private _attachKeyboard() {\n    const\n      left = new Keyboard(\"ArrowLeft\", true),\n      up = new Keyboard(\"ArrowUp\", true),\n      right = new Keyboard(\"ArrowRight\", true),\n      down = new Keyboard(\"ArrowDown\", true),\n\n      k = new Keyboard(\"k\", false),\n      w = new Keyboard(\"w\", false),\n      r = new Keyboard(\"r\", false),\n\n      enter = new Keyboard(\"Enter\", false);\n\n    k.pressEvent = () => this._fire()\n    w.pressEvent = () => this._switchWeapon()\n    r.pressEvent = () => this._reload()\n\n    right.pressEvent = () => this._moveRight()\n    right.releaseEvent = () => {\n      if (!left.isDown) {\n        this._stopMoveHorizontally()\n      }\n    };\n\n    left.pressEvent = () => this._moveLeft()\n    left.releaseEvent = () => {\n      if (!right.isDown) {\n        this._stopMoveHorizontally()\n      }\n    };\n\n    up.pressEvent = () => this._moveUp()\n    up.releaseEvent = () => {\n      if (!down.isDown) {\n        this._stopMoveVertically()\n      }\n    };\n\n    down.pressEvent = () => this._moveDown()\n    down.releaseEvent = () => {\n      if (!up.isDown) {\n        this._stopMoveVertically()\n      }\n    };\n\n    enter.pressEvent = () => {\n      if (!this._isRunning) {\n        this._init();\n      }\n    }\n  }\n\n  private _attachGamepad(): boolean {\n    return !!Gamepads.init({\n      // first gamepad\n      0: {\n        // button 1 pressed\n        1: {\n          pressEvent: () => {\n            this._fire()\n          }\n        },\n        // button 15 pressed\n        15: {\n          pressEvent: () => this._moveRight(),\n          releaseEvent: () => this._stopMoveHorizontally()\n        },\n        // button 14 pressed\n        14: {\n          pressEvent: () => this._moveLeft(),\n          releaseEvent: () => this._stopMoveHorizontally()\n        },\n        // button 12 pressed\n        12: {\n          pressEvent: () => this._moveUp(),\n          releaseEvent: () => this._stopMoveVertically()\n        },\n        // button 13 pressed\n        13: {\n          pressEvent: () => this._moveDown(),\n          releaseEvent: () => this._stopMoveVertically()\n        },\n        // button 9 pressed\n        9: {\n          pressEvent: () => {\n            if (!this._isRunning) {\n              this._init();\n            }\n          }\n        }\n      }\n    })\n  }\n\n  /**\n   * this will end the game\n   * @private\n   */\n  private _end() {\n    // game is not longer running dude\n    this._isRunning = false;\n\n    this._hud!.renderGameOver();\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _detectCollisions() {\n\n    if (this._player!.collides(this._beacon!)) {\n\n      this._player!.speak(\"It's locked!\")\n    }\n\n    if (this._crosshair!.collides(this._beacon!)) {\n\n      this._beacon = new Beacon(\n        this._resources,\n        this._height,\n        this._width\n      )\n\n      this._stage.removeChild(this._map!)\n      this._map = new Loading(\n        this._resources,\n        this._width,\n        () => {\n          this._map = new MaensionOutside(\n            this._resources,\n            this._width\n          )\n        }\n      )\n      this._stage.addChild(this._map!)\n    }\n\n    for (const enemy of this._enemies) {\n      if (ActorStates.died !== enemy.state &&\n        ActorStates.died !== this._player!.state) {\n        // does the player collide the enemy?\n        if (this._player!.collides(enemy)) {\n          const playerHit = this._player!.hitBy(enemy);\n\n          if (playerHit.objectTookDamage) {\n            this._drawBlood(this._player!);\n            this._updateHud();\n          }\n\n          // we died and now lives left :(\n          if (playerHit.died) {\n            // end the game\n            this._end();\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param actor: the bleeding actor\n   * @private\n   */\n  private _drawBlood(\n    actor: ActorBase\n  ) {\n    for (let i = 0; i < 5; i++) {\n      const blood = new Blood(this._resources);\n\n      blood.x = actor.x + MathHelper.getRandomInt(-20, 20);\n      blood.y = actor.y + actor.height + MathHelper.getRandomInt(-20, 20);\n      blood.rotation = MathHelper.getRandomInt(0, 10);\n\n      this._map?.backgroundContainer.addChild(blood);\n    }\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _updateHud() {\n    this._hud!.update();\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _updateKI() {\n    for (const enemy of this._enemies) {\n      if (ActorStates.died !== enemy.state) {\n        enemy.moveTowards(this._player!.position)\n      }\n    }\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _moveActors() {\n    const {_player} = this\n    let playerMoved = _player!.move(\n      this._height,\n      this._map!.width\n    )\n\n    if (playerMoved) {\n      // yep, so try to scroll the map\n      this._map?.shallScroll(\n        _player!.realx,\n        _player!.vx\n      );\n      this._updateCrosshair()\n    }\n\n    // move the enemies\n    for (const enemy of this._enemies) {\n      enemy.move(\n        this._height,\n        this._map!.width\n      )\n    }\n\n  }\n\n  private _outlineMouse() {\n    if (\n      this._mouseLine && this._mouseLocation &&\n      this._player && this._map\n    ) {\n      this._mouseLine.clear()\n      this._mouseLine.lineStyle(1, 0xffffff);\n\n      // from\n      this._mouseLine.position =\n        this._player.weaponLocation\n\n      // to\n      const {x, y} = this._mouseLine.toLocal(this._mouseLocation)\n      this._mouseLine.lineTo(\n        x, y\n      );\n\n      this._mouseLine.endFill();\n    }\n  }\n\n  private _switchWeapon() {\n    if (this._isRunning) {\n      this._player!.switchWeapon()\n      this._updateHud()\n    }\n  }\n\n  private _reload() {\n    if (this._isRunning) {\n      this._player!.reload()\n      this._updateHud()\n    }\n  }\n\n  private _updateMouseLocation(\n    mouseLocation: PIXI.Point\n  ) {\n    if (this._isRunning) {\n      this._mouseLocation = mouseLocation\n      this._updateCrosshair()\n    }\n  }\n\n  /**\n   *\n   * @param elapsed\n   * @param delta\n   * @public\n   */\n  public update(\n    elapsed: number,\n    delta: number\n  ) {\n    Gamepads.updateStatus();\n\n    this._hud!.animate(delta)\n\n    if (this._isRunning) {\n      this._map!.animate(delta)\n\n      const elapsedSeconds = parseInt((elapsed / 1000).toString());\n\n      // game has not started\n      if (!this._startOffset) {\n        this._startOffset = elapsedSeconds;\n      }\n\n      const correctedElapsedSeconds = (elapsedSeconds - this._startOffset);\n\n      if (correctedElapsedSeconds !== this._elapsedSeconds) {\n        this._elapsedSeconds = correctedElapsedSeconds;\n        this._updateHud();\n      }\n\n      if (Game.timeout - correctedElapsedSeconds <= 0) {\n        // times up!\n        console.log(\"Time is up, dude!\");\n        this._end();\n      }\n\n      this._detectCollisions();\n      this._updateKI();\n      this._moveActors();\n\n      // sort by y\n      const sort = (\n        a: PIXI.DisplayObject,\n        b: PIXI.DisplayObject\n      ) => {\n        const ab = a.getBounds()\n        const bb = b.getBounds()\n\n        if (a.y + ab.height < b.y + bb.height - 5) {\n          return -1;\n        }\n\n        if (a.y + ab.height > b.y + bb.height - 5) {\n          return 1;\n        }\n\n        return 0;\n      }\n\n      // ensure z index for actors\n      this._map?.actorContainer.children\n        .sort(sort);\n\n      if (Config.outlineObjects) {\n        // outline player\n        this._player!.outline()\n        this._beacon!.outline()\n        this._crosshair!.outline()\n\n        // outline enemies\n        for (const enemy of this._enemies) {\n          enemy.outline()\n        }\n\n        // outline mouse line\n        this._outlineMouse()\n      }\n    }\n  }\n}","import * as PIXI from \"pixi.js\";\nimport Game from \"./game\";\nimport { Config } from \"./config\"\n\nexport default class Maension {\n\n  private _lastFrame: number = 0\n  private _fpsCount: number = 0\n  private _fpsTimer: number = 0\n  private _game?: Game\n  private readonly _renderer: PIXI.Renderer\n  private readonly _stage: PIXI.Container\n  private readonly _stageWrapper: PIXI.Container\n  private readonly _fps?: PIXI.Text\n\n  constructor(container: HTMLDivElement) {\n\n    this._renderer = PIXI.autoDetectRenderer({\n      width: 800,\n      height: 600,\n      backgroundColor: 0x1099bb\n    });\n\n    container.appendChild(this._renderer.view);\n\n    console.log(\"Viewport\", window.innerWidth, window.innerHeight);\n\n    // create the root of the scene graph\n    this._stage = new PIXI.Container();\n\n    this._stageWrapper = new PIXI.Container();\n    this._stageWrapper.addChild(this._stage)\n\n    if (Config.showFPS) {\n      this._fps = new PIXI.Text(\"FPS: \", {\n        fontWeight: \"16px\",\n        fill: \"#fff\"\n      } as PIXI.TextStyle);\n      this._fps.x = 10\n      this._fps.y = 10\n      this._stageWrapper.addChild(this._fps)\n    }\n\n    this._animate.bind(this);\n    this._assetsLoaded.bind(this);\n  }\n\n  /**\n   *\n   */\n  public run() {\n    const options = {\n      crossOrigin: true\n    } as PIXI.ILoaderOptions\n\n    const assetPath = \"assets\";\n\n    const loader = new PIXI.Loader()\n\n    // load map\n    loader.add(\"maps.house\", assetPath + \"/maps/house.json\", options)\n    loader.add(\"maps.street\", assetPath + \"/maps/street.json\", options)\n    loader.add(\"maps.maension\", assetPath + \"/maps/maension.json\", options)\n\n    // load player\n    loader.add(\"ryu.stance\", assetPath + \"/ryu/stance.json\", options)\n    loader.add(\"ryu.punch\", assetPath + \"/ryu/punch.json\", options)\n    loader.add(\"ryu.kick\", assetPath + \"/ryu/kick.json\", options)\n    loader.add(\"ryu.walk\", assetPath + \"/ryu/walk.json\", options)\n    loader.add(\"ryu.gothit\", assetPath + \"/ryu/gothit.json\", options)\n    loader.add(\"ryu.died\", assetPath + \"/ryu/died.json\", options)\n\n    // enemies\n    loader.add(\"bat.walk\", assetPath + \"/enemys/bat/walk.json\", options)\n\n    // weapons\n    loader.add(\"weapons.shotgun\", assetPath + \"/weapons/shotgun.json\", options)\n    loader.add(\"weapons.beretta\", assetPath + \"/weapons/beretta.json\", options)\n\n    // load things, like decals heads and so on\n    loader.add(\"things.blood\", assetPath + \"/things/blood.json\", options)\n    loader.add(\"things.door\", assetPath + \"/things/door.json\", options)\n    loader.add(\"things.hud\", assetPath + \"/things/hud.json\", options)\n    loader.add(\"things.decals\", assetPath + \"/things/decals.json\", options)\n\n    loader.onComplete.once(this._assetsLoaded.bind(this))\n\n    // resources loaded\n    loader.load();\n  }\n\n  /**\n   *\n   * @param loader\n   * @param resources\n   * @private\n   */\n  private _assetsLoaded(\n    loader: PIXI.Loader,\n    resources: PIXI.IResourceDictionary\n  ) {\n\n    // loading done, start game\n    this._game = new Game(\n      resources,\n      this._stage,\n      this._renderer.width,\n      this._renderer.height\n    );\n\n    console.log(\"Mänsion:\", \"Init done, ready to scare!\");\n\n    requestAnimationFrame(this._animate.bind(this));\n  }\n\n  /**\n   *\n   * @private\n   */\n  private _animate(elapsed: number) {\n    // calculate frame delta\n    let delta = elapsed - this._lastFrame;\n    this._lastFrame = elapsed;\n\n    if (this._fps) {\n      this._fpsCount++\n      this._fpsTimer += delta;\n\n      // reset after 1 second\n      if (this._fpsTimer > 1000) {\n        // update text\n        this._fps.text = \"FPS: \" + this._fpsCount;\n\n        this._fpsCount = 0;\n        this._fpsTimer = 0;\n      }\n    }\n\n    // update game\n    if (this._game) {\n      this._game.update(elapsed, delta);\n    }\n\n    // render the container\n    this._renderer.render(this._stageWrapper);\n\n    requestAnimationFrame(this._animate.bind(this));\n  }\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport './Maension.css';\nimport Maension from \"./game/maension\"\n\nexport default function MaensionComponent() {\n\n  const stage = useRef(null)\n  const [maension, setMaension] = useState<Maension>()\n\n  useEffect(() => {\n    if (!maension && stage.current) {\n      const m = new Maension(stage.current!)\n      m.run()\n      setMaension(m)\n    }\n  }, [stage, maension])\n\n  return (\n    <div className=\"maension\">\n      <h1>Mänsion</h1>\n\n      <div ref={stage}/>\n\n      <div>\n        <div>\n          Donate\n        </div>\n        <div>\n          Patreon\n        </div>\n      </div>\n\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Maension from './Maension';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Maension/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}