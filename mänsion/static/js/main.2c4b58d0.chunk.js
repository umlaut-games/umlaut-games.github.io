(this.webpackJsonpmaension=this.webpackJsonpmaension||[]).push([[0],{36:function(e,t,i){e.exports=i(60)},41:function(e,t,i){},42:function(e,t,i){},44:function(e,t,i){},45:function(e,t,i){},46:function(e,t,i){},47:function(e,t,i){},48:function(e,t,i){},59:function(e,t,i){},60:function(e,t,i){"use strict";i.r(t);var a=i(4),n=i.n(a),s=i(30),o=i.n(s),r=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var i=e.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i(41),i(42),i(43),i(44),i(45);function c(){return n.a.createElement("header",null,n.a.createElement("h1",null,"M\xe4nsion"),n.a.createElement("hr",null))}i(46);function h(){return n.a.createElement("footer",null,n.a.createElement("div",null,n.a.createElement("div",{className:"entry inline"},n.a.createElement("a",{href:"https://twitter.com/umlautgames",target:"_blank",rel:"noopener noreferrer"},"Twitter")," ","|"),n.a.createElement("div",{className:"entry inline"},n.a.createElement("a",{href:"https://www.linkedin.com/company/umlaut-games",target:"_blank",rel:"noopener noreferrer"},"LinkedIn")," ","|"),n.a.createElement("div",{className:"entry inline"},n.a.createElement("a",{href:"https://umlaut-games.itch.io",target:"_blank",rel:"noopener noreferrer"},"itch.io"))),n.a.createElement("div",{className:"copyright"},"\xa9 2020"," ",n.a.createElement("a",{href:"https://umlaut.games",target:"_blank",rel:"noopener noreferrer"},"Umlaut Games"),n.a.createElement("span",null," \u2014 All Rights Reserved")))}i(47);function u(){return n.a.createElement("div",{className:"blocks"},n.a.createElement("div",{className:"block"},n.a.createElement("h2",null,"Kickstarter"),n.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed mattis sem nunc, vitae consectetur purus volutpat at. Integer at consequat arcu. Curabitur aliquam ex sit amet consectetur bibendum. Phasellus nec metus aliquam, vestibulum est et, efficitur metus. Fusce consectetur vel lectus non feugiat. Nam et ipsum leo. Mauris bibendum semper augue, non dapibus dui vestibulum id. In eget metus nec odio consectetur ultrices ut congue nisi. Vivamus et augue vel risus posuere pulvinar. Vestibulum placerat justo mi, sed aliquam massa lobortis vitae."),n.a.createElement("div",{className:"cta"},n.a.createElement("button",null,"Preorder Now!"))),n.a.createElement("div",{className:"block"},n.a.createElement("h2",null,"Patreon"),n.a.createElement("p",null,"Ut vestibulum bibendum enim ut sodales. Nam efficitur, sapien consectetur porttitor dapibus, dolor felis lacinia velit, ut commodo odio leo eu nunc. Curabitur vel libero aliquam, malesuada mauris vel, ornare elit. Sed consectetur mauris eu ante maximus pulvinar. Aliquam arcu metus, pellentesque non nibh id, scelerisque placerat mauris. Cras vel elit metus. Donec pulvinar purus ac ipsum tristique tincidunt. Quisque non placerat sapien. In ut iaculis libero, id dictum sem. Mauris pulvinar vel lorem nec cursus."),n.a.createElement("div",{className:"cta"},n.a.createElement("button",{className:"secondary"},"Support us!"))),n.a.createElement("div",{className:"block"},n.a.createElement("h2",null,"itch.io"),n.a.createElement("p",null,"Ut vestibulum bibendum enim ut sodales. Nam efficitur, sapien consectetur porttitor dapibus, dolor felis lacinia velit, ut commodo odio leo eu nunc. Curabitur vel libero aliquam, malesuada mauris vel, ornare elit. Sed consectetur mauris eu ante maximus pulvinar. Aliquam arcu metus, pellentesque non nibh id, scelerisque placerat mauris. Cras vel elit metus. Donec pulvinar purus ac ipsum tristique tincidunt. Quisque non placerat sapien. In ut iaculis libero, id dictum sem. Mauris pulvinar vel lorem nec cursus."),n.a.createElement("div",{className:"cta"},n.a.createElement("button",{className:"secondary"},"Get Early Access!"))))}var d=i(35),p=(i(48),i(8)),_=i(13),v=i(5),m=i(22),f=i(14),g=i(11),y=i(10),b=i(9),w={outlineObjects:!1,lockTitleScreen:!0,showObjectCoordinates:!1,withDarkness:!0,showFPS:!1,logActorCoordinates:!1,logCollisions:!1,highlightBeacons:!1,constants:{black:0,white:16777215,width:800,height:600,initialDelay:500,lineDelay:1e3,letterDelay:40,fadeDuration:1e3},styling:{fontFamily:"Press Start 2P",bigText:{fontFamily:"Arial Black",fontSize:"48px",fontWeight:"bold",fill:"#fff",dropShadow:!0,dropShadowColor:"#000",align:"center"}}},k=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a;Object(p.a)(this,i);var n=(a=t.call(this,e))._resources["weapons.effects"],s=new PIXI.Sprite(n.textures["impact.png"]);return a.addChild(s),a}return i}(v.b),j=i(19),x=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;Object(p.a)(this,i);var s="things";return(a=t.call(this,e))._clips=Object(j.a)({},s,v.c.loadClip(a._resources,s,"blood",n,1)),a._playClip(s,!1,!1),a}return i}(v.b),O=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i);return(n=t.call(this,e))._clips=Object(j.a)({},"things",v.c.loadClip(n._resources,"things","door",.01,8)),n._clips.things.filters=[new PIXI.filters.BlurFilter(.2)],n._playClip("things",!1,!1).then((function(){a&&a()})),n}return i}(v.b),I=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a;return Object(p.a)(this,i),(a=t.call(this,e)).zIndex=3,a.addChild(new PIXI.Text("x",{fill:"#fff"})),a}return i}(v.n),C=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a,n){var s;Object(p.a)(this,i),(s=t.call(this,e))._isFacingRight=!0,s.height=a,s.width=n;var o=new PIXI.Sprite(w.highlightBeacons?PIXI.Texture.WHITE:PIXI.Texture.EMPTY);return o.width=n,o.height=a,w.highlightBeacons&&(o.tint=16711680),s.addChild(o),s}return i}(v.n),E=i(16),S=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(){var e;Object(p.a)(this,i),(e=t.call(this)).interval1=void 0,e.interval2=void 0,e.pivot.x=e.width/2,e.pivot.y=e.height/2;var a=new PIXI.Sprite(PIXI.Texture.WHITE);return a.width=1e3,a.height=1e3,e.alpha=0,e.interval1=setInterval((function(){e.shine()}),1e3*v.m.getRandomInt(5,10)),e.interval2=setInterval((function(){e.shine()}),1e3*v.m.getRandomInt(10,20)),e.addChild(a),e}return Object(_.a)(i,[{key:"destroy",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"destroy",this).call(this,e),window.clearInterval(this.interval1),window.clearInterval(this.interval2)}},{key:"shine",value:function(){var e=this;Object(E.a)(Object(E.c)({from:0,to:.75,duration:75,ease:[E.b.createExpoIn(3)]}),Object(E.c)({from:.75,to:0,duration:400,ease:[E.b.easeOut]})).start((function(t){return e.alpha=t}))}}]),i}(PIXI.Container),P=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a;Object(p.a)(this,i),(a=t.call(this,e))._width=void 0,a._height=void 0,a.ropeLength=void 0,a.pointCount=3,a.points=[],a.count=0;var n=e.taro.textures["arm.png"];a.zIndex=8e3,a._width=n.width,a._height=n.height,a.ropeLength=a._width/a.pointCount;for(var s=0;s<a.pointCount;s++)a.points.push(new PIXI.Point(s*a.ropeLength,0));a.points[a.pointCount-1].y=2;var o=new PIXI.SimpleRope(n,a.points);return a.addChild(o),a}return Object(_.a)(i,[{key:"tick",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"tick",this).call(this,e),this.count+=.1;for(var t=0;t<this.points.length;t++)this.points[t].y=Math.sin(1.075*this.count)*this._height/8}}]),i}(v.n),N=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["Hahhahaha, kid!","You will never stop me","This is the end ... \ud83c\udf46"];Object(p.a)(this,i),(a=t.call(this,e))._text=void 0,a._textObject=void 0,a._timer=void 0,a._text=n.reverse();var s=e["avatar.dejonghe"].texture,o=new PIXI.Sprite(s);o.height=70,o.width=70,o.y=2,o.x=2;var r=new PIXI.Graphics;r.lineStyle(4,1118481),r.drawRect(0,0,400,72);var l={fontSize:"14px",fill:"#ccc",fontFamily:w.styling.fontFamily,dropShadow:!0,dropShadowColor:"#222"};return a._textObject=new PIXI.Text("",l),a._textObject.x=80,a._textObject.y=12,a.addChild(r,o,a._textObject),a}return Object(_.a)(i,[{key:"start",value:function(){var e=this;this._timer=setTimeout((function(){e.play()}),w.constants.initialDelay)}},{key:"destroy",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"destroy",this).call(this,e),this._timer&&window.clearTimeout(this._timer)}},{key:"printLine",value:function(e){var t=this;return new Promise((function(i){var a=e.split("").reverse(),n=setInterval((function(){var e=a.pop();if(!e)return clearInterval(n),i();t._textObject.text+=e," "!==e&&t._resources["sfx.keypress"].sound.play({start:.7,speed:3,volume:.2})}),w.constants.letterDelay)}))}},{key:"play",value:function(){var e=this,t=this._text.pop();t&&this.printLine(t).then((function(){e._text.length>0?setTimeout((function(){e._textObject.text+="\n",e.play()}),w.constants.lineDelay):setTimeout((function(){if(e._onDone)return e.done()}),w.constants.lineDelay)}))}}]),i}(v.b),X=i(21),L=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;Object(p.a)(this,i);var s="weapons.effects";return(a=t.call(this,e))._clips=Object(j.a)({},s,v.c.loadClip(a._resources,s,"muzzle",n,1)),a.scale.set(.5),a._playClip(s,!1,!1),a}return i}(v.b),M=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),(n=t.call(this,e)).pivot.x=n.width/2,n.pivot.y=n.height/2;var s=new PIXI.Sprite(a);return s.rotation=v.m.getRandomInt(0,100),n.scale.x=.1,n.scale.y=.1,Object(E.c)({from:0,to:-v.m.getRandomInt(500,700),duration:600}).start((function(e){return s.x=e})),Object(E.c)({from:0,to:v.m.getRandomInt(900,1e3),duration:600,ease:[E.b.bounceOut]}).start((function(e){return s.y=e})),n.addChild(s),n}return i}(v.b),R=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(){return Object(p.a)(this,i),t.apply(this,arguments)}return Object(_.a)(i,[{key:"fire",value:function(){var e=this,t=Object(f.a)(Object(g.a)(i.prototype),"fire",this).call(this);if(t){var a,n=new L(this._resources,2),s=this._player;n.x=n.width,n.y=-n.height/2,s.arm.addChild(n);var o=new M(this._resources,null===(a=this._roundsSprite)||void 0===a?void 0:a.texture);o.position=s.position,s.parent.addChild(o),this._shellSprites.push(o),setTimeout((function(){s.parent.removeChild(o),e._shellSprites=e._shellSprites.splice(e._shellSprites.findIndex((function(e){return e===o})))}),1e4)}return t}}]),i}(v.q),T=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),n=t.call(this,e,a,55,6);var s=e["weapons.shotgun"];return n._roundsSprite=new PIXI.Sprite(s.textures["shotgun_shell.png"]),n._sprite=new PIXI.Sprite(s.textures["shotgun.png"]),n._sprite.scale.x=.3,n._sprite.scale.y=.3,n.addChild(n._sprite),n}return i}(R),B=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),(n=t.call(this,e,a,55,8)).fireSound=void 0,n.reloadSound=void 0,n.fireSound=e["beretta.fire"].sound,n.reloadSound=e["beretta.reload"].sound,n._reloadTime=n.reloadSound.duration;var s=e["weapons.beretta"];return n._sprite=new PIXI.Sprite(s.textures["beretta.png"]),n._sprite.scale.set(.25),n.addChild(n._sprite),n._roundsSprite=new PIXI.Sprite(s.textures["beretta_shell.png"]),n}return Object(_.a)(i,[{key:"fire",value:function(){var e=Object(f.a)(Object(g.a)(i.prototype),"fire",this).call(this);return e&&this.fireSound.play(),e}},{key:"reload",value:function(){var e=Object(f.a)(Object(g.a)(i.prototype),"reload",this).call(this);return e&&this.reloadSound.play(),e}}]),i}(R),D=i(33),F=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){var a;Object(p.a)(this,i),a=t.call(this,e);var n=PIXI.Texture.from("flashlight.png"),s=new D.a(n);s.alpha=.01,s.blendMode=PIXI.BLEND_MODES.ADD;var o=new PIXI.Sprite(n);return o.width=100,o.height=50,o.alpha=.2,o.tint=15723480,o.y=-10,o.x=-20,o.pivot.x=-o.height/2,o.pivot.y=0,o.zIndex=99999,o.filters=[new PIXI.filters.NoiseFilter(.2),s],a.zIndex=9999,a.addChild(o),a.scale.set(4,2),a}return Object(_.a)(i,[{key:"tick",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"tick",this).call(this,e),this.outline()}}]),i}(v.b),H={},W=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;return Object(p.a)(this,i),(n=t.call(this,e,a,3)).flashlight=void 0,n._baseScale=2,n._name="Taro",n._health=77,n._clips[n._skin+".idle"]=v.c.loadClip(e,a,"idle",.1,1),n._clips[n._skin+".walk"]=n._clips[n._skin+".idle"],n._clips[n._skin+".idle-handgun"]=v.c.loadClip(e,a,"idle-handgun",.1,1),H.shotgun=new T(e,Object(X.a)(n)),H.beretta=new B(e,Object(X.a)(n)),n.flashlight=new F(e),n._weapon=H.beretta,n._arm=new P(e),n._arm.y=19,n._arm.x=1,n.addChild(n._arm),n.relax(),n}return Object(_.a)(i,[{key:"relax",value:function(){this._idle()}},{key:"reload",value:function(){this._weapon.reload()}},{key:"switchWeapon",value:function(){this.weapon.isReloading||(this._weapon instanceof T?this._weapon=H.beretta:this._weapon instanceof B&&(this._weapon=H.shotgun),this.toggleFlashlight())}},{key:"toggleFlashlight",value:function(){var e=this;this._map&&this.flashlight&&(this._map.foregroundContainer.children.find((function(t){return t===e.flashlight}))?this._map.foregroundContainer.removeChild(this.flashlight):(this.flashlight.position.set(this.x,this.y),this._map.foregroundContainer.addChild(this.flashlight),this._map.foregroundContainer.children.sort(v.r)))}},{key:"flip",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"flip",this).call(this,e),this.flashlight&&this.flashlight.parent&&(console.log("flip flashlight"),this.flashlight.flip(e))}},{key:"updateCrosshairPosition",value:function(e){var t=this._isFacingRight?v.m.angleBetweenRad(this.weaponLocation,e):-v.m.angleBetweenRad(e,this.weaponLocation);this.arm.rotation=t,this.flashlight&&(this.flashlight.rotation=t)}},{key:"_canBeControlled",value:function(){return this._state===v.a.died?(console.log("Cant be controlled, player is dead"),!1):this._state===v.a.idle||this._state===v.a.walking}},{key:"_died",value:function(){Object(f.a)(Object(g.a)(i.prototype),"_died",this).call(this),this.y+=this.height/2,this.height=this.height/2}},{key:"fire",value:function(){var e=this;if(!this._canBeControlled())return!1;var t=this._weapon.fire();return t?(this.speak("P\xe4ng!"),this._setState(v.a.fire),this._vx=0,this._vy=0,this._playClip(this._skin+".punch",!1).then((function(){e.relax()})),!0):(this.relax(),!1)}},{key:"moveRight",value:function(){this._canBeControlled()&&(this._vx=this._speed,this._playClip(this._skin+".walk",!0),this._setState(v.a.walking))}},{key:"moveLeft",value:function(){this._canBeControlled()&&(this._vx=-this._speed,this._playClip(this._skin+".walk",!0),this._setState(v.a.walking),this._adaptScaleBasedOnOrientation())}},{key:"stopMoveHorizontally",value:function(){this._vx=0,0===this._vy&&this._canBeControlled()&&this.relax()}},{key:"moveUp",value:function(){this._canBeControlled()&&(this._vy=-this._speed,this._playClip(this._skin+".walk",!0),this._setState(v.a.walking))}},{key:"moveDown",value:function(){this._canBeControlled()&&(this._vy=this._speed,this._playClip(this._skin+".walk",!0),this._setState(v.a.walking))}},{key:"stopMoveVertically",value:function(){this._vy=0,0===this._vx&&this._canBeControlled()&&this.relax()}},{key:"speak",value:function(e){Object(f.a)(Object(g.a)(i.prototype),"speak",this).call(this,"".concat(this._name,": ").concat(e))}},{key:"move",value:function(e,t){var i=!1;return 0!==this.vy&&this.y+this.vy>0&&this.y+this.height+this.vy<e&&(this.y+=this.vy,i=!0),this.vx>0?this.realx+Math.abs(this.width)+7+this.vx<t&&(this.x+=this.vx,i=!0):this.vx<0&&this.realx+this.vx>=0&&(this.x+=this.vx,i=!0),i&&(this.adaptScale(this.y,e),this.flashlight&&this.flashlight.position.set(this.x,this.y),this.moved()),i}},{key:"tick",value:function(e){this.weapon.tick(e),this.arm.tick(e)}},{key:"weaponLocation",get:function(){return this.toGlobal(this.arm.position)}}]),i}(v.o),z=(v.d,function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),(n=t.call(this,e,a,"maps.maension"))._bgm=e["bgm.outside"].sound,n._bgm.volume=.3,n._bgm.loop=!0,n._bgm.play(),n.withDarkness=w.withDarkness;var s=new PIXI.Sprite(n._textures["sky.png"]);s.scale.x=2.56,s.scale.y=2.56,n._backgroundContainer.addChild(s);var o=new PIXI.Sprite(n._textures["Maension_WIP.png"]);o.y=-40,o.scale.x=2,o.scale.y=2,n._backgroundContainer.addChild(o);var r=n._textures["tree.png"],l=new PIXI.Sprite(r);l.x=100,l.y=350,l.scale.x=.4,l.scale.y=.4,n._actorContainer.addChild(l);var c=n._textures["tree_dead.png"],h=new PIXI.Sprite(c);if(h.x=50,h.y=180,h.scale.x=.4,h.scale.y=.4,n._backgroundContainer.addChild(h),n.withDarkness){var u=new PIXI.Sprite(PIXI.Texture.WHITE);u.width=w.constants.width,u.height=n.height,u.tint=0,u.alpha=.8,u.blendMode=PIXI.BLEND_MODES.MULTIPLY,u.zIndex=1,n._foregroundContainer.addChild(u)}return n._setup(),n}return Object(_.a)(i,[{key:"_setup",value:function(){setInterval((function(){}),3e4),setInterval((function(){}),67e3)}}]),i}(v.l)),A=(v.l,i(34)),q=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e){return Object(p.a)(this,i),t.call(this,void 0,e["shaders.frag-rain"].data)}return i}(PIXI.Filter),U=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),(n=t.call(this,e,a,"maps.maension"))._keyboard=void 0,n.rainFilter=void 0,n.godFilter=void 0,n.count=0,n._bgm=e["bgm.title"].sound,n._bgm.volume=.3,n._bgm.loop=!0,n._bgm.play(),n.withHud=!1,n.withCrosshair=!1,n.withPlayer=!1,n.withMouse=!1;var s=new v.p(e,"M\xe4nsion","54px","#EFB775",void 0,"#111");s.x=w.constants.width/2-s.width/2,s.y=w.constants.height/3-s.height/2;var o=window.location.search.endsWith("interactive")||!w.lockTitleScreen,r="Press Enter to play";o||(r="coming soon ...");var l=new v.p(e,r,"24px");Object(E.c)({from:1,to:.2,loop:1/0,duration:1500,ease:[E.b.easeInOut]}).start((function(e){return l.alpha=e})),l.x=w.constants.width/2-l.width/2,l.y=w.constants.height/2-l.height/2;var c=new PIXI.Sprite(n._textures["Maension_WIP.png"]);c.alpha=.6;c.scale.x=2,c.scale.y=2,c.y=w.constants.height-c.height,c.x=w.constants.width/2-c.width/2,n._foregroundContainer.addChild(new S,c,l,s);var h=new PIXI.Sprite(PIXI.Texture.WHITE);h.width=w.constants.width,h.height=w.constants.height,h.tint=w.constants.black,n.godFilter=new A.a,n.godFilter.angle=-35,n.godFilter.gain=.5,n.godFilter.lacunarity=2.5,h.filters=[n.godFilter],n._backgroundContainer.addChild(h);var u=new PIXI.Sprite(PIXI.Texture.WHITE);return u.width=w.constants.width,u.height=w.constants.height,u.tint=w.constants.black,n.rainFilter=new q(e),n.rainFilter.uniforms.dimensions=[w.constants.width,w.constants.height],n.rainFilter.uniforms.time=1,n.rainFilter.uniforms.u_mouse=[w.constants.width,w.constants.height],n.rainFilter.uniforms.u_frame=0,n.rainFilter.blendMode=PIXI.BLEND_MODES.ADD,u.filters=[n.rainFilter],n._backgroundContainer.addChild(u),n._foregroundContainer.interactive=!0,o&&n.wireEvents(),n}return Object(_.a)(i,[{key:"wireEvents",value:function(){var e=this;this._keyboard=new v.j([new v.i("Enter",!0,(function(){return e.done()}))]),this._foregroundContainer.on("touchstart",this.done.bind(this))}},{key:"destroy",value:function(e){var t;Object(f.a)(Object(g.a)(i.prototype),"destroy",this).call(this,e),null===(t=this._keyboard)||void 0===t||t.destroy()}},{key:"done",value:function(){var e=this;Promise.all([this.fade(),this.fadeMusic()]).then((function(){Object(f.a)(Object(g.a)(i.prototype),"done",e).call(e)}))}},{key:"tick",value:function(e){this.count+=.001*e,this.godFilter.time=this.count,this.rainFilter.uniforms.time=this.count}}]),i}(v.l),V=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;return Object(p.a)(this,i),(n=t.call(this,e,a,"maps.maension")).dialogBox=void 0,n._keyboard=void 0,n.withHud=!1,n.withCrosshair=!1,n.withPlayer=!1,n.withMouse=!1,n.dialogBox=new N(e),n.dialogBox.x=w.constants.width/2-n.dialogBox.width/2,n.dialogBox.y=w.constants.height/3-n.dialogBox.height/2,n.foregroundContainer.addChild(n.dialogBox),n.dialogBox.start(),n.dialogBox.onDone=function(){return n.done()},n._keyboard=new v.j([new v.i("Enter",!0,(function(){return n.done()}))]),n}return Object(_.a)(i,[{key:"done",value:function(){var e=this;this.fade().then((function(){Object(f.a)(Object(g.a)(i.prototype),"done",e).call(e)}))}},{key:"destroy",value:function(e){var t;Object(f.a)(Object(g.a)(i.prototype),"destroy",this).call(this,e),null===(t=this._keyboard)||void 0===t||t.destroy()}},{key:"tick",value:function(e){}}]),i}(v.l),G=i(23),K=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;Object(p.a)(this,i),(n=t.call(this,e))._health=void 0,n._rounds=void 0,n._weapon=void 0;var s=e.hud;console.log("Setting up HUD","width:",w.constants.width,"height:",w.constants.height),n._player=a;var o=Object(G.a)(Object(G.a)({},w.styling.bigText),{},{fontSize:"12px"}),r=new PIXI.Text(a.playerName,Object(G.a)(Object(G.a)({},o),{},{fill:"#ffff30"}));r.x=w.constants.width/3-r.width/2,r.y=w.constants.height-47,n.addChild(r),n._health=new PIXI.Text("",o),n._health.x=r.x,n._health.y=w.constants.height-23,n.addChild(n._health),n._rounds=new PIXI.Container,n._rounds.x=w.constants.width/3+77,n._rounds.y=w.constants.height-33,n.addChild(n._rounds);var l=new PIXI.Sprite(s.textures["side.png"]);l.x=w.constants.width/2-(l.width+l.width/2)+2,l.y=w.constants.height-l.height-2,n.addChild(l);var c=new PIXI.Sprite(s.textures["center.png"]);c.x=w.constants.width/2-c.width/2+1,c.y=w.constants.height-c.height-2,n.addChild(c);var h=new PIXI.Sprite(s.textures["side.png"]);return h.x=w.constants.width/2+(h.width+h.width/2)-2,h.y=w.constants.height-h.height-2,h.scale.x=-1,n.addChild(h),n.update(),n}return Object(_.a)(i,[{key:"_renderWeapon",value:function(){this.removeChild(this._weapon),this._weapon=new PIXI.Sprite(this._player.weapon.sprite.texture),this._weapon.scale.x=3*this._player.weapon.sprite.scale.x,this._weapon.scale.y=3*this._player.weapon.sprite.scale.y,this._weapon.x=w.constants.width/2+(this._weapon.width+50),this._weapon.y=w.constants.height-60,this.addChild(this._weapon)}},{key:"_renderRounds",value:function(){this._rounds.removeChildren();for(var e=0;e<this._player.weapon.rounds;e++){var t,i=new PIXI.Sprite(null===(t=this._player.weapon.roundsSprite)||void 0===t?void 0:t.texture);i.scale.x=.25,i.scale.y=.25,i.x=12*e,i.y=10,this._rounds.addChild(i)}}},{key:"update",value:function(){Object(f.a)(Object(g.a)(i.prototype),"update",this).call(this),this._health.text=this._player.health+" HP",this._renderRounds(),this._renderWeapon()}},{key:"tick",value:function(e){this._gameOverSign&&(this._gameOverSign.alpha+=e/1e3,this._gameOverSign.alpha>1&&(this._gameOverSign.alpha=.2))}}]),i}(v.h),Y=function(e){Object(y.a)(i,e);var t=Object(b.a)(i);function i(e,a){var n;return Object(p.a)(this,i),(n=t.call(this,e,a))._beacon=void 0,n._enemies=[],n._mouseLocation=void 0,n._mouseLine=void 0,n._crosshair=void 0,n._player=void 0,n._init(),n}return Object(_.a)(i,[{key:"switchMap",value:function(e){return this._stage.removeChild(this._map),this._stage.removeChild(this._hud),this._map&&(this._map.destroy({children:!0,baseTexture:!0}),delete this._map),this._map=e,this._stage.addChild(this._map),this._player&&this._map.withPlayer&&(this._player.x=60,this._player.y=400,this._player.adaptScale(this._player.y,w.constants.height),this._player.map=this._map,this._map.actorContainer.addChild(this._player)),this._map.withCrosshair&&(this._crosshair=new I(this._resources),this._crosshair.adaptScale(this._player.y,w.constants.height),this._stage.cursor="none"),this._map.withHud&&(this._stage.addChild(this._hud),this._updateHud()),this._map.withMouse&&(this._attachMouse(),this._updateMouseLocation(new PIXI.Point(w.constants.width/2,w.constants.height/2))),this._stage.children.sort(v.r),e}},{key:"_init",value:function(){var e=this;Object(f.a)(Object(g.a)(i.prototype),"_init",this).call(this),this._player=new W(this._resources,"taro"),this._hud=new K(this._resources,this._player),this.switchMap(new U(this._resources,this._stage)).onDone=function(){e.switchMap(new V(e._resources,e._stage)).onDone=function(){return e.switchMap(new z(e._resources,e._stage))}},this._beacon=new C(this._resources,80,5),this._enemies=[],console.log("Game:","Game init done!")}},{key:"_attachMouse",value:function(){var e=this;this._mouseLine=new PIXI.Graphics,this._mouseLine.zIndex=5,this._stage.addChild(this._mouseLine),this._crosshair&&this._stage.addChild(this._crosshair),this._stage.interactive=!0,this._stage.on("mousemove",(function(t){e._updateMouseLocation(t.data.global)})),this._stage.on("mousedown",(function(){return e._fire()})),this._stage.on("mouseout",(function(){return e._isRunning=!1})),this._stage.on("mouseover",(function(){return e._isRunning=e._player.state!==v.a.died}))}},{key:"_updateCrosshair",value:function(){var e;this._player&&this._player.state!==v.a.died&&this._crosshair&&this._mouseLocation&&this._isRunning&&(this._crosshair.x=this._mouseLocation.x-this._crosshair.width/2,this._crosshair.y=this._mouseLocation.y-this._crosshair.height/2,this._crosshair.x<this._player.toGlobal(this._stage).x?this._player.flip(!1):this._player.flip(!0),this._player.updateCrosshairPosition(this._stage.toGlobal(null===(e=this._crosshair)||void 0===e?void 0:e.position)),this._crosshair.adaptScale(this._player.y,w.constants.height))}},{key:"_fire",value:function(){var e;if(this._isRunning&&(null===(e=this._player)||void 0===e?void 0:e.fire())){var t,i=new k(this._resources);i.scale.x=.1,i.scale.y=.1;var a=this._map.toLocal(this._crosshair);i.x=a.x+this._crosshair.width/2-i.width/2,i.y=a.y+this._crosshair.height/2-i.height/2,null===(t=this._map)||void 0===t||t.backgroundContainer.addChild(i),this._updateHud()}}},{key:"_moveRight",value:function(){this._isRunning&&this._player&&this._player.moveRight()}},{key:"_moveLeft",value:function(){this._isRunning&&this._player&&this._player.moveLeft()}},{key:"_moveUp",value:function(){this._isRunning&&this._player&&this._player.moveUp()}},{key:"_moveDown",value:function(){this._isRunning&&this._player&&this._player.moveDown()}},{key:"_stopMoveVertically",value:function(){var e;this._isRunning&&(null===(e=this._player)||void 0===e||e.stopMoveVertically())}},{key:"_stopMoveHorizontally",value:function(){var e;this._isRunning&&(null===(e=this._player)||void 0===e||e.stopMoveHorizontally())}},{key:"_detectCollisions",value:function(){this._player.collides(this._beacon)&&this._player.speak("It's locked!");var e,t=Object(m.a)(this._enemies);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(v.a.died!==i.state&&v.a.died!==this._player.state&&this._player.collides(i)){var a=this._player.hitBy(i);a.objectTookDamage&&(this._drawBlood(this._player),this._updateHud()),a.died&&this._end()}}}catch(n){t.e(n)}finally{t.f()}}},{key:"_drawBlood",value:function(e){for(var t=0;t<5;t++){var i,a=new x(this._resources);a.x=e.x+v.m.getRandomInt(-20,20),a.y=e.y+e.height+v.m.getRandomInt(-20,20),a.rotation=v.m.getRandomInt(0,10),null===(i=this._map)||void 0===i||i.backgroundContainer.addChild(a)}}},{key:"_updateHud",value:function(){this._hud.update()}},{key:"_updateKI",value:function(){var e,t=Object(m.a)(this._enemies);try{for(t.s();!(e=t.n()).done;){var i=e.value;v.a.died!==i.state&&i.moveTowards(this._player.position)}}catch(a){t.e(a)}finally{t.f()}}},{key:"_moveActors",value:function(){var e,t=this._player;t.move(w.constants.height,this._map.width)&&(null===(e=this._map)||void 0===e||e.shallScroll(t.realx,t.vx),this._updateCrosshair());var i,a=Object(m.a)(this._enemies);try{for(a.s();!(i=a.n()).done;){i.value.move(w.constants.height,this._map.width)}}catch(n){a.e(n)}finally{a.f()}}},{key:"_outlineMouse",value:function(){if(this._mouseLine&&this._mouseLocation&&this._player&&this._map){this._mouseLine.clear(),this._mouseLine.lineStyle(1,w.constants.white),this._mouseLine.position=this._player.weaponLocation;var e=this._mouseLine.toLocal(this._mouseLocation),t=e.x,i=e.y;this._mouseLine.lineTo(t,i),this._mouseLine.endFill()}}},{key:"_switchWeapon",value:function(){this._isRunning&&(this._player.switchWeapon(),this._updateHud())}},{key:"_reload",value:function(){this._isRunning&&(this._player.reload(),this._updateHud())}},{key:"_updateMouseLocation",value:function(e){this._isRunning&&(this._mouseLocation=e,this._updateCrosshair())}},{key:"_attachKeyboard",value:function(){var e=this,t=new v.i("ArrowLeft",!0,(function(){return e._moveLeft()}),(function(){a.isDown||e._stopMoveHorizontally()})),i=new v.i("ArrowUp",!0,(function(){return e._moveUp()}),(function(){n.isDown||e._stopMoveVertically()})),a=new v.i("ArrowRight",!0,(function(){return e._moveRight()}),(function(){t.isDown||e._stopMoveHorizontally()})),n=new v.i("ArrowDown",!0,(function(){return e._moveDown()}),(function(){i.isDown||e._stopMoveVertically()})),s=new v.i("w",!1,(function(){return e._switchWeapon()})),o=new v.i("r",!1,(function(){return e._reload()})),r=new v.i("Enter",!1,(function(){e._isRunning||e._init()}));return this._keyboard=new v.j([t,i,a,n,s,o,r]),!0}},{key:"_attachGamepad",value:function(){var e=this;return!!v.g.init({0:{1:{pressEvent:function(){e._fire()}},15:{pressEvent:function(){return e._moveRight()},releaseEvent:function(){return e._stopMoveHorizontally()}},14:{pressEvent:function(){return e._moveLeft()},releaseEvent:function(){return e._stopMoveHorizontally()}},12:{pressEvent:function(){return e._moveUp()},releaseEvent:function(){return e._stopMoveVertically()}},13:{pressEvent:function(){return e._moveDown()},releaseEvent:function(){return e._stopMoveVertically()}},9:{pressEvent:function(){e._isRunning||e._init()}}}})}},{key:"tick",value:function(e,t){if(Object(f.a)(Object(g.a)(i.prototype),"tick",this).call(this,e,t),this._hud.tick(t),this._isRunning){var a;this._player.tick(t),this._map.tick(t);var n=parseInt((e/1e3).toString());this._startOffset||(this._startOffset=n);var s=n-this._startOffset;s!==this._elapsedSeconds&&(this._elapsedSeconds=s,this._updateHud()),this._detectCollisions(),this._updateKI(),this._moveActors();if(null===(a=this._map)||void 0===a||a.actorContainer.children.sort((function(e,t){var i=e.getBounds(),a=t.getBounds();return e.y+i.height<t.y+a.height-5?-1:e.y+i.height>t.y+a.height-5?1:0})),w.outlineObjects){this._player.outline();var o,r=Object(m.a)(this._enemies);try{for(r.s();!(o=r.n()).done;){o.value.outline()}}catch(l){r.e(l)}finally{r.f()}this._outlineMouse()}}}}]),i}(v.f),J={"maps.maension":"maps/maension.json",taro:"taro/taro.json",bat:"enemies/bat/bat.json",monster:"enemies/monster/monster.json","avatar.dejonghe":"enemies/dejonghe/avatar_dejonghe.png","weapons.shotgun":"weapons/shotgun.json","weapons.beretta":"weapons/beretta.json","beretta.fire":"sounds/beretta/mansion_sfx_gun_berreta_outside.wav","beretta.reload":"sounds/beretta/mansion_sfx_gun_berreta_reload.wav","weapons.effects":"weapons/effects.json","bgm.title":"sounds/mansion_bgm_menu.mp3","bgm.outside":"sounds/mansion_bgm_outside_v3.mp3","sfx.keypress":"sounds/sfx/keypress.mp3","shaders.frag-smoke":"shaders/frag-smoke.glsl","shaders.frag-smoke2":"shaders/frag-smoke2.glsl","shaders.vert-spot":"shaders/vert-spot.glsl","shaders.frag-spot":"shaders/frag-spot.glsl","shaders.vert-2d":"shaders/vert-2d.glsl","shaders.frag-rain":"shaders/frag-rain.glsl","shaders.vert-light":"shaders/vert-light.glsl","shaders.frag-light":"shaders/frag-light.glsl",things:"things/things.json",hud:"things/hud.json"},Q=[{sheet:"things",id:"flashlight.png"}],$=function(){function e(t){Object(p.a)(this,e),this._lastFrame=0,this._game=void 0,this._fpsCounter=void 0,this._container=void 0,this._app=void 0,this._root=void 0,this._loadingBar=void 0,this._container=t,this._app=new PIXI.Application({width:w.constants.width,height:w.constants.height,backgroundColor:w.constants.black}),this._container.appendChild(this._app.view),console.log("Viewport",this._container.clientWidth,this._container.clientHeight),this._root=new PIXI.Container,this._app.stage.addChild(this._root),this.resize(),w.showFPS&&(this._fpsCounter=new v.e,this._app.stage.addChild(this._fpsCounter)),this._loadingBar=new v.k,this._app.stage.addChild(this._loadingBar),window.addEventListener("resize",this.resize.bind(this)),this._tick(0)}return Object(_.a)(e,[{key:"resize",value:function(){var e,t,i=window.innerWidth-50,a=window.innerHeight;a/i<w.constants.height/w.constants.width?e=(t=a)*w.constants.width/w.constants.height:t=(e=i)*w.constants.height/w.constants.width,e>w.constants.width&&(e=w.constants.width),t>w.constants.height&&(t=w.constants.height),this._app.renderer.resize(e,t),this._app.stage.scale.set(e/w.constants.width,t/w.constants.height)}},{key:"run",value:function(){var e=this,t={crossOrigin:!0},i=new PIXI.Loader;Object.keys(J).forEach((function(e){i.add(e,"".concat("assets","/").concat(J[e]),t)})),i.onComplete.once(this._assetsLoaded.bind(this)),i.onError.once((function(e,t,i){console.error("Failed to load ".concat(i.url,": ").concat(e.message))})),i.load(),i.onProgress.add((function(t){e._loadingBar.update(t.progress)}))}},{key:"_assetsLoaded",value:function(e){this._app.stage.removeChild(this._loadingBar),this.extractTextures(e.resources),this._game=new Y(e.resources,this._root),console.log("M\xe4nsion:","Init done, ready to scare!")}},{key:"_tick",value:function(e){var t=e-this._lastFrame;this._lastFrame=e,this._fpsCounter&&this._fpsCounter.tick(t),this._game&&this._game.tick(e,t),this._app.render(),requestAnimationFrame(this._tick.bind(this))}},{key:"extractTextures",value:function(e){var t=this;Q.forEach((function(i){var a=e[i.sheet].textures[i.id],n=new PIXI.Sprite(a),s=t._app.renderer.plugins.extract.pixels(n),o=PIXI.Texture.fromBuffer(s,a.width,a.height);PIXI.Texture.removeFromCache(a),PIXI.Texture.addToCache(o,i.id)}))}}]),e}();function Z(){var e=Object(a.useRef)(null),t=Object(a.useState)(),i=Object(d.a)(t,2),s=i[0],o=i[1];return Object(a.useEffect)((function(){if(!s&&e.current){var t=new $(e.current);t.run(),o(t)}}),[e,s]),n.a.createElement("div",{className:"maension",ref:e})}i(59);function ee(){return n.a.createElement("div",{className:"blocks"},n.a.createElement("div",{className:"block"},n.a.createElement("h2",null,"How to Play"),n.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed mattis sem nunc, vitae consectetur purus volutpat at. Integer at consequat arcu. Curabitur aliquam ex sit amet consectetur bibendum. Phasellus nec metus aliquam, vestibulum est et, efficitur metus. Fusce consectetur vel lectus non feugiat. Nam et ipsum leo. Mauris bibendum semper augue, non dapibus dui vestibulum id. In eget metus nec odio consectetur ultrices ut congue nisi. Vivamus et augue vel risus posuere pulvinar. Vestibulum placerat justo mi, sed aliquam massa lobortis vitae.")),n.a.createElement("div",{className:"block",style:{textAlign:"center"}},n.a.createElement("div",{className:"controls"},n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space center"},n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-arrow-up"}))),n.a.createElement("span",{className:"label"},": Move Up")),n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space"},n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-arrow-left"})),n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-arrow-right"}))),n.a.createElement("span",{className:"label"},": Move Left/Right")),n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space center"},n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-arrow-down"}))),n.a.createElement("span",{className:"label"},": Move Down")),n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space center"},n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-mouse-pointer"})),n.a.createElement("div",{className:"button"},n.a.createElement("i",{className:"fas fa-mouse"}))),n.a.createElement("span",{className:"label"},": Aim/Fire")),n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space center"},n.a.createElement("div",{className:"button"},"R")),n.a.createElement("span",{className:"label"},": Reload")),n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"space center"},n.a.createElement("div",{className:"button"},"W")),n.a.createElement("span",{className:"label"},": Switch Weapon")))))}function te(){return n.a.createElement("div",null,n.a.createElement(c,null),n.a.createElement(Z,null),n.a.createElement("hr",null),n.a.createElement("div",{className:"page"},n.a.createElement(ee,null),n.a.createElement(u,null)),n.a.createElement(h,null))}o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(te,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");r?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(i){var a=i.headers.get("content-type");404===i.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):l(t,e)}))}}()}},[[36,1,2]]]);
//# sourceMappingURL=main.2c4b58d0.chunk.js.map